<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guard-Railed Support Ticket Copilot ‚Äì Hackathon</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#E3F2FD',
                primaryTextColor: '#0078D4',
                primaryBorderColor: '#0078D4',
                lineColor: '#0078D4',
                secondaryColor: '#FFF3E0',
                tertiaryColor: '#F0FEFF'
            }
        });
    </script>
    <style>
        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif;
            background: #ffffff;
            color: #111;
            line-height: 1.6;
            font-size: 16px;
        }

        /* Top Navigation Bar */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #0078D4;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .nav-header {
            padding: 0.75rem 2rem;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .top-nav h1 {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
            color: white;
        }

        .top-nav-links {
            display: flex;
            gap: 2rem;
            padding: 0.5rem 2rem;
            flex-wrap: wrap;
        }

        .top-nav-links a {
            color: white;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            margin: 0 0.5rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .top-nav-links a:hover {
            background: rgba(255, 255, 255, 0.2);
            text-decoration: none;
        }

        .nav-section {
            display: inline-flex;
            align-items: center;
            margin-right: 3rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .nav-section-title {
            font-weight: 700;
            margin-right: 1rem;
            padding-right: 1rem;
            border-right: 2px solid rgba(255, 255, 255, 0.4);
            letter-spacing: 0.5px;
        }

        /* Main content area */
        .main-content {
            margin-top: 110px;
            max-width: 1100px;
            padding: 3rem;
            margin-left: auto;
            margin-right: auto;
        }

        /* Typography */
        h1 {
            font-size: 2.5rem;
            color: #111;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        h2 {
            font-size: 2rem;
            color: #0078D4;
            margin-top: 3rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid #0078D4;
        }

        h3 {
            font-size: 1.5rem;
            color: #333;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        p {
            margin-bottom: 1rem;
            color: #333;
        }

        /* Chips/Pills */
        .chip {
            display: inline-block;
            padding: 0.4rem 0.9rem;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .chip-concept { background: #0078D4; color: white; }
        .chip-scenario { background: #00B7C3; color: white; }
        .chip-hands-on { background: #FF8C00; color: white; }
        .chip-milestone { background: #0078D4; color: white; }
        .chip-metric { background: #00B7C3; color: white; }
        .chip-extension { background: #FF8C00; color: white; }
        .chip-issue { background: #D13438; color: white; }
        .chip-engine { background: #0078D4; color: white; }
        .chip-part-a { background: #00B7C3; color: white; }
        .chip-part-b { background: #FF8C00; color: white; }

        /* Cards */
        .card {
            background: white;
            border: 2px solid #0078D4;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .card h4 {
            color: #0078D4;
            margin-bottom: 0.75rem;
            font-size: 1.2rem;
        }

        .card p, .card li {
            color: #333;
        }

        /* Callout boxes */
        .callout {
            border-left: 4px solid;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
            background: #f9f9f9;
        }

        .callout h4 {
            margin-top: 0;
            color: inherit;
        }

        .callout p, .callout li {
            color: #333;
        }

        .callout-info {
            border-color: #0078D4;
            background: #E3F2FD;
            color: #003A66;
        }

        .callout-warning {
            border-color: #FF8C00;
            background: #FFF3E0;
            color: #663600;
        }

        .callout-extension {
            border-color: #00B7C3;
            background: #F0FEFF;
            color: #005661;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid #e5e5e5;
        }

        th {
            background: #f5f5f5;
            font-weight: 600;
            color: #333;
        }

        tr:hover {
            background: #fafafa;
        }

        /* Code blocks */
        pre {
            background: #f5f5f5;
            border: 1px solid #e5e5e5;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            color: #333;
        }

        /* Lists */
        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin: 0.5rem 0;
            color: #333;
        }

        /* Sections */
        section {
            scroll-margin-top: 120px;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .nav-header, .top-nav-links {
                padding: 0.75rem 1rem;
            }
            .top-nav-links {
                gap: 1rem;
            }
            .main-content {
                padding: 2rem 1rem;
                margin-top: 130px;
            }
        }

        /* General text colors */
        section {
            color: #333;
        }

        section h2 {
            color: #0078D4;
        }

        section h3, section h4 {
            color: #333;
        }

        p, li {
            color: #333;
        }
    </style>
</head>
<body>

    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-header">
            <h1>Guard-Railed Support Ticket Copilot ‚Äì Hackathon</h1>
        </div>
        <div class="top-nav-links">
            <span class="nav-section">
                <span class="nav-section-title">Part A:</span>
                <a href="#part-a-overview">Overview</a>
                <a href="#part-a-usecase">Use Case</a>
                <a href="#part-a-data">Datasets</a>
                <a href="#part-a-flow">Flow</a>
                <a href="#part-a-example">Example</a>
            </span>
            <span class="nav-section">
                <span class="nav-section-title">Part B:</span>
                <a href="#part-b-overview">Dev Overview</a>
                <a href="#part-b-stages">Dev Stages</a>
                <a href="#part-b-extensions">Extensions</a>
            </span>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        
        <!-- Introduction -->
        <section id="intro">
            <!-- Hero section with image -->
            <div style="display: grid; grid-template-columns: 1fr 380px; gap: 2rem; align-items: center; margin-bottom: 2rem;">
                <div>
                    <h1 style="margin-bottom: 1rem;">Guard-Railed Support Ticket Copilot ‚Äì Hackathon Use Case</h1>
                    
                    <!-- Part A and Part B chips -->
                    <div style="margin: 1rem 0 1.5rem 0;">
                        <span class="chip chip-part-a">PART A: UNDERSTAND</span>
                        <span class="chip chip-part-b">PART B: BUILD</span>
                    </div>

                    <!-- Introduction paragraphs -->
                    <p style="font-size: 1.1rem; font-weight: 500; color: #333; line-height: 1.6; margin-bottom: 1rem;">
                        This page is your guide for the <strong>Guard-Railed Support Ticket Copilot</strong> hackathon exercise.
                        You'll design and implement a small but realistic IT support assistant that:
                    </p>
                    <ul style="color: #333; line-height: 1.7; margin-bottom: 0; font-size: 1rem;">
                        <li>accepts an <strong>employee id + support ticket</strong> as input</li>
                        <li>decides whether the ticket is <strong>in scope and allowed</strong></li>
                        <li>and, when appropriate, uses a <strong>knowledge base + LLM</strong> to draft an answer</li>
                    </ul>
                </div>

                <!-- Image -->
                <div style="text-align: center;">
                    <img src="https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?w=400&h=300&fit=crop" 
                         alt="Support Agent Working" 
                         style="width: 100%; max-width: 380px; height: auto; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,120,212,0.2); border: 3px solid #0078D4;"
                         onerror="this.onerror=null; this.src='https://img.freepik.com/free-photo/customer-service-executive-working-office_23-2148864399.jpg';">
                </div>
            </div>

            <h3 style="color: #0078D4; margin: 2.5rem 0 1.5rem 0; font-size: 1.5rem;">üìö What you'll find here</h3>
            
            <!-- Two column card layout for Parts A & B -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2.5rem;">
                <!-- Part A Card -->
                <div class="card" style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); border-left: 5px solid #0078D4;">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <span style="font-size: 2rem;">üîç</span>
                        <h4 style="color: #0078D4; margin: 0; font-size: 1.25rem;">Part A ‚Äì Understand</h4>
                    </div>
                    <p style="color: #555; line-height: 1.6; margin-bottom: 1rem; font-style: italic;">
                        <strong>Understand the problem and the data</strong> before you touch any code.
                    </p>
                    <ul style="color: #333; line-height: 1.7; font-size: 0.95rem;">
                        <li>üìã Clear description of the <strong>internal IT support</strong> use case</li>
                        <li>‚úÖ <strong>Per-ticket outcomes</strong> your solution must produce</li>
                        <li>üìä Walkthrough of <strong>datasets</strong> (employees, tickets, rules, KB)</li>
                        <li>üîÑ <strong>Stateless flow diagram</strong> showing classifier ‚Üí rules ‚Üí RAG</li>
                        <li>üí° <strong>Worked example</strong> of one ticket end-to-end</li>
                    </ul>
                </div>

                <!-- Part B Card -->
                <div class="card" style="background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); border-left: 5px solid #4CAF50;">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <span style="font-size: 2rem;">üõ†Ô∏è</span>
                        <h4 style="color: #2E7D32; margin: 0; font-size: 1.25rem;">Part B ‚Äì Build</h4>
                    </div>
                    <p style="color: #555; line-height: 1.6; margin-bottom: 1rem; font-style: italic;">
                        A <strong>development roadmap</strong> you can follow while implementing the solution.
                    </p>
                    <ul style="color: #333; line-height: 1.7; font-size: 0.95rem;">
                        <li>üéØ Set of <strong>7 stages</strong> (KB, classifier, rules, RAG, orchestration, testing)</li>
                        <li>üîó <strong>LangChain-style hints</strong> for structuring components</li>
                        <li>üß™ Guidance on <strong>testing your pipeline</strong> with sample tickets</li>
                        <li>üöÄ Optional <strong>stretch ideas</strong> (UI, stronger auth, hyper-personalization)</li>
                    </ul>
                </div>
            </div>

            <!-- Summary card with visual pipeline -->
            <div class="card" style="background: linear-gradient(135deg, #F3F9FF 0%, #E3F2FD 100%); border: 3px solid #0078D4; max-width: 1000px; margin: 2rem auto; box-shadow: 0 4px 12px rgba(0,120,212,0.15);">
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <h4 style="color: #0078D4; margin-top: 0; font-size: 1.4rem;">üéØ At a glance: what you're building</h4>
                </div>
                
                <!-- Visual Pipeline Flow -->
                <div style="display: flex; align-items: center; justify-content: space-between; margin: 2rem 0; padding: 1.5rem; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                    <div style="text-align: center; flex: 1;">
                        <div style="background: #0078D4; color: white; padding: 1rem; border-radius: 8px; margin-bottom: 0.5rem; font-weight: 600;">
                            üì• INPUT
                        </div>
                        <p style="font-size: 0.85rem; color: #666; margin: 0.5rem 0 0 0;">
                            <code style="background: #E3F2FD; padding: 0.2rem 0.4rem; border-radius: 3px;">employee_id</code><br>
                            <code style="background: #E3F2FD; padding: 0.2rem 0.4rem; border-radius: 3px;">ticket text</code>
                        </p>
                    </div>
                    
                    <div style="flex: 0 0 auto; padding: 0 1rem; color: #0078D4; font-size: 1.5rem; font-weight: bold;">
                        ‚Üí
                    </div>
                    
                    <div style="text-align: center; flex: 1;">
                        <div style="background: #00B7C3; color: white; padding: 1rem; border-radius: 8px; margin-bottom: 0.5rem; font-weight: 600;">
                            ‚öôÔ∏è PROCESSING
                        </div>
                        <p style="font-size: 0.8rem; color: #666; margin: 0.5rem 0 0 0; line-height: 1.5;">
                            ‚úì Classify<br>
                            ‚úì Authorize<br>
                            ‚úì RAG Answer
                        </p>
                    </div>
                    
                    <div style="flex: 0 0 auto; padding: 0 1rem; color: #0078D4; font-size: 1.5rem; font-weight: bold;">
                        ‚Üí
                    </div>
                    
                    <div style="text-align: center; flex: 1;">
                        <div style="background: #4CAF50; color: white; padding: 1rem; border-radius: 8px; margin-bottom: 0.5rem; font-weight: 600;">
                            üì§ OUTPUT
                        </div>
                        <p style="font-size: 0.8rem; color: #666; margin: 0.5rem 0 0 0; line-height: 1.5;">
                            Status + Message
                        </p>
                    </div>
                </div>

                <!-- Detailed breakdown in three columns -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; margin-top: 2rem;">
                    <!-- Input Column -->
                    <div style="background: rgba(0,120,212,0.05); padding: 1rem; border-radius: 8px; border-left: 4px solid #0078D4;">
                        <p style="font-size: 0.9rem; color: #0078D4; margin-bottom: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">üì• Input (per request)</p>
                        <ul style="font-size: 0.9rem; color: #333; line-height: 1.7; margin: 0; padding-left: 1.25rem;">
                            <li><code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;">employee_id</code> ‚Äì who is raising the ticket</li>
                            <li><code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;">subject</code> + <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;">body</code> ‚Äì what problem they are reporting</li>
                        </ul>
                    </div>

                    <!-- Core Checks Column -->
                    <div style="background: rgba(0,183,195,0.05); padding: 1rem; border-radius: 8px; border-left: 4px solid #00B7C3;">
                        <p style="font-size: 0.9rem; color: #00B7C3; margin-bottom: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">‚öôÔ∏è Core checks</p>
                        <ul style="font-size: 0.9rem; color: #333; line-height: 1.7; margin: 0; padding-left: 1.25rem;">
                            <li>Is this ticket <strong>appropriate</strong> for this IT support bot?</li>
                            <li>Is this user <strong>allowed</strong> to raise this type of request?</li>
                            <li>If allowed, what does the <strong>KB</strong> say about it?</li>
                        </ul>
                    </div>

                    <!-- Output Column -->
                    <div style="background: rgba(76,175,80,0.05); padding: 1rem; border-radius: 8px; border-left: 4px solid #4CAF50;">
                        <p style="font-size: 0.9rem; color: #4CAF50; margin-bottom: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">üì§ Output (per ticket)</p>
                        <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.5rem;">
                            One of these <strong>final statuses</strong>:
                        </p>
                        <div style="font-size: 0.8rem; line-height: 1.8;">
                            <div style="margin-bottom: 0.3rem;">
                                <span class="chip" style="background: #D13438; color: white; font-size: 0.7rem; padding: 0.15rem 0.5rem;">blocked_appropriateness</span>
                            </div>
                            <div style="margin-bottom: 0.3rem;">
                                <span class="chip" style="background: #FF8C00; color: white; font-size: 0.7rem; padding: 0.15rem 0.5rem;">blocked_auth</span>
                            </div>
                            <div style="margin-bottom: 0.3rem;">
                                <span class="chip" style="background: #FFB74D; color: #333; font-size: 0.7rem; padding: 0.15rem 0.5rem;">needs_approval</span>
                            </div>
                            <div style="margin-bottom: 0.3rem;">
                                <span class="chip" style="background: #4CAF50; color: white; font-size: 0.7rem; padding: 0.15rem 0.5rem;">solved_by_rag</span>
                            </div>
                            <div style="margin-bottom: 0.3rem;">
                                <span class="chip" style="background: #9E9E9E; color: white; font-size: 0.7rem; padding: 0.15rem 0.5rem;">escalate</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="callout-info" style="margin-top: 1.5rem; text-align: center;">
                    <p style="margin: 0; font-size: 0.95rem;">
                        <strong>üí° Key Principle:</strong> Each ticket is treated as a <strong>stateless, independent call</strong><br>
                        <code style="background: rgba(0,120,212,0.1); padding: 0.3rem 0.6rem; border-radius: 4px; font-size: 0.9rem;">employee_id + ticket ‚Üí pipeline ‚Üí final status + message</code>
                    </p>
                </div>
            </div>

        </section>

        <!-- ========== PART A ‚Äì UNDERSTAND ========== -->
        
        <!-- Part A Header & Overview -->
        <section id="part-a-overview">
            <div style="text-align: center; margin-bottom: 2rem;">
                <h2 style="font-size: 2rem; margin-bottom: 0.5rem;">üîç Part A ‚Äì Understand the Problem & the Data</h2>
            </div>

            <!-- Chips -->
            <div style="margin: 0.75rem 0 2rem 0; text-align: center;">
                <span class="chip chip-scenario">USE CASE</span>
                <span class="chip chip-concept">DATA</span>
                <span class="chip chip-engine">PER-TICKET FLOW</span>
                <span class="chip chip-metric">OUTCOMES</span>
            </div>

            <!-- Intro paragraph -->
            <div class="card" style="background: linear-gradient(135deg, #FFF9E6 0%, #FFE8B3 100%); border-left: 5px solid #FF8C00; max-width: 900px; margin: 0 auto 2rem auto;">
                <p style="color: #333; margin: 0; line-height: 1.7; font-size: 1.05rem;">
                    In Part A, the goal is to <strong>understand what you're building</strong> before you write a single line of code.
                    By the end of this part, you should be able to explain the support copilot to someone else, sketch the per-ticket flow on a whiteboard, and know exactly what data is driving each decision.
                </p>
            </div>

            <!-- What Part A covers -->
            <div class="card" style="max-width: 950px; margin: 0 auto 2rem auto; background: #F8F9FA;">
                <h4 style="color: #0078D4; margin-top: 0; font-size: 1.2rem; text-align: center;">üìã What you'll find in Part A</h4>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
                    <!-- A.1 -->
                    <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid #0078D4; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <p style="font-weight: 700; color: #0078D4; margin-bottom: 0.5rem; font-size: 1rem;">
                            üìå A.1 ‚Äì Use case & outcomes
                        </p>
                        <ul style="font-size: 0.9rem; color: #555; line-height: 1.6; margin: 0; padding-left: 1.25rem;">
                            <li>The internal IT support scenario we're modeling</li>
                            <li>The 5 possible final statuses each ticket can end in</li>
                        </ul>
                    </div>

                    <!-- A.2 -->
                    <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid #00B7C3; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <p style="font-weight: 700; color: #00B7C3; margin-bottom: 0.5rem; font-size: 1rem;">
                            üìä A.2 ‚Äì Datasets & how they're used
                        </p>
                        <ul style="font-size: 0.9rem; color: #555; line-height: 1.6; margin: 0; padding-left: 1.25rem;">
                            <li>What's inside the employees, tickets, rules, and KB files</li>
                            <li>Which part of the pipeline each dataset influences</li>
                        </ul>
                    </div>

                    <!-- A.3 -->
                    <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid #4CAF50; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <p style="font-weight: 700; color: #4CAF50; margin-bottom: 0.5rem; font-size: 1rem;">
                            üîÑ A.3 ‚Äì Per-ticket stateless flow
                        </p>
                        <ul style="font-size: 0.9rem; color: #555; line-height: 1.6; margin: 0; padding-left: 1.25rem;">
                            <li>A step-by-step diagram from <code>employee_id + ticket</code> ‚Üí final status</li>
                            <li>How classifier, rules, and RAG fit together</li>
                        </ul>
                    </div>

                    <!-- A.4 -->
                    <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid #FF8C00; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <p style="font-weight: 700; color: #FF8C00; margin-bottom: 0.5rem; font-size: 1rem;">
                            üí° A.4 ‚Äì Worked example
                        </p>
                        <ul style="font-size: 0.9rem; color: #555; line-height: 1.6; margin: 0; padding-left: 1.25rem;">
                            <li>One sample ticket traced through classification, authorization, and RAG</li>
                            <li>Concrete illustration of what a "correct" run looks like</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Why this matters callout -->
            <div class="callout-info" style="max-width: 900px; margin: 0 auto;">
                <h4 style="margin-top: 0; color: #0078D4;">üéØ Why this part matters</h4>
                <p style="margin-bottom: 0.5rem;">
                    If Part A is clear, Part B becomes straightforward: every development stage simply implements one piece of the flow you already understand.
                </p>
                <p style="margin: 0;">
                    When in doubt during implementation, you should be able to come back here and ask:<br>
                    <em>"For this kind of ticket and user, which outcome is the pipeline supposed to produce?"</em>
                </p>
            </div>

        </section>

        <!-- A.1 Business Scenario & Use Case -->
        <section id="part-a-usecase">
            <h3 style="color: #0078D4; font-size: 1.5rem;">üìã A.1 ‚Äì Use Case: Guard-Railed Internal IT Support</h3>

            <!-- Chips for this subsection -->
            <div style="margin: 0.75rem 0 1.5rem 0;">
                <span class="chip chip-scenario">INTERNAL IT</span>
                <span class="chip chip-hands-on">SUPPORT PORTAL</span>
                <span class="chip chip-issue">GUARDRAILS</span>
            </div>

            <!-- Business scenario card with story -->
            <div class="card" style="background: linear-gradient(135deg, #FFF9E6 0%, #FFE8B3 100%); border-left: 5px solid #FF8C00; box-shadow: 0 4px 12px rgba(255,140,0,0.15);">
                <h4 style="color: #FF8C00; margin-top: 0; font-size: 1.2rem;">üìñ The Story</h4>
                
                <p style="font-size: 1rem; margin-bottom: 1.25rem; line-height: 1.7; color: #333;">
                    Imagine an internal <strong>IT support portal</strong> that every employee in your company uses.
                    People raise tickets like:
                </p>

                <div style="background: white; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 3px solid #FF8C00;">
                    <ul style="font-size: 0.95rem; line-height: 1.8; margin: 0; color: #333; list-style-position: outside; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.5rem;">"I can't log into VPN from home."</li>
                        <li style="margin-bottom: 0.5rem;">"Please reset my Windows password."</li>
                        <li style="margin-bottom: 0;">"Give me admin access to the production database."</li>
                    </ul>
                </div>

                <p style="font-size: 0.95rem; margin-bottom: 0.75rem; color: #333;">
                    <strong style="color: #D13438;">‚ö†Ô∏è Today, a naive LLM-based bot might:</strong>
                </p>
                <ul style="font-size: 0.95rem; line-height: 1.8; margin-bottom: 1.5rem; color: #555; list-style-position: outside; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.5rem;">cheerfully answer <strong>random general questions</strong> ("What is 2+2?", "Write me a pandas script") even though that's not IT support, and</li>
                    <li style="margin-bottom: 0;">respond to <strong>requests users should not be allowed to make</strong> ("Give me prod DB access") without checking any policy or role.</li>
                </ul>

                <p style="font-size: 0.95rem; margin-bottom: 0.75rem; color: #333;">
                    <strong style="color: #4CAF50;">‚úÖ In this hackathon, your job is to design a small <span style="color: #0078D4;">guard-railed copilot</span> that:</strong>
                </p>
                <ol style="font-size: 0.95rem; line-height: 1.9; margin-bottom: 1.5rem; color: #333; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.6rem;">Accepts an <strong>employee id + ticket text</strong></li>
                    <li style="margin-bottom: 0.6rem;">Decides whether the ticket is <strong>in scope</strong> for this IT support portal</li>
                    <li style="margin-bottom: 0.6rem;">Checks whether the employee is <strong>allowed</strong> to ask for this type of action</li>
                    <li style="margin-bottom: 0.6rem;">Uses a <strong>knowledge base of FAQs and policies</strong> to answer valid, allowed tickets</li>
                    <li style="margin-bottom: 0;">Returns a <strong>clear final status</strong> for every ticket (blocked_by_appropriateness, blocked_by_auth, needs_approval, solved_by_rag, escalate)</li>
                </ol>
            </div>

            <!-- Key idea callout -->
            <div class="callout-info" style="margin-top: 1.5rem; background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); border-left: 5px solid #0078D4;">
                <h4 style="margin-top: 0; color: #0078D4;">üí° Key idea</h4>
                <p style="margin: 0; font-size: 1rem; line-height: 1.6;">
                    This is not "ask me anything". This is <strong>"I'm an internal IT support assistant, with clear <span style="color: #0078D4;">guardrails</span> and a <span style="color: #0078D4;">policy-aware brain</span>."</strong>
                </p>
            </div>

        </section>

        <!-- A.1.2 Per-Ticket Final Outcomes -->
        <section id="part-a-outcomes">
            <h3 style="color: #0078D4; font-size: 1.4rem; margin-top: 3rem;">üéØ A.1.2 ‚Äì Final outcomes for each ticket</h3>

            <p style="color: #333; margin-bottom: 1.5rem; line-height: 1.7; font-size: 1rem;">
                Every time your pipeline processes a ticket, it should end in <strong>exactly one</strong> of a small set of <strong>final outcomes</strong>.
                These outcomes are what we'll use to reason about correctness and to label the sample data.
            </p>

            <!-- Outcomes table with 5 statuses -->
            <div style="overflow-x: auto; margin-bottom: 2rem;">
                <table style="box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #F5F5F5 0%, #E0E0E0 100%);">
                            <th style="width: 22%; color: #333; font-weight: 600;">Final Status</th>
                            <th style="width: 42%; color: #333; font-weight: 600;">What it means (logic)</th>
                            <th style="width: 36%; color: #333; font-weight: 600;">Typical example (conceptual)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: rgba(209, 52, 56, 0.05);">
                            <td>
                                <span class="chip" style="background: linear-gradient(135deg, #D13438 0%, #B71C1C 100%); color: white; font-size: 0.75rem; font-weight: 600; box-shadow: 0 2px 4px rgba(209,52,56,0.3);">‚õî blocked_by_appropriateness</span>
                            </td>
                            <td style="font-size: 0.9rem; line-height: 1.6;">
                                The ticket is <strong>out of scope</strong> for this IT support bot. It's not an IT/helpdesk issue at all.
                            </td>
                            <td style="font-size: 0.85rem; font-style: italic; color: #666;">
                                "What is 2+2?", "Write me Python code for X"
                            </td>
                        </tr>
                        <tr style="background: rgba(255, 140, 0, 0.05);">
                            <td>
                                <span class="chip" style="background: linear-gradient(135deg, #FF8C00 0%, #FF7700 100%); color: white; font-size: 0.75rem; font-weight: 600; box-shadow: 0 2px 4px rgba(255,140,0,0.3);">üö´ blocked_by_auth</span>
                            </td>
                            <td style="font-size: 0.9rem; line-height: 1.6;">
                                The ticket <strong>is</strong> an IT/support request, but this employee is <strong>not allowed</strong> to make this request.
                            </td>
                            <td style="font-size: 0.85rem; font-style: italic; color: #666;">
                                L1 engineer asking for "direct production DB access"
                            </td>
                        </tr>
                        <tr style="background: rgba(255, 183, 77, 0.05);">
                            <td>
                                <span class="chip" style="background: linear-gradient(135deg, #FFB74D 0%, #FFA726 100%); color: #333; font-size: 0.75rem; font-weight: 600; box-shadow: 0 2px 4px rgba(255,183,77,0.3);">‚ö†Ô∏è needs_approval</span>
                            </td>
                            <td style="font-size: 0.9rem; line-height: 1.6;">
                                The ticket is valid and in-scope, but it <strong>requires a higher-level approval</strong> before proceeding.
                            </td>
                            <td style="font-size: 0.85rem; font-style: italic; color: #666;">
                                Standard user asking for a <strong>GPU laptop</strong> or <strong>server change</strong>
                            </td>
                        </tr>
                        <tr style="background: rgba(76, 175, 80, 0.05);">
                            <td>
                                <span class="chip" style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; font-size: 0.75rem; font-weight: 600; box-shadow: 0 2px 4px rgba(76,175,80,0.3);">‚úÖ solved_by_rag</span>
                            </td>
                            <td style="font-size: 0.9rem; line-height: 1.6;">
                                The ticket is appropriate and allowed, and the system can <strong>answer it using the KB + LLM</strong>.
                            </td>
                            <td style="font-size: 0.85rem; font-style: italic; color: #666;">
                                "I forgot my password, how do I reset it?", "VPN disconnects‚Ä¶"
                            </td>
                        </tr>
                        <tr style="background: rgba(158, 158, 158, 0.05);">
                            <td>
                                <span class="chip" style="background: linear-gradient(135deg, #9E9E9E 0%, #757575 100%); color: white; font-size: 0.75rem; font-weight: 600; box-shadow: 0 2px 4px rgba(158,158,158,0.3);">‚ÜóÔ∏è escalate</span>
                            </td>
                            <td style="font-size: 0.9rem; line-height: 1.6;">
                                The ticket is appropriate and allowed, but the KB <strong>does not contain a good answer</strong> or the issue is too complex, so we <strong>escalate to a human agent</strong>.
                            </td>
                            <td style="font-size: 0.85rem; font-style: italic; color: #666;">
                                Brand-new bug, unusual setup not documented in KB
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Clarifying paragraph -->
            <div class="callout-info" style="margin-top: 1.5rem;">
                <p style="margin: 0; font-size: 0.95rem; line-height: 1.6;">
                    <strong>üí° Think of it as a state machine:</strong><br>
                    For this hackathon, you can think of the system as a small <strong>state machine</strong> that maps
                    <code style="background: rgba(0,120,212,0.1); padding: 0.2rem 0.5rem; border-radius: 3px;">employee_id + ticket ‚Üí one of these outcomes</code>.<br>
                    <br>
                    Part B will walk you through how to implement the pieces (classifier, rules, RAG) that lead to each status.
                    When you test with the sample tickets, your job is to make sure each ticket lands in the <strong>intended bucket</strong>.
                </p>
            </div>

        </section>

        <!-- A.2 Datasets & Roles -->
        <section id="part-a-data">
            <h3 style="color: #0078D4; font-size: 1.5rem; margin-top: 3rem;">üìä A.2 ‚Äì Datasets You Get & How They Are Used</h3>

            <div class="card" style="background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); border-left: 5px solid #4CAF50; margin-bottom: 2rem;">
                <p style="color: #333; margin: 0; line-height: 1.7; font-size: 1rem;">
                    In this exercise you're not starting from a blank slate.
                    You get a small synthetic "company" packaged as CSV/YAML/markdown files.
                    Each file plays a very specific role in the pipeline: <strong>who is asking</strong>, <strong>what they're asking</strong>, <strong>what the policy says</strong>, and <strong>what the KB knows</strong>.
                </p>
            </div>

            <p style="color: #333; margin-bottom: 2rem; line-height: 1.7; font-size: 1rem;">
                We'll use four main datasets:
            </p>

            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.25rem; margin-bottom: 2.5rem;">
                <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); padding: 1.25rem; border-radius: 8px; border: 2px solid #0078D4; box-shadow: 0 3px 8px rgba(0,120,212,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                        <div style="background: linear-gradient(135deg, #0078D4 0%, #0063B1 100%); color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.9rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(0,120,212,0.3);">1</div>
                        <p style="font-weight: 600; color: #0078D4; margin: 0; font-size: 1rem;">Employees data</p>
                    </div>
                    <p style="font-size: 0.85rem; margin: 0; color: #555; line-height: 1.5;">who is the user?</p>
                </div>
                <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFE8B3 100%); padding: 1.25rem; border-radius: 8px; border: 2px solid #FF8C00; box-shadow: 0 3px 8px rgba(255,140,0,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                        <div style="background: linear-gradient(135deg, #FF8C00 0%, #FF7700 100%); color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.9rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(255,140,0,0.3);">2</div>
                        <p style="font-weight: 600; color: #FF8C00; margin: 0; font-size: 1rem;">Sample tickets</p>
                    </div>
                    <p style="font-size: 0.85rem; margin: 0; color: #555; line-height: 1.5;">what kinds of tickets should the system handle?</p>
                </div>
                <div style="background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%); padding: 1.25rem; border-radius: 8px; border: 2px solid #E91E63; box-shadow: 0 3px 8px rgba(233,30,99,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                        <div style="background: linear-gradient(135deg, #E91E63 0%, #D81B60 100%); color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.9rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(233,30,99,0.3);">3</div>
                        <p style="font-weight: 600; color: #C2185B; margin: 0; font-size: 1rem;">Authorization rules</p>
                    </div>
                    <p style="font-size: 0.85rem; margin: 0; color: #555; line-height: 1.5;">what is allowed vs needs approval vs forbidden?</p>
                </div>
                <div style="background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); padding: 1.25rem; border-radius: 8px; border: 2px solid #4CAF50; box-shadow: 0 3px 8px rgba(76,175,80,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                        <div style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.9rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(76,175,80,0.3);">4</div>
                        <p style="font-weight: 600; color: #2E7D32; margin: 0; font-size: 1rem;">Knowledge base docs</p>
                    </div>
                    <p style="font-size: 0.85rem; margin: 0; color: #555; line-height: 1.5;">what the copilot can read to answer questions</p>
                </div>
            </div>

            <!-- Dataset 1: Employees -->
            <div class="card" style="background: linear-gradient(135deg, #F3F9FF 0%, #E3F2FD 100%); border-left: 5px solid #0078D4; box-shadow: 0 4px 12px rgba(0,120,212,0.1);">
                <h4 style="color: #0078D4; margin-top: 0; font-size: 1.2rem;">1Ô∏è‚É£ A.2.1 Employees ‚Äì who is raising the ticket?</h4>
                
                <p style="font-size: 1rem; margin-bottom: 1rem; line-height: 1.6; color: #333;">
                    This dataset answers: <strong>"Who is this employee and what can they typically do?"</strong>
                </p>

                <p style="font-size: 0.95rem; margin-bottom: 1.25rem; color: #555; line-height: 1.6;">
                    <strong>Schema</strong> (from <code>users_roles.csv</code>):
                </p>

                <div style="overflow-x: auto; margin-bottom: 1.5rem;">
                    <table style="font-size: 0.9rem; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #F5F5F5 0%, #E0E0E0 100%);">
                                <th style="color: #333;">Column</th>
                                <th style="color: #333;">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>employee_id</code></td>
                                <td>Unique identifier for the employee (e.g. <code>E001</code>, <code>E002</code>, ...).</td>
                            </tr>
                            <tr>
                                <td><code>role</code></td>
                                <td>Job role, e.g. <code>intern</code>, <code>junior_engineer</code>, <code>senior_analyst</code>, <code>manager</code>.</td>
                            </tr>
                            <tr>
                                <td><code>department</code></td>
                                <td>Department such as <code>engineering</code>, <code>finance</code>, <code>sales</code>, <code>hr</code>, <code>it_support</code>.</td>
                            </tr>
                            <tr>
                                <td><code>seniority</code></td>
                                <td>Seniority level: <code>junior</code>, <code>mid</code>, <code>senior</code>, or <code>lead</code>.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 3px solid #0078D4; margin-bottom: 1rem;">
                    <p style="font-weight: 600; color: #0078D4; margin: 0 0 0.5rem 0; font-size: 0.95rem;">üîÑ How the pipeline uses this:</p>
                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem; color: #333; line-height: 1.6;">
                        When a request comes in with an <code>employee_id</code>, the system:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Looks up that row in the employees data.</li>
                        <li style="margin-bottom: 0.4rem;">Pulls out <code>role</code>, <code>department</code>, and <code>seniority</code>.</li>
                        <li style="margin-bottom: 0;">These fields are then passed to the <strong>authorization logic</strong> to decide whether a given category/action is <strong>allowed</strong>, <strong>needs_approval</strong>, or <strong>blocked_by_auth</strong>.</li>
                    </ul>
                </div>

                <div style="background: #F5F5F5; padding: 1rem; border-radius: 6px; margin-top: 1rem;">
                    <p style="font-weight: 600; color: #0078D4; margin: 0 0 0.75rem 0; font-size: 0.9rem;">üìÑ File: <code>users_roles.csv</code></p>
                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                        This file contains 20 employees across 5 departments (engineering, finance, sales, hr, it_support) with 18 unique roles and 4 seniority levels.
                    </p>
                    <div style="background: #1E1E1E; color: #D4D4D4; padding: 0.75rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.75rem; overflow-x: auto;">
<pre style="margin: 0; line-height: 1.5;"><span style="color: #6A9955;">employee_id,role,department,seniority</span>
<span style="color: #CE9178;">E001</span>,intern,engineering,junior
<span style="color: #CE9178;">E002</span>,junior_engineer,engineering,junior
<span style="color: #CE9178;">E006</span>,analyst,finance,junior
<span style="color: #CE9178;">E007</span>,senior_analyst,finance,mid
<span style="color: #CE9178;">E013</span>,it_support_engineer,it_support,junior</pre>
                    </div>
                </div>
            </div>

            <!-- Dataset 2: Sample Tickets -->
            <div class="card" style="background: linear-gradient(135deg, #FFF9E6 0%, #FFE8B3 100%); border-left: 5px solid #FF8C00; box-shadow: 0 4px 12px rgba(255,140,0,0.1); margin-top: 2rem;">
                <h4 style="color: #FF8C00; margin-top: 0; font-size: 1.2rem;">2Ô∏è‚É£ A.2.2 Sample tickets ‚Äì what the pipeline will be tested on</h4>
                
                <p style="font-size: 1rem; margin-bottom: 1rem; line-height: 1.6; color: #333;">
                    This dataset answers: <strong>"What kinds of tickets should my system handle, and what outcome is expected?"</strong>
                </p>

                <p style="font-size: 0.95rem; margin-bottom: 1.25rem; color: #555; line-height: 1.6;">
                    Each row represents <strong>one independent run</strong> of your pipeline.
                </p>

                <p style="font-size: 0.95rem; margin-bottom: 1rem; color: #555; line-height: 1.6;">
                    <strong>Schema</strong> (from <code>support_tickets_labeled_full.csv</code>):
                </p>

                <div style="overflow-x: auto; margin-bottom: 1.5rem;">
                    <table style="font-size: 0.85rem; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #F5F5F5 0%, #E0E0E0 100%);">
                                <th style="color: #333;">Column</th>
                                <th style="color: #333;">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>ticket_id</code></td>
                                <td>Unique identifier for the ticket.</td>
                            </tr>
                            <tr>
                                <td><code>employee_id</code></td>
                                <td>Who raised this ticket (must match an employee in the employees data).</td>
                            </tr>
                            <tr>
                                <td><code>subject</code></td>
                                <td>Short title of the issue.</td>
                            </tr>
                            <tr>
                                <td><code>body</code></td>
                                <td>Full description of the problem.</td>
                            </tr>
                            <tr>
                                <td><code>expected_appropriateness</code></td>
                                <td>For reference: <code>appropriate</code> / <code>not_appropriate</code>.</td>
                            </tr>
                            <tr>
                                <td><code>expected_category</code></td>
                                <td>For reference: the intended category label (e.g. <code>hardware_issue</code>, <code>access_request</code>, <code>policy_question</code>, ‚Ä¶).</td>
                            </tr>
                            <tr>
                                <td><code>expected_auth_outcome</code></td>
                                <td>For reference: <code>allowed</code>, <code>needs_approval</code>, or <code>blocked_by_auth</code>.</td>
                            </tr>
                            <tr>
                                <td><code>expected_pipeline_result</code></td>
                                <td>The <strong>final status</strong> the ticket should end in (one of the statuses from A.1.2).</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 3px solid #FF8C00; margin-bottom: 1rem;">
                    <p style="font-weight: 600; color: #FF8C00; margin: 0 0 0.5rem 0; font-size: 0.95rem;">üîÑ How the pipeline uses this:</p>
                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem; color: #333; line-height: 1.6;">
                        During development and evaluation, you <strong>don't train on this file</strong>. Instead, you:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0 0 0.75rem 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Read each row,</li>
                        <li style="margin-bottom: 0.4rem;">Feed <code>employee_id</code>, <code>subject</code>, <code>body</code> into your pipeline,</li>
                        <li style="margin-bottom: 0;">Compare your final <code>status</code> with <code>expected_pipeline_result</code>.</li>
                    </ul>
                    <p style="font-size: 0.9rem; margin: 0; color: #555; line-height: 1.6;">
                        The rows are designed so that across the file, you see <strong>all five flows</strong>: blocked_by_appropriateness, blocked_by_auth, needs_approval, solved_by_rag, escalate.
                    </p>
                </div>

                <div style="background: #F5F5F5; padding: 1rem; border-radius: 6px; margin-top: 1rem;">
                    <p style="font-weight: 600; color: #FF8C00; margin: 0 0 0.75rem 0; font-size: 0.9rem;">üìÑ File: <code>support_tickets_labeled_full.csv</code></p>
                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                        This file contains 50 tickets covering all 7 categories and all 5 flows. Each ticket has complete ground truth labels for evaluation.
                    </p>
                    <div style="background: #1E1E1E; color: #D4D4D4; padding: 0.75rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.7rem; overflow-x: auto;">
<pre style="margin: 0; line-height: 1.5;"><span style="color: #6A9955;">ticket_id,employee_id,subject,body,expected_appropriateness,expected_category,expected_auth_outcome,expected_pipeline_result</span>
<span style="color: #CE9178;">T001</span>,E008,General Query,"Please arrange pest control...",<span style="color: #FF8C00;">not_appropriate</span>,<span style="color: #9CDCFE;">off_scope</span>,blocked_by_auth,<span style="color: #D32F2F;">blocked_by_auth</span>
<span style="color: #CE9178;">T005</span>,E002,General Query,"Please give me the CEO's mailbox password...",<span style="color: #FF8C00;">not_appropriate</span>,<span style="color: #9CDCFE;">access_request</span>,blocked_by_auth,<span style="color: #D32F2F;">blocked_by_appropriateness</span>
<span style="color: #CE9178;">T009</span>,E004,General Query,"Please give me admin rights on the finance ERP...",<span style="color: #4CAF50;">appropriate</span>,<span style="color: #9CDCFE;">access_request</span>,blocked_by_auth,<span style="color: #D32F2F;">blocked_by_auth</span>
<span style="color: #CE9178;">T013</span>,E005,General Query,"Please add me to the confidential finance reports...",<span style="color: #4CAF50;">appropriate</span>,<span style="color: #9CDCFE;">access_request</span>,needs_approval,<span style="color: #FFB74D;">needs_approval</span>
<span style="color: #CE9178;">T017</span>,E002,General Query,"My Lenovo ThinkPad laptop's N key is stuck...",<span style="color: #4CAF50;">appropriate</span>,<span style="color: #9CDCFE;">hardware_issue</span>,allowed,<span style="color: #4CAF50;">solved_by_rag</span></pre>
                    </div>
                </div>

                <div style="background: #E3F2FD; padding: 1rem; border-radius: 6px; border-left: 3px solid #0078D4; margin-top: 1rem;">
                    <p style="font-weight: 600; color: #0078D4; margin: 0 0 0.5rem 0; font-size: 0.9rem;">üìã Alternative Format: <code>support_tickets_seed_detailed.csv</code></p>
                    <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">
                        Simpler format with <code>ticket_text</code> (combines subject+body) and <code>expected_intent</code> (instead of expected_category). Same 50 tickets, same ground truth values. Use whichever format you prefer!
                    </p>
                </div>

            </div>

            <!-- Dataset 3: Authorization Rules -->
            <div class="card" style="background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%); border-left: 5px solid #E91E63; box-shadow: 0 4px 12px rgba(233,30,99,0.1); margin-top: 2rem;">
                <h4 style="color: #C2185B; margin-top: 0; font-size: 1.2rem;">3Ô∏è‚É£ A.2.3 Authorization rules ‚Äì the policy brain (rules, not LLM)</h4>
                
                <p style="font-size: 1rem; margin-bottom: 1rem; line-height: 1.6; color: #333;">
                    This dataset answers: <strong>"For this type of user, is this type of request allowed?"</strong>
                </p>

                <p style="font-size: 0.95rem; margin-bottom: 1.25rem; color: #555; line-height: 1.6;">
                    Think of it as a small <strong>configuration file</strong> that defines a policy matrix:
                </p>

                <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1.25rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;">Each rule matches: <strong>intent</strong> + <strong>role</strong> + <strong>department</strong></li>
                    <li style="margin-bottom: 0.4rem;">Wildcards (*) match any value for that field</li>
                    <li style="margin-bottom: 0;">outcome = <code>allowed</code> / <code>needs_approval</code> / <code>blocked_by_auth</code></li>
                </ul>

                <p style="font-size: 0.95rem; margin-bottom: 1rem; color: #555; line-height: 1.6;">
                    <strong>Actual structure</strong> (from <code>auth_rules.csv</code>):
                </p>

                <div style="background: #1E1E1E; color: #D4D4D4; padding: 1.25rem; border-radius: 8px; margin-bottom: 1.5rem; font-family: 'Courier New', monospace; font-size: 0.85rem; overflow-x: auto; border: 1px solid #3C3C3C;">
<pre style="margin: 0; line-height: 1.6;"><span style="color: #6A9955;">intent,role,department,outcome,rule_id,comment</span>
<span style="color: #CE9178;">hardware_issue</span>,*,*,<span style="color: #4CAF50;">allowed</span>,R1,All employees can raise hardware issues.
<span style="color: #CE9178;">software_issue</span>,*,*,<span style="color: #4CAF50;">allowed</span>,R2,All employees can raise software issues.
<span style="color: #CE9178;">access_request</span>,<span style="color: #9CDCFE;">intern</span>,*,<span style="color: #FFB74D;">needs_approval</span>,R4,Interns require manager approval.
<span style="color: #CE9178;">access_request</span>,<span style="color: #9CDCFE;">junior_engineer</span>,engineering,<span style="color: #FF8C00;">blocked_by_auth</span>,R11,Junior engineers cannot request admin rights.
<span style="color: #CE9178;">off_scope</span>,*,*,<span style="color: #FF8C00;">blocked_by_auth</span>,R15,Off-scope requests cannot be handled by IT.
<span style="color: #CE9178;">policy_question</span>,*,*,<span style="color: #4CAF50;">allowed</span>,R17,General policy questions allowed for all employees.</pre>
                </div>

                <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 3px solid #E91E63; margin-bottom: 1rem;">
                    <p style="font-weight: 600; color: #C2185B; margin: 0 0 0.5rem 0; font-size: 0.95rem;">üîÑ How the pipeline uses this:</p>
                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem; color: #333; line-height: 1.6;">
                        Given:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0 0 0.75rem 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">ticket <code>intent</code>/<code>category</code> (from the classifier),</li>
                        <li style="margin-bottom: 0.4rem;">employee's <code>role</code> and <code>department</code>,</li>
                        <li style="margin-bottom: 0;">The <strong>rule engine</strong> matches against the rules and decides: <code>allowed</code> ‚Üí proceed to RAG, <code>needs_approval</code> ‚Üí stop, ask for approval, <code>blocked_by_auth</code> ‚Üí stop, block the request.</li>
                    </ul>
                </div>

                <div class="callout-warning" style="margin-top: 1rem;">
                    <p style="font-size: 0.9rem; margin: 0;">
                        <strong>‚ö†Ô∏è Important:</strong> This part is <strong>deliberately non-LLM</strong>: it's plain code reading a config file.
                    </p>
                </div>

                <div style="background: #F5F5F5; padding: 1rem; border-radius: 6px; margin-top: 1rem;">
                    <p style="font-weight: 600; color: #E91E63; margin: 0 0 0.75rem 0; font-size: 0.9rem;">üìÑ File: <code>auth_rules.csv</code></p>
                    <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">
                        This file contains 17 authorization rules that map (<code>intent</code>, <code>role</code>, <code>department</code>) combinations to outcomes. Wildcards (*) match any value for that field, allowing rules like "all employees can raise hardware issues" or "junior engineers in engineering cannot request admin rights".
                    </p>
                </div>
            </div>

            <!-- Dataset 4: Knowledge Base -->
            <div class="card" style="background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); border-left: 5px solid #4CAF50; box-shadow: 0 4px 12px rgba(76,175,80,0.1); margin-top: 2rem;">
                <h4 style="color: #2E7D32; margin-top: 0; font-size: 1.2rem;">4Ô∏è‚É£ A.2.4 Knowledge base ‚Äì FAQs and policies for RAG</h4>
                
                <p style="font-size: 1rem; margin-bottom: 1rem; line-height: 1.6; color: #333;">
                    This dataset answers: <strong>"What does the copilot know, and where does it read answers from?"</strong>
                </p>

                <p style="font-size: 0.95rem; margin-bottom: 1.25rem; color: #555; line-height: 1.6;">
                    It's a folder of docs that are <strong>ingested into a vector store</strong> and used as context for answer generation.
                </p>

                <p style="font-size: 0.95rem; margin-bottom: 0.75rem; color: #333; font-weight: 600;">üìÅ Example KB document structure:</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                    <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid #4CAF50;">
                        <p style="font-size: 0.85rem; color: #2E7D32; font-weight: 600; margin: 0 0 0.5rem 0;">FAQ-style docs:</p>
                        <ul style="font-size: 0.85rem; line-height: 1.7; margin: 0; padding-left: 1.25rem; color: #555;">
                            <li><code>faq_hardware_issues.md</code></li>
                            <li><code>faq_software_issues.md</code></li>
                            <li><code>faq_network_issues.md</code></li>
                        </ul>
                    </div>
                    <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid #FF8C00;">
                        <p style="font-size: 0.85rem; color: #FF8C00; font-weight: 600; margin: 0 0 0.5rem 0;">Policy docs:</p>
                        <ul style="font-size: 0.85rem; line-height: 1.7; margin: 0; padding-left: 1.25rem; color: #555;">
                            <li><code>policy_access_requests.md</code></li>
                            <li><code>policy_questions.md</code></li>
                            <li><code>policy_support_scope.md</code></li>
                        </ul>
                    </div>
                </div>

                <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 3px solid #4CAF50; margin-bottom: 1rem;">
                    <p style="font-weight: 600; color: #2E7D32; margin: 0 0 0.5rem 0; font-size: 0.95rem;">üîÑ How the pipeline uses this:</p>
                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem; color: #333; line-height: 1.6;">
                        At startup or on first call, you:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0 0 0.75rem 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Load these files,</li>
                        <li style="margin-bottom: 0.4rem;">Split them into chunks,</li>
                        <li style="margin-bottom: 0.4rem;">Build embeddings + vector store,</li>
                        <li style="margin-bottom: 0;">Expose a <strong>retriever</strong>.</li>
                    </ul>
                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem; color: #333; line-height: 1.6;">
                        For any ticket that is <strong>appropriate and allowed</strong>:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">You query the retriever with the ticket text,</li>
                        <li style="margin-bottom: 0.4rem;">Get back the most relevant chunks,</li>
                        <li style="margin-bottom: 0.4rem;">Pass those chunks into your <strong>LLM support prompt</strong>,</li>
                        <li style="margin-bottom: 0;">The LLM uses them to generate a grounded answer.</li>
                    </ul>
                </div>

                <div class="callout-info" style="margin-top: 1rem; background: rgba(255,255,255,0.8); border-left: 3px solid #2E7D32;">
                    <p style="font-size: 0.9rem; margin: 0;">
                        <strong>üí° Safe behavior:</strong> If the KB doesn't contain anything useful for a particular request, admit you cannot resolve it and return status <code>escalate</code>.
                    </p>
                </div>

                <div style="background: #FFF9E6; padding: 1rem; border-radius: 6px; border-left: 3px solid #4CAF50; margin-top: 1rem;">
                    <p style="font-weight: 600; color: #2E7D32; margin: 0 0 0.5rem 0; font-size: 0.9rem;">üìù Note about KB Documents:</p>
                    <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">
                        Knowledge base documents will be provided separately. These cover FAQs and policies for each ticket category (hardware_issue, software_issue, network_issue, access_request, policy_question). You'll need to implement RAG to retrieve relevant context from these docs when answering tickets.
                    </p>
                </div>
            </div>

            <!-- Data connection mental model -->
            <div class="card" style="margin-top: 2.5rem; background: linear-gradient(135deg, #F3F9FF 0%, #E3F2FD 100%); border-left: 5px solid #0078D4;">
                <h4 style="color: #0078D4; margin-top: 0; font-size: 1.2rem;">üîó A.2.5 How the datasets connect to the pipeline (mental map)</h4>
                
                <p style="font-size: 0.95rem; margin-bottom: 1.25rem; line-height: 1.7; color: #333;">
                    <strong>Mental model:</strong>
                </p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                    <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid #0078D4;">
                        <p style="font-size: 0.85rem; margin: 0; color: #333; line-height: 1.6;">
                            <strong style="color: #0078D4;">Employees data</strong> ‚Üí tells you "who is this?"
                        </p>
                    </div>
                    <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid #FF8C00;">
                        <p style="font-size: 0.85rem; margin: 0; color: #333; line-height: 1.6;">
                            <strong style="color: #FF8C00;">Sample tickets</strong> ‚Üí tells you "what scenarios should I handle, and what's the target outcome?"
                        </p>
                    </div>
                    <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid #E91E63;">
                        <p style="font-size: 0.85rem; margin: 0; color: #333; line-height: 1.6;">
                            <strong style="color: #C2185B;">Authorization rules</strong> ‚Üí encode "what is allowed/gated/blocked for each profile?"
                        </p>
                    </div>
                    <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid #4CAF50;">
                        <p style="font-size: 0.85rem; margin: 0; color: #333; line-height: 1.6;">
                            <strong style="color: #2E7D32;">KB docs</strong> ‚Üí give the copilot something to <strong>read</strong> when it tries to answer allowed tickets
                        </p>
                    </div>
                </div>

                <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.7; color: #333;">
                    When a ticket flows through your pipeline, it touches <strong>all four</strong>:
                </p>

                <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1.5rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;">Uses <strong>employees</strong> to know the role,</li>
                    <li style="margin-bottom: 0.4rem;">Uses <strong>rules</strong> to decide allowed vs blocked vs needs approval,</li>
                    <li style="margin-bottom: 0.4rem;">Uses <strong>KB</strong> to answer,</li>
                    <li style="margin-bottom: 0;">And can be checked against <strong>sample tickets</strong> to see if the final status is correct.</li>
                </ul>
            </div>

            <!-- Data flow mermaid -->
            <h4 style="margin-top: 2rem; color: #0078D4; font-size: 1.1rem; text-align: center;">üìä Visual: How Datasets Feed Into the Pipeline</h4>
            
            <div class="card" style="background: #FAFAFA; padding: 2rem;">
                <div class="mermaid">
                    flowchart LR
                        Tickets[Sample Tickets] --> Pipeline[Ticket Pipeline]
                        Employees[Employees Data] --> Pipeline
                        Rules[Auth Rules Config] --> Pipeline
                        KB[KB Docs] --> Retriever[Retriever]
                        Retriever --> Pipeline
                        Pipeline --> Outcomes[Per-Ticket Outcomes]
                        
                        style Tickets fill:#FFF3E0,stroke:#FF8C00,stroke-width:2px
                        style Employees fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                        style Rules fill:#FCE4EC,stroke:#E91E63,stroke-width:2px
                        style KB fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                        style Retriever fill:#C8E6C9,stroke:#2E7D32,stroke-width:2px
                        style Pipeline fill:#E3F2FD,stroke:#0078D4,stroke-width:3px
                        style Outcomes fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                </div>
            </div>

        </section>

        <!-- A.3 Per-Ticket Stateless Flow -->
        <section id="part-a-flow">
            <h3 style="color: #0078D4; font-size: 1.5rem; margin-top: 3rem;">üîÑ A.3 ‚Äì Per-Ticket Stateless Flow</h3>

            <!-- Intro explanation -->
            <div class="card" style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); border-left: 5px solid #0078D4; margin-bottom: 2rem;">
                <p style="font-size: 1rem; margin-bottom: 1rem; line-height: 1.7; color: #333;">
                    Every request your copilot handles is treated as <strong>one independent ticket</strong>:<br>
                    <code style="background: white; padding: 0.3rem 0.6rem; border-radius: 4px; font-size: 0.95rem;">employee_id + ticket ‚Üí pipeline ‚Üí final status + message/answer</code>
                </p>
                <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.7; color: #333;">
                    The pipeline doesn't remember previous tickets or chat turns; it always goes through the same sequence of steps:
                </p>
                <ol style="font-size: 0.95rem; line-height: 1.8; color: #333; margin-bottom: 1rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;">Identify who the employee is</li>
                    <li style="margin-bottom: 0.4rem;">Classify what the ticket is about and whether it is in scope</li>
                    <li style="margin-bottom: 0.4rem;">Apply authorization rules based on the employee's profile</li>
                    <li style="margin-bottom: 0.4rem;">If allowed, try to answer using the knowledge base</li>
                    <li style="margin-bottom: 0;">Return a <strong>single final outcome</strong> (one of the statuses from A.1.2)</li>
                </ol>
            </div>

            <div class="callout-info" style="margin-bottom: 2rem;">
                <p style="margin: 0; font-size: 1rem; line-height: 1.6;">
                    <strong>üí° Pure function thinking:</strong><br>
                    You can think of the system as a <strong>pure function</strong>:<br>
                    <code style="background: rgba(0,120,212,0.1); padding: 0.3rem 0.6rem; border-radius: 4px; font-size: 0.95rem;">f(employee_id, ticket) ‚Üí {status, message/answer, debug_info}</code>
                </p>
            </div>

            <!-- A.3.1 Flow diagram -->
            <h4 style="color: #0078D4; font-size: 1.2rem; margin-bottom: 1rem;">A.3.1 ‚Äì From input to final status</h4>

            <div class="card" style="background: #FAFAFA; padding: 2rem; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                <h4 style="text-align: center; margin-bottom: 1.5rem; color: #333;">Stateless Per-Ticket Pipeline</h4>
                <div class="mermaid">
                    flowchart TD
                        A[Input: employee_id + ticket] --> B[Lookup employee profile]
                        B --> C[Intent & appropriateness classifier]
                        C -->|not_appropriate| O1[Outcome: blocked_by_appropriateness]
                        C -->|appropriate| D[Authorization rules engine]
                        D -->|blocked_by_auth| O2[Outcome: blocked_by_auth]
                        D -->|needs_approval| O3[Outcome: needs_approval]
                        D -->|allowed| E[RAG + LLM answering]
                        E -->|answerable from KB| O4[Outcome: solved_by_rag]
                        E -->|no good KB context| O5[Outcome: escalate]
                        
                        style A fill:#E3F2FD,stroke:#0078D4,stroke-width:3px
                        style B fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                        style C fill:#FFF9E6,stroke:#FF8C00,stroke-width:3px
                        style D fill:#FCE4EC,stroke:#E91E63,stroke-width:3px
                        style E fill:#E8F5E9,stroke:#4CAF50,stroke-width:3px
                        style O1 fill:#FFE5E5,stroke:#D13438,stroke-width:2px
                        style O2 fill:#FFE5E5,stroke:#D13438,stroke-width:2px
                        style O3 fill:#FFF9E6,stroke:#FFB74D,stroke-width:2px
                        style O4 fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                        style O5 fill:#E0E0E0,stroke:#9E9E9E,stroke-width:2px
                </div>
            </div>

            <!-- Step-by-step explanation -->
            <div style="margin-top: 2rem;">
                <div class="card" style="background: white; border-left: 5px solid #4CAF50; margin-bottom: 1rem;">
                    <h5 style="color: #4CAF50; margin: 0 0 0.5rem 0; font-size: 1rem;">
                        üìç Step 1 ‚Äì Identify the employee
                    </h5>
                    <p style="font-size: 0.95rem; margin: 0; line-height: 1.6; color: #555;">
                        Using the <code>employee_id</code>, the system looks up the employee's profile (role level, department, permissions profile).
                    </p>
                </div>

                <div class="card" style="background: white; border-left: 5px solid #FF8C00; margin-bottom: 1rem;">
                    <h5 style="color: #FF8C00; margin: 0 0 0.5rem 0; font-size: 1rem;">
                        üè∑Ô∏è Step 2 ‚Äì Classify the ticket
                    </h5>
                    <p style="font-size: 0.95rem; margin: 0 0 0.5rem 0; line-height: 1.6; color: #555;">
                        A small LLM/SLM-based classifier decides:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li>whether this ticket is <strong>appropriate</strong> for this IT support bot, and</li>
                        <li>which <strong>category</strong> it falls into (e.g., <code>hardware_issue</code>, <code>software_issue</code>, <code>network_issue</code>, <code>access_request</code>, etc.).</li>
                    </ul>
                </div>

                <div class="card" style="background: white; border-left: 5px solid #D13438; margin-bottom: 1rem;">
                    <h5 style="color: #D13438; margin: 0 0 0.5rem 0; font-size: 1rem;">
                        üö´ Step 3 ‚Äì Early guardrail: scope check
                    </h5>
                    <p style="font-size: 0.95rem; margin: 0; line-height: 1.6; color: #555;">
                        If the classifier says <code>not_appropriate</code>, the pipeline <strong>stops immediately</strong> with
                        <code>status = blocked_by_appropriateness</code> and a polite message like
                        <em>"I'm an internal IT support assistant; I can't answer this type of question."</em>
                    </p>
                </div>

                <div class="card" style="background: white; border-left: 5px solid #E91E63; margin-bottom: 1rem;">
                    <h5 style="color: #C2185B; margin: 0 0 0.5rem 0; font-size: 1rem;">
                        üîê Step 4 ‚Äì Authorization rules
                    </h5>
                    <p style="font-size: 0.95rem; margin: 0 0 0.5rem 0; line-height: 1.6; color: #555;">
                        For appropriate tickets, a <strong>pure rule engine</strong> (no LLM) uses:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0 0 0.5rem 0; padding-left: 1.5rem;">
                        <li>the employee's <code>role</code>, <code>department</code>, and</li>
                        <li>the ticket <code>category</code> (intent)</li>
                    </ul>
                    <p style="font-size: 0.95rem; margin: 0; line-height: 1.6; color: #555;">
                        to decide:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li><code>allowed</code> ‚Üí proceed</li>
                        <li><code>needs_approval</code> ‚Üí stop with <code>status = needs_approval</code></li>
                        <li><code>blocked_by_auth</code> ‚Üí stop with <code>status = blocked_by_auth</code></li>
                    </ul>
                </div>

                <div class="card" style="background: white; border-left: 5px solid #4CAF50; margin-bottom: 0;">
                    <h5 style="color: #2E7D32; margin: 0 0 0.5rem 0; font-size: 1rem;">
                        üìö Step 5 ‚Äì RAG-based answering
                    </h5>
                    <p style="font-size: 0.95rem; margin: 0 0 0.5rem 0; line-height: 1.6; color: #555;">
                        If the request is <strong>allowed</strong>, the system:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0 0 0.5rem 0; padding-left: 1.5rem;">
                        <li>retrieves relevant FAQ/policy snippets from the KB, and</li>
                        <li>calls an LLM to draft a grounded support answer.</li>
                    </ul>
                    <p style="font-size: 0.95rem; margin: 0; line-height: 1.6; color: #555;">
                        Depending on the context:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.7; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li>If the KB provides enough information ‚Üí <code>status = solved_by_rag</code>.</li>
                        <li>If the KB doesn't support a safe answer ‚Üí <code>status = escalate</code>.</li>
                    </ul>
                </div>
            </div>

            <div class="callout-info" style="margin-top: 1.5rem;">
                <p style="margin: 0; font-size: 0.95rem;">
                    At the end of this flow, each ticket lands in <strong>exactly one</strong> of the final statuses you saw in A.1.2.
                </p>
            </div>

            <!-- A.3.2 Stateless vs Session State Note -->
            <h4 style="color: #0078D4; font-size: 1.2rem; margin-top: 3rem;">A.3.2 ‚Äì Stateless pipeline vs optional session state</h4>

            <div class="card" style="background: linear-gradient(135deg, #F3F9FF 0%, #E3F2FD 100%); border-left: 5px solid #0078D4; box-shadow: 0 4px 12px rgba(0,120,212,0.1);">
                <h5 style="color: #0078D4; margin-top: 0; font-size: 1.1rem;">The core pipeline is stateless</h5>
                
                <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.7; color: #333;">
                    The <strong>core pipeline</strong> above is intentionally designed to be <strong>stateless</strong>:
                </p>

                <ul style="font-size: 0.95rem; line-height: 1.8; color: #555; margin-bottom: 1.25rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;">It does not remember previous tickets or chat history.</li>
                    <li style="margin-bottom: 0.4rem;">It always takes everything it needs as <strong>explicit input</strong>: who the user is (<code>employee_id</code>), what the ticket says (<code>subject</code>, <code>body</code>).</li>
                    <li style="margin-bottom: 0;">For every call, it recomputes classification, rules, and RAG from scratch.</li>
                </ul>

                <p style="font-size: 0.95rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                    This makes the logic:
                </p>

                <ul style="font-size: 0.95rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;">easier to test (each row in the sample tickets file is one independent run),</li>
                    <li style="margin-bottom: 0.4rem;">easier to debug (no hidden state),</li>
                    <li style="margin-bottom: 0;">and easier to reason about in terms of <strong>final statuses</strong>.</li>
                </ul>
            </div>

            <!-- UI vs Pipeline diagram -->
            <div class="card" style="background: #FAFAFA; padding: 2rem; margin-top: 1.5rem;">
                <h5 style="text-align: center; margin-bottom: 1rem; color: #333;">UI Session Wrapper (Optional) vs Stateless Pipeline (Core)</h5>
                <div class="mermaid">
                    flowchart LR
                        subgraph UI[Optional UI / Chat Wrapper]
                            U1[Ask once: employee_id] --> U2[Loop: ask for ticket]
                            U2 -.->|for each ticket| U2
                        end

                        subgraph Core[Stateless ticket pipeline]
                            P[process_ticket employee_id, ticket]
                        end

                        U2 -->|employee_id + ticket| P
                        
                        style UI fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                        style Core fill:#E3F2FD,stroke:#0078D4,stroke-width:3px
                </div>
            </div>

            <!-- Clarifying paragraph -->
            <div class="card" style="background: white; border-left: 5px solid #FF8C00; margin-top: 1.5rem;">
                <h5 style="color: #FF8C00; margin-top: 0; font-size: 1rem;">üí¨ Optional: Chat-like UI wrapper</h5>
                
                <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.7; color: #333;">
                    If you want a more "chat-like" experience, you <strong>can</strong> build a small UI wrapper that:
                </p>

                <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1.25rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;">asks for <code>employee_id</code> once at the start of a session, and</li>
                    <li style="margin-bottom: 0;">then sends multiple tickets to the same pipeline function.</li>
                </ul>

                <p style="font-size: 0.95rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                    But for the purpose of this hackathon and for the provided sample data:
                </p>

                <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;">we assume a <strong>per-ticket, stateless interface</strong>:
                        <div style="background: #1E1E1E; color: #E0E0E0; padding: 0.75rem; border-radius: 6px; margin-top: 0.5rem; font-family: 'Courier New', monospace; font-size: 0.9rem; border: 1px solid #3A3A3A;">
                            <code style="color: #E0E0E0;">(employee_id, ticket) ‚Üí status + message/answer</code>
                        </div>
                    </li>
                    <li style="margin-bottom: 0;">This is the interface we'll refer to in Part B when we talk about "the pipeline" or <code>process_ticket</code>.</li>
                </ul>
            </div>

        </section>

        <!-- A.4 Worked Example (End-to-End Ticket) -->
        <section id="part-a-example">
            <h3 style="color: #0078D4; font-size: 1.5rem; margin-top: 3rem;">üí° A.4 ‚Äì Worked Example (End-to-End Ticket)</h3>

            <!-- A.4.1 Scenario -->
            <h4 style="color: #00B7C3; font-size: 1.2rem; margin-top: 2rem;">A.4.1 ‚Äì Scenario: VPN issue from a standard engineer</h4>

            <div class="card" style="background: linear-gradient(135deg, #F0F8FF 0%, #E6F7FF 100%); border-left: 5px solid #00B7C3;">
                <p style="font-size: 0.95rem; margin-bottom: 1.5rem; line-height: 1.7; color: #333;">
                    To make the flow concrete, let's walk <strong>one ticket</strong> all the way through the pipeline.<br/>
                    We'll use placeholder values here ‚Äì once your sample data is ready, you can replace them with real rows from <code>employees</code> and <code>tickets_sample</code>.
                </p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1.5rem;">
                    <!-- Employee data -->
                    <div style="background: white; padding: 1.5rem; border-radius: 6px; border-left: 4px solid #0078D4;">
                        <h5 style="color: #0078D4; margin-top: 0; font-size: 1rem;">üë§ Example employee (from <code>users_roles.csv</code>)</h5>
                        <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                            <li style="margin-bottom: 0.4rem;"><code>employee_id</code>: <strong>E002</strong></li>
                            <li style="margin-bottom: 0.4rem;"><code>role</code>: <strong>junior_engineer</strong></li>
                            <li style="margin-bottom: 0.4rem;"><code>department</code>: <strong>engineering</strong></li>
                            <li style="margin-bottom: 0;"><code>seniority</code>: <strong>junior</strong></li>
                        </ul>
                    </div>

                    <!-- Ticket data -->
                    <div style="background: white; padding: 1.5rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                        <h5 style="color: #FF8C00; margin-top: 0; font-size: 1rem;">üé´ Example ticket (from <code>support_tickets_labeled_full.csv</code>)</h5>
                        <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                            <li style="margin-bottom: 0.4rem;"><code>ticket_id</code>: <strong>T017</strong></li>
                            <li style="margin-bottom: 0.4rem;"><code>employee_id</code>: <strong>E002</strong> <span style="color: #888;">(same as above)</span></li>
                            <li style="margin-bottom: 0.4rem;"><code>subject</code>: <strong>"General Query"</strong></li>
                            <li style="margin-bottom: 0.4rem;"><code>body</code>: <strong>"My Lenovo ThinkPad laptop's N key is physically stuck and will not press down fully."</strong></li>
                            <li style="margin-bottom: 0;"><code>expected_category</code>: <strong>hardware_issue</strong></li>
                        </ul>
                    </div>
                </div>

                <div class="card" style="background: #FFF9E6; border-left: 4px solid #4CAF50; margin-top: 1.5rem; padding: 1rem;">
                    <p style="font-size: 0.9rem; margin: 0; color: #333;">
                        üíö The <code>expected_pipeline_result</code> for this ticket in your CSV will likely be: <strong style="color: #4CAF50;">solved_by_rag</strong>
                    </p>
                </div>
            </div>

            <!-- A.4.2 Step-by-step through the pipeline -->
            <h4 style="color: #00B7C3; font-size: 1.2rem; margin-top: 3rem;">A.4.2 ‚Äì Step-by-step through the pipeline</h4>

            <div class="card" style="background: white; padding: 2rem;">
                <!-- Step 1 -->
                <div style="border-left: 5px solid #0078D4; padding: 1.5rem; background: #F3F9FF; margin-bottom: 1.5rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,120,212,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #0078D4 0%, #0063B1 100%); color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(0,120,212,0.3);">1</div>
                        <h5 style="color: #0078D4; margin: 0; font-size: 1.05rem;">Input arrives</h5>
                    </div>
                    <p style="font-size: 0.9rem; margin: 0.5rem 0; line-height: 1.7; color: #333;">
                        Call to your pipeline with:
                    </p>
                    <div style="background: #1E1E1E; color: #E0E0E0; padding: 0.75rem; border-radius: 6px; margin-top: 0.5rem; font-family: 'Courier New', monospace; font-size: 0.85rem; border: 1px solid #3A3A3A;">
                        <code style="color: #E0E0E0;">employee_id = E002</code><br/>
                        <code style="color: #E0E0E0;">ticket (subject + body)</code>
                    </div>
                </div>

                <!-- Step 2 -->
                <div style="border-left: 5px solid #4CAF50; padding: 1.5rem; background: #F1F8F4; margin-bottom: 1.5rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(76,175,80,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(76,175,80,0.3);">2</div>
                        <h5 style="color: #4CAF50; margin: 0; font-size: 1.05rem;">Employee lookup</h5>
                    </div>
                    <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Pipeline looks up <code>E002</code> in the employees data.</li>
                        <li style="margin-bottom: 0.4rem;">It finds the row above and learns:
                            <ul style="margin-top: 0.3rem;">
                                <li>role: <strong>junior_engineer</strong></li>
                                <li>department: <strong>engineering</strong></li>
                                <li>seniority: <strong>junior</strong></li>
                            </ul>
                        </li>
                        <li style="margin-bottom: 0;">This information will be used later by the authorization rules.</li>
                    </ul>
                </div>

                <!-- Step 3 -->
                <div style="border-left: 5px solid #FF8C00; padding: 1.5rem; background: #FFF9F0; margin-bottom: 1.5rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(255,140,0,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #FF8C00 0%, #FF7700 100%); color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(255,140,0,0.3);">3</div>
                        <h5 style="color: #FF8C00; margin: 0; font-size: 1.05rem;">Intent & appropriateness classification</h5>
                    </div>
                    <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Classifier sees VPN / connectivity language and decides:
                            <ul style="margin-top: 0.3rem;">
                                <li><code>appropriateness = "appropriate"</code><br/>
                                    <span style="color: #888; font-size: 0.85rem;">(this is clearly an IT support request)</span>
                                </li>
                                <li><code>category = hardware_issue</code><br/>
                                    <span style="color: #888; font-size: 0.85rem;">(from analyzing the ticket body about the stuck keyboard key)</span>
                                </li>
                            </ul>
                        </li>
                        <li style="margin-bottom: 0;">If your sample CSV has <code>expected_category</code> for this ticket, it should match (or be reasonably close).</li>
                    </ul>
                </div>

                <!-- Step 4 -->
                <div style="border-left: 5px solid #D13438; padding: 1.5rem; background: #FFF5F5; margin-bottom: 1.5rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(209,52,56,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #D13438 0%, #B71C1C 100%); color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(209,52,56,0.3);">4</div>
                        <h5 style="color: #D13438; margin: 0; font-size: 1.05rem;">Scope guardrail</h5>
                    </div>
                    <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Because <code>appropriateness = "appropriate"</code>, the ticket passes the early <strong>scope check</strong>.</li>
                        <li style="margin-bottom: 0;">If the classifier had said <code>not_appropriate</code>, we would have stopped here with <code>status = blocked_by_appropriateness</code>.</li>
                    </ul>
                </div>

                <!-- Step 5 -->
                <div style="border-left: 5px solid #E91E63; padding: 1.5rem; background: #FFF0F6; margin-bottom: 1.5rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(233,30,99,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #E91E63 0%, #D81B60 100%); color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(233,30,99,0.3);">5</div>
                        <h5 style="color: #E91E63; margin: 0; font-size: 1.05rem;">Authorization decision</h5>
                    </div>
                    <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        The rule engine takes:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;"><code>intent = hardware_issue</code></li>
                        <li style="margin-bottom: 0.4rem;"><code>role = junior_engineer</code></li>
                        <li style="margin-bottom: 0;"><code>department = engineering</code></li>
                    </ul>
                    <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        It looks up these values in auth_rules.csv and finds rule R1:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0;"><code>hardware_issue,*,*,allowed</code> - All employees can raise hardware issues.</li>
                    </ul>
                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem; line-height: 1.7; color: #333;">
                        So it returns something like:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;"><code>auth_status = "allowed"</code></li>
                        <li style="margin-bottom: 0;"><code>reason = "Standard support users are allowed to raise VPN issues."</code></li>
                    </ul>
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                        üí° If, instead, the ticket had been an <code>access_request</code> from a junior engineer, this step might have produced <code>needs_approval</code> or <code>blocked_by_auth</code>.
                    </p>
                </div>

                <!-- Step 6 -->
                <div style="border-left: 5px solid #00B7C3; padding: 1.5rem; background: #F0FAFB; margin-bottom: 1.5rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,183,195,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #00B7C3 0%, #00A0AC 100%); color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(0,183,195,0.3);">6</div>
                        <h5 style="color: #00B7C3; margin: 0; font-size: 1.05rem;">RAG retrieval & answer generation</h5>
                    </div>
                    <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        Because <code>auth_status = "allowed"</code>, the pipeline proceeds to RAG:
                    </p>
                    <ol style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Combines ticket subject + body into a query.</li>
                        <li style="margin-bottom: 0.4rem;">Uses the retriever to fetch the most relevant KB chunks, e.g.:
                            <ul style="margin-top: 0.3rem;">
                                <li>from <code>faq_network_issues.md</code></li>
                                <li>maybe from <code>policy_support_scope.md</code> if relevant.</li>
                            </ul>
                        </li>
                        <li style="margin-bottom: 0.4rem;">Builds a support prompt that includes:
                            <ul style="margin-top: 0.3rem;">
                                <li>a system message ("You are an internal IT support assistant‚Ä¶"),</li>
                                <li>the retrieved KB snippets as <strong>context</strong>,</li>
                                <li>the ticket details (and optionally employee info).</li>
                            </ul>
                        </li>
                        <li style="margin-bottom: 0;">Calls the LLM to draft a clear, grounded response.</li>
                    </ol>
                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem; line-height: 1.7; color: #333;">
                        The LLM produces an answer like (placeholder):
                    </p>
                    <div style="background: #1E1E1E; color: #E0E0E0; padding: 1rem; border-radius: 6px; margin-top: 0.5rem; font-family: 'Segoe UI', sans-serif; font-size: 0.85rem; border: 1px solid #3A3A3A; line-height: 1.7;">
                        <strong style="color: #4EC9B0;">"For a stuck keyboard key, try the following: 1) Turn off the laptop and gently clean around the key with compressed air. 2) If still stuck, contact IT support for a keyboard replacement. For ThinkPad models, we can order a new keyboard within 2 business days."</strong><br/><br/>
                        <span style="color: #888; font-style: italic;">e.g. "Please try these steps in order: 1) Check your home network stability‚Ä¶ 2) Reinstall the VPN client‚Ä¶ If the issue persists, raise a ticket with the network team."</span>
                    </div>
                </div>

                <!-- Step 7 -->
                <div style="border-left: 5px solid #4CAF50; padding: 1.5rem; background: #F1F8F4; border-radius: 8px; box-shadow: 0 2px 6px rgba(76,175,80,0.12);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; flex-shrink: 0; box-shadow: 0 2px 4px rgba(76,175,80,0.3);">7</div>
                        <h5 style="color: #4CAF50; margin: 0; font-size: 1.05rem;">Final status & output</h5>
                    </div>
                    <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        Because the KB contained relevant guidance and the LLM produced a reasonable answer, the pipeline returns:
                    </p>
                    <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;"><code>status = "solved_by_rag"</code> <span style="color: #4CAF50; font-weight: bold;">‚úì</span></li>
                        <li style="margin-bottom: 0.4rem;"><code>answer = "For a stuck keyboard key, try..."</code></li>
                        <li style="margin-bottom: 0.4rem;"><code>debug.intent = {appropriateness, category}</code></li>
                        <li style="margin-bottom: 0;"><code>debug.auth = {auth_status, reason}</code></li>
                    </ul>
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                        üí° This should match the <code>expected_pipeline_result</code> of this ticket in your sample CSV (once you fill it in).
                    </p>
                </div>
            </div>

            <!-- A.4.3 State Transition Diagram -->
            <h4 style="color: #00B7C3; font-size: 1.2rem; margin-top: 3rem;">A.4.3 ‚Äì State Transition & Decision Flow</h4>

            <div class="card" style="background: #FAFAFA; padding: 2rem; margin-bottom: 2rem;">
                <h5 style="text-align: center; margin-bottom: 1.5rem; color: #333; font-size: 1.1rem;">Per-Ticket State Machine: From Input to Final Status</h5>
                <div class="mermaid">
                    stateDiagram-v2
                        [*] --> Input: Ticket arrives
                        Input --> EmployeeLookup: employee_id + ticket
                        
                        EmployeeLookup --> Classification: Load profile
                        
                        Classification --> ScopeCheck: appropriateness + category
                        
                        ScopeCheck --> Blocked1: not_appropriate
                        ScopeCheck --> Authorization: appropriate
                        
                        Authorization --> Blocked2: blocked_by_auth
                        Authorization --> NeedsApproval: needs_approval
                        Authorization --> RAG: allowed
                        
                        RAG --> KBNotFound: No relevant KB
                        RAG --> Solved: KB found + LLM answer
                        
                        Blocked1 --> [*]: blocked_by_appropriateness
                        Blocked2 --> [*]: blocked_by_authorization
                        NeedsApproval --> [*]: needs_approval_before_rag
                        KBNotFound --> [*]: escalate_to_human
                        Solved --> [*]: solved_by_rag
                        
                        note right of Input
                            Stateless entry point:
                            each ticket is independent
                        end note
                        
                        note right of ScopeCheck
                            First guardrail:
                            Is this an IT support request?
                        end note
                        
                        note right of Authorization
                            Second guardrail:
                            Does this employee have permission?
                        end note
                        
                        note right of RAG
                            Final step:
                            Generate grounded answer
                        end note
                </div>
            </div>

            <!-- Pipeline architecture diagram -->
            <div class="card" style="background: white; padding: 2rem; margin-bottom: 2rem;">
                <h5 style="text-align: center; margin-bottom: 1.5rem; color: #333; font-size: 1.1rem;">Stateless Pipeline Architecture</h5>
                <div class="mermaid">
                    flowchart TB
                        subgraph Input["üì• INPUT (Stateless)"]
                            I1[employee_id]
                            I2[ticket: subject, body]
                        end
                        
                        subgraph DataLookup["üíæ DATA LOOKUP"]
                            D1[Employees DB]
                            D2[Authorization Rules]
                            D3[Knowledge Base]
                        end
                        
                        subgraph Pipeline["üîÑ PROCESSING PIPELINE"]
                            P1[1. Employee Lookup]
                            P2[2. LLM Classifier]
                            P3[3. Scope Check]
                            P4[4. Authorization Engine]
                            P5[5. RAG Retriever]
                            P6[6. LLM Answer Generator]
                            
                            P1 --> P2
                            P2 --> P3
                            P3 --> P4
                            P4 --> P5
                            P5 --> P6
                        end
                        
                        subgraph Output["üì§ OUTPUT"]
                            O1[status]
                            O2[message/answer]
                            O3[debug info]
                        end
                        
                        Input --> P1
                        D1 -.->|lookup| P1
                        D2 -.->|rules| P4
                        D3 -.->|retrieve| P5
                        P6 --> Output
                        
                        P3 -.->|blocked_by_appropriateness| Output
                        P4 -.->|blocked_by_authorization| Output
                        P4 -.->|needs_approval| Output
                        P5 -.->|escalate_to_human| Output
                        
                        style Input fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                        style DataLookup fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                        style Pipeline fill:#F1F8F4,stroke:#4CAF50,stroke-width:2px
                        style Output fill:#F3E5F5,stroke:#E91E63,stroke-width:2px
                        
                        style P3 fill:#FFEBEE,stroke:#D13438,stroke-width:2px
                        style P4 fill:#FFF3E0,stroke:#FF8C00,stroke-width:2px
                </div>
            </div>

            <!-- A.4.4 Why this example matters -->
            <h4 style="color: #00B7C3; font-size: 1.2rem; margin-top: 3rem;">A.4.4 ‚Äì Why this example matters</h4>

            <div class="card" style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); border-left: 5px solid #FF8C00;">
                <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.7; color: #333;">
                    This single ticket shows all of Part A in action:
                </p>
                <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1.5rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;"><strong>Use case:</strong> a real IT-like VPN problem.</li>
                    <li style="margin-bottom: 0.4rem;"><strong>Data:</strong> employee info, ticket fields, rules, and KB docs.</li>
                    <li style="margin-bottom: 0.4rem;"><strong>Flow:</strong> <code>employee_id + ticket</code> ‚Üí classifier ‚Üí rules ‚Üí RAG ‚Üí <code>solved_by_rag</code>.</li>
                    <li style="margin-bottom: 0.4rem;"><strong>State machine:</strong> Each ticket moves through decision points to reach one of 5 final statuses.</li>
                    <li style="margin-bottom: 0;"><strong>Outcome:</strong> one of the defined statuses in A.1.2, aligned with the sample data.</li>
                </ul>

                <div style="background: white; padding: 1.25rem; border-radius: 6px; border-left: 4px solid #0078D4;">
                    <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        When you implement your solution in Part B, you can always come back to this example and ask:
                    </p>
                    <ul style="font-size: 0.85rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">"What would my classifier return here?"</li>
                        <li style="margin-bottom: 0.4rem;">"What does my rules config say for this profile + category?"</li>
                        <li style="margin-bottom: 0.4rem;">"What chunks would my retriever fetch from the KB?"</li>
                        <li style="margin-bottom: 0.4rem;">"At which state would my pipeline exit for this ticket?"</li>
                        <li style="margin-bottom: 0;">"Does my final <code>status</code> match what I intended for this ticket?"</li>
                    </ul>
                </div>
            </div>

        </section>

        <!-- Part B - Build the Guard-Railed Copilot -->
        <section id="part-b-overview">
            <h2 style="color: #4CAF50; font-size: 2rem; margin-top: 4rem; border-bottom: 3px solid #4CAF50;">üõ†Ô∏è PART B ‚Äì Build the Guard-Railed Copilot</h2>

            <!-- Chips -->
            <div style="display: flex; gap: 1rem; margin: 1.5rem 0;">
                <span class="chip" style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; box-shadow: 0 2px 6px rgba(76,175,80,0.3);">DEV ROADMAP</span>
                <span class="chip" style="background: linear-gradient(135deg, #FF8C00 0%, #FF7700 100%); color: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; box-shadow: 0 2px 6px rgba(255,140,0,0.3);">LANGCHAIN HINTS</span>
                <span class="chip" style="background: linear-gradient(135deg, #0078D4 0%, #0063B1 100%); color: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; box-shadow: 0 2px 6px rgba(0,120,212,0.3);">NO FIXED REPO STRUCTURE</span>
            </div>

            <!-- Intro text -->
            <div style="background: linear-gradient(135deg, #F1F8F4 0%, #E8F5E9 100%); padding: 2rem; border-radius: 8px; border-left: 5px solid #4CAF50; margin-bottom: 2rem;">
                <p style="font-size: 1.05rem; margin-bottom: 2rem; line-height: 1.7; color: #333; text-align: center; font-weight: 500;">
                    In Part B, we shift from <strong style="color: #4CAF50;">"what should this system do?"</strong> to <strong style="color: #FF8C00;">"how can I actually build it?"</strong>
                </p>
                
                <p style="font-size: 0.95rem; margin-bottom: 1.5rem; line-height: 1.7; color: #333; text-align: center;">
                    This part is a <strong>development roadmap</strong>, not a rigid template.
                </p>
                
                <!-- Flexible vs Fixed comparison -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 2rem;">
                    <!-- FLEXIBLE section -->
                    <div style="background: white; padding: 1.75rem; border-radius: 8px; border: 2px solid #4CAF50; box-shadow: 0 4px 8px rgba(76,175,80,0.15);">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                            <div style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; flex-shrink: 0; box-shadow: 0 3px 6px rgba(76,175,80,0.3);">‚ú®</div>
                            <h4 style="margin: 0; color: #4CAF50; font-size: 1.1rem;">You Are Free To</h4>
                        </div>
                        <div style="display: grid; gap: 0.75rem; margin-top: 1rem;">
                            <div style="display: flex; align-items: start; gap: 0.5rem;">
                                <span style="color: #4CAF50; font-size: 1.1rem; margin-top: 0.1rem;">‚úì</span>
                                <span style="font-size: 0.9rem; color: #555; line-height: 1.6;">Organize code in <strong>files or notebooks</strong> however you like</span>
                            </div>
                            <div style="display: flex; align-items: start; gap: 0.5rem;">
                                <span style="color: #4CAF50; font-size: 1.1rem; margin-top: 0.1rem;">‚úì</span>
                                <span style="font-size: 0.9rem; color: #555; line-height: 1.6;">Use any <strong>frameworks or helpers</strong> you prefer</span>
                            </div>
                            <div style="display: flex; align-items: start; gap: 0.5rem;">
                                <span style="color: #4CAF50; font-size: 1.1rem; margin-top: 0.1rem;">‚úì</span>
                                <span style="font-size: 0.9rem; color: #555; line-height: 1.6;">Add your own <strong>logging, UI, or extras</strong> if time permits</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- FIXED section -->
                    <div style="background: white; padding: 1.75rem; border-radius: 8px; border: 2px solid #FF8C00; box-shadow: 0 4px 8px rgba(255,140,0,0.15);">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                            <div style="background: linear-gradient(135deg, #FF8C00 0%, #FF7700 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; flex-shrink: 0; box-shadow: 0 3px 6px rgba(255,140,0,0.3);">üéØ</div>
                            <h4 style="margin: 0; color: #FF8C00; font-size: 1.1rem;">What Is Fixed</h4>
                        </div>
                        <div style="display: grid; gap: 0.75rem; margin-top: 1rem;">
                            <div style="display: flex; align-items: start; gap: 0.5rem;">
                                <span style="color: #FF8C00; font-size: 1.1rem; margin-top: 0.1rem;">‚Üí</span>
                                <span style="font-size: 0.9rem; color: #555; line-height: 1.6;">Each call receives an <strong>employee_id + ticket</strong></span>
                            </div>
                            <div style="display: flex; align-items: start; gap: 0.5rem;">
                                <span style="color: #FF8C00; font-size: 1.1rem; margin-top: 0.1rem;">‚Üí</span>
                                <span style="font-size: 0.9rem; color: #555; line-height: 1.6;">Must run through <strong>classification ‚Üí authorization ‚Üí RAG</strong></span>
                            </div>
                            <div style="display: flex; align-items: start; gap: 0.5rem;">
                                <span style="color: #FF8C00; font-size: 1.1rem; margin-top: 0.1rem;">‚Üí</span>
                                <span style="font-size: 0.9rem; color: #555; line-height: 1.6;">Must produce <strong>one of the 5 final statuses</strong> from Part A</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Core interface card -->
            <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); padding: 2.5rem; border-radius: 8px; border: 2px solid #0078D4; margin-top: 2rem; box-shadow: 0 6px 16px rgba(0,120,212,0.2);">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; justify-content: center;">
                    <div style="background: linear-gradient(135deg, #0078D4 0%, #0063B1 100%); color: white; width: 56px; height: 56px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; flex-shrink: 0; box-shadow: 0 4px 8px rgba(0,120,212,0.4);">üí°</div>
                    <h4 style="color: #0078D4; margin: 0; font-size: 1.3rem; text-align: center;">Core Requirement ‚Äì Think in Terms of a Pure Function</h4>
                </div>
                <p style="font-size: 1rem; margin-bottom: 1.5rem; line-height: 1.7; color: #333; text-align: center;">
                    At the heart of your solution, there should be a function or chain that behaves like:
                </p>
                <div style="background: #1E1E1E; color: #E0E0E0; padding: 1.75rem; border-radius: 8px; margin: 1.5rem 0; font-family: 'Courier New', monospace; font-size: 1.05rem; border: 2px solid #0078D4; box-shadow: 0 4px 12px rgba(0,0,0,0.3); text-align: center;">
                    <code style="color: #4EC9B0; font-weight: 600;">(employee_id, ticket)</code> <code style="color: #D4D4D4; font-weight: 700; font-size: 1.2rem;">‚Üí</code> <code style="color: #DCDCAA; font-weight: 600;">{ status, message_or_answer, debug_info }</code>
                </div>
                <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.7; color: #333; font-weight: 600;">where:</p>
                <ul style="font-size: 0.9rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0.4rem;"><code>ticket</code> includes a <code>subject</code> and <code>body</code>,</li>
                    <li style="margin-bottom: 0.4rem;"><code>status</code> is one of:
                        <ul style="margin-top: 0.3rem; font-size: 0.85rem;">
                            <li><code>blocked_by_appropriateness</code></li>
                            <li><code>blocked_by_auth</code></li>
                            <li><code>needs_approval</code></li>
                            <li><code>solved_by_rag</code></li>
                            <li><code>escalate</code></li>
                        </ul>
                    </li>
                </ul>
                <div class="card" style="background: white; padding: 1rem; border-left: 3px solid #FF8C00; margin-top: 1rem;">
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #555;">
                        <strong style="color: #FF8C00;">üìå Note:</strong> Everything else ‚Äî how you name functions, how you structure modules, whether you build a CLI or a tiny UI ‚Äî is up to you. The dev stages below are just a <strong>guide</strong> to help you reach this core behavior step by step.
                    </p>
                </div>
            </div>

            <!-- What Part B contains -->
            <div style="background: white; margin-top: 2rem; padding: 2.5rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                <h4 style="color: #4CAF50; margin-top: 0; font-size: 1.3rem; text-align: center; margin-bottom: 2rem;">üìã What Part B Contains</h4>
                
                <div style="display: grid; grid-template-columns: 1fr; gap: 2rem; margin-top: 1.5rem;">
                    <!-- B.1 -->
                    <div style="background: linear-gradient(135deg, #F1F8F4 0%, #E8F5E9 100%); padding: 2rem; border-radius: 8px; border: 2px solid #4CAF50; position: relative; box-shadow: 0 4px 8px rgba(76,175,80,0.15);">
                        <div style="display: flex; align-items: start; gap: 1.5rem;">
                            <div style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; width: 56px; height: 56px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.5rem; flex-shrink: 0; box-shadow: 0 4px 8px rgba(76,175,80,0.3);">1</div>
                            <div style="flex: 1;">
                                <h5 style="color: #4CAF50; margin-top: 0; margin-bottom: 0.75rem; font-size: 1.15rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üöÄ</span> B.1 ‚Äì Recommended Development Stages
                                </h5>
                                <p style="font-size: 0.95rem; margin: 0; line-height: 1.7; color: #333;">
                                    A structured sequence of <strong>7 stages</strong> from "understand & plan" to "test against sample tickets", so you always know <strong>what to focus on next</strong>.
                                </p>
                                <div style="margin-top: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                    <span style="background: white; color: #4CAF50; padding: 0.3rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; border: 1px solid #4CAF50;">Stage-by-stage guide</span>
                                    <span style="background: white; color: #4CAF50; padding: 0.3rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; border: 1px solid #4CAF50;">Clear milestones</span>
                                    <span style="background: white; color: #4CAF50; padding: 0.3rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; border: 1px solid #4CAF50;">Visual roadmap</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- B.2 -->
                    <div style="background: linear-gradient(135deg, #FFF9F0 0%, #FFEFD5 100%); padding: 2rem; border-radius: 8px; border: 2px solid #FF8C00; position: relative; box-shadow: 0 4px 8px rgba(255,140,0,0.15);">
                        <div style="display: flex; align-items: start; gap: 1.5rem;">
                            <div style="background: linear-gradient(135deg, #FF8C00 0%, #FF7700 100%); color: white; width: 56px; height: 56px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.5rem; flex-shrink: 0; box-shadow: 0 4px 8px rgba(255,140,0,0.3);">2</div>
                            <div style="flex: 1;">
                                <h5 style="color: #FF8C00; margin-top: 0; margin-bottom: 0.75rem; font-size: 1.15rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üìã</span> B.2 ‚Äì Stage Details with LangChain Hints
                                </h5>
                                <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.7; color: #333;">
                                    For each of the 7 stages, you'll find:
                                </p>
                                <div style="display: grid; gap: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: #FF8C00; font-size: 1rem;">‚úì</span>
                                        <span style="font-size: 0.9rem; color: #555;"><strong>Objective, inputs, outputs</strong> ‚Äì what it does and needs</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: #FF8C00; font-size: 1rem;">‚úì</span>
                                        <span style="font-size: 0.9rem; color: #555;"><strong>Connection to Part A flows</strong> ‚Äì how it fits the big picture</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: #FF8C00; font-size: 1rem;">‚úì</span>
                                        <span style="font-size: 0.9rem; color: #555;"><strong>LangChain building blocks</strong> ‚Äì conceptual patterns (no full code)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- B.3 -->
                    <div style="background: linear-gradient(135deg, #F3F9FF 0%, #E3F2FD 100%); padding: 2rem; border-radius: 8px; border: 2px solid #0078D4; position: relative; box-shadow: 0 4px 8px rgba(0,120,212,0.15);">
                        <div style="display: flex; align-items: start; gap: 1.5rem;">
                            <div style="background: linear-gradient(135deg, #0078D4 0%, #0063B1 100%); color: white; width: 56px; height: 56px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.5rem; flex-shrink: 0; box-shadow: 0 4px 8px rgba(0,120,212,0.3);">3</div>
                            <div style="flex: 1;">
                                <h5 style="color: #0078D4; margin-top: 0; margin-bottom: 0.75rem; font-size: 1.15rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üí°</span> B.3 ‚Äì Extensions & Variations (Optional)
                                </h5>
                                <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.7; color: #333;">
                                    Ready to go beyond the core? Explore ideas for:
                                </p>
                                <div style="display: grid; gap: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: #0078D4; font-size: 1rem;">‚Üí</span>
                                        <span style="font-size: 0.9rem; color: #555;">Wrapping the stateless pipeline in a <strong>small UI or chat-like loop</strong></span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: #0078D4; font-size: 1rem;">‚Üí</span>
                                        <span style="font-size: 0.9rem; color: #555;">Making <strong>authorization rules richer</strong> and more dynamic</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: #0078D4; font-size: 1rem;">‚Üí</span>
                                        <span style="font-size: 0.9rem; color: #555;">Moving closer to the full <strong>"hyper-personalized support copilot"</strong> vision</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </section>

        <!-- B.1 Development Stages -->
        <section id="part-b-stages">
            <h3 style="color: #4CAF50; font-size: 1.5rem; margin-top: 3rem;">üöÄ B.1 ‚Äì Recommended Development Stages (High-Level Overview)</h3>

            <div class="card" style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); border-left: 5px solid #FF8C00; margin-bottom: 2rem;">
                <p style="font-size: 0.95rem; margin: 0; line-height: 1.7; color: #333;">
                    You don't have to follow these stages exactly, but if you ever feel stuck, this list tells you <strong>what to focus on next</strong>.
                </p>
            </div>

            <!-- 7 Stages Overview Visual -->
            <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); padding: 2.5rem; border-radius: 8px; margin-bottom: 3rem; border: 2px solid #0078D4; box-shadow: 0 6px 16px rgba(0,120,212,0.15);">
                <h4 style="text-align: center; color: #0078D4; font-size: 1.5rem; margin-bottom: 0.75rem; font-weight: 700;">7 Development Stages</h4>
                <p style="text-align: center; color: #555; font-size: 0.95rem; margin-bottom: 2.5rem; max-width: 700px; margin-left: auto; margin-right: auto;">Your roadmap from planning to production-ready pipeline</p>
                
                <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 1rem; max-width: 100%; position: relative;">
                    <!-- Stage 1 -->
                    <div style="background: white; border: 3px solid #0078D4; border-radius: 10px; padding: 1.25rem 0.75rem; text-align: center; box-shadow: 0 3px 8px rgba(0,120,212,0.15); transition: transform 0.2s; position: relative;">
                        <div style="background: linear-gradient(135deg, #0078D4 0%, #0063B1 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.3rem; margin: 0 auto 0.75rem auto; box-shadow: 0 3px 6px rgba(0,120,212,0.3);">1</div>
                        <div style="color: #0078D4; font-size: 1.2rem; margin-bottom: 0.5rem;">üìã</div>
                        <div style="color: #333; font-size: 0.8rem; line-height: 1.4; font-weight: 600; margin-bottom: 0.5rem;">Understand &<br/>Plan</div>
                        <div style="color: #666; font-size: 0.65rem; line-height: 1.3;">Review flows & data</div>
                    </div>
                    
                    <!-- Stage 2 -->
                    <div style="background: white; border: 3px solid #00B7C3; border-radius: 10px; padding: 1.25rem 0.75rem; text-align: center; box-shadow: 0 3px 8px rgba(0,183,195,0.15); transition: transform 0.2s; position: relative;">
                        <div style="background: linear-gradient(135deg, #00B7C3 0%, #00A5B0 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.3rem; margin: 0 auto 0.75rem auto; box-shadow: 0 3px 6px rgba(0,183,195,0.3);">2</div>
                        <div style="color: #00B7C3; font-size: 1.2rem; margin-bottom: 0.5rem;">üìö</div>
                        <div style="color: #333; font-size: 0.8rem; line-height: 1.4; font-weight: 600; margin-bottom: 0.5rem;">Build KB &<br/>Retrieval</div>
                        <div style="color: #666; font-size: 0.65rem; line-height: 1.3;">Embeddings + search</div>
                    </div>
                    
                    <!-- Stage 3 -->
                    <div style="background: white; border: 3px solid #FF8C00; border-radius: 10px; padding: 1.25rem 0.75rem; text-align: center; box-shadow: 0 3px 8px rgba(255,140,0,0.15); transition: transform 0.2s; position: relative;">
                        <div style="background: linear-gradient(135deg, #FF8C00 0%, #FF7700 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.3rem; margin: 0 auto 0.75rem auto; box-shadow: 0 3px 6px rgba(255,140,0,0.3);">3</div>
                        <div style="color: #FF8C00; font-size: 1.2rem; margin-bottom: 0.5rem;">üéØ</div>
                        <div style="color: #333; font-size: 0.8rem; line-height: 1.4; font-weight: 600; margin-bottom: 0.5rem;">Implement<br/>Classifier</div>
                        <div style="color: #666; font-size: 0.65rem; line-height: 1.3;">Intent + scope check</div>
                    </div>
                    
                    <!-- Stage 4 -->
                    <div style="background: white; border: 3px solid #E91E63; border-radius: 10px; padding: 1.25rem 0.75rem; text-align: center; box-shadow: 0 3px 8px rgba(233,30,99,0.15); transition: transform 0.2s; position: relative;">
                        <div style="background: linear-gradient(135deg, #E91E63 0%, #D81B60 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.3rem; margin: 0 auto 0.75rem auto; box-shadow: 0 3px 6px rgba(233,30,99,0.3);">4</div>
                        <div style="color: #E91E63; font-size: 1.2rem; margin-bottom: 0.5rem;">üîê</div>
                        <div style="color: #333; font-size: 0.8rem; line-height: 1.4; font-weight: 600; margin-bottom: 0.5rem;">Authorization<br/>Rules</div>
                        <div style="color: #666; font-size: 0.65rem; line-height: 1.3;">Permission engine</div>
                    </div>
                    
                    <!-- Stage 5 -->
                    <div style="background: white; border: 3px solid #4CAF50; border-radius: 10px; padding: 1.25rem 0.75rem; text-align: center; box-shadow: 0 3px 8px rgba(76,175,80,0.15); transition: transform 0.2s; position: relative;">
                        <div style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.3rem; margin: 0 auto 0.75rem auto; box-shadow: 0 3px 6px rgba(76,175,80,0.3);">5</div>
                        <div style="color: #4CAF50; font-size: 1.2rem; margin-bottom: 0.5rem;">üí¨</div>
                        <div style="color: #333; font-size: 0.8rem; line-height: 1.4; font-weight: 600; margin-bottom: 0.5rem;">RAG<br/>Answering</div>
                        <div style="color: #666; font-size: 0.65rem; line-height: 1.3;">Retrieve + generate</div>
                    </div>
                    
                    <!-- Stage 6 -->
                    <div style="background: white; border: 3px solid #9C27B0; border-radius: 10px; padding: 1.25rem 0.75rem; text-align: center; box-shadow: 0 3px 8px rgba(156,39,176,0.15); transition: transform 0.2s; position: relative;">
                        <div style="background: linear-gradient(135deg, #9C27B0 0%, #8E24AA 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.3rem; margin: 0 auto 0.75rem auto; box-shadow: 0 3px 6px rgba(156,39,176,0.3);">6</div>
                        <div style="color: #9C27B0; font-size: 1.2rem; margin-bottom: 0.5rem;">‚öôÔ∏è</div>
                        <div style="color: #333; font-size: 0.8rem; line-height: 1.4; font-weight: 600; margin-bottom: 0.5rem;">Orchestrate<br/>Pipeline</div>
                        <div style="color: #666; font-size: 0.65rem; line-height: 1.3;">Connect all stages</div>
                    </div>
                    
                    <!-- Stage 7 -->
                    <div style="background: white; border: 3px solid #FF5722; border-radius: 10px; padding: 1.25rem 0.75rem; text-align: center; box-shadow: 0 3px 8px rgba(255,87,34,0.15); transition: transform 0.2s; position: relative;">
                        <div style="background: linear-gradient(135deg, #FF5722 0%, #F4511E 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.3rem; margin: 0 auto 0.75rem auto; box-shadow: 0 3px 6px rgba(255,87,34,0.3);">7</div>
                        <div style="color: #FF5722; font-size: 1.2rem; margin-bottom: 0.5rem;">üß™</div>
                        <div style="color: #333; font-size: 0.8rem; line-height: 1.4; font-weight: 600; margin-bottom: 0.5rem;">Test &<br/>Iterate</div>
                        <div style="color: #666; font-size: 0.65rem; line-height: 1.3;">Run & debug tickets</div>
                    </div>
                </div>
                
                <!-- Flow indicator -->
                <div style="text-align: center; margin-top: 1.5rem; color: #0078D4; font-size: 0.85rem; font-weight: 600;">
                    ‚Üê Iterative process: you can revisit earlier stages as needed ‚Üí
                </div>
            </div>

            <!-- B.2 - What Each Stage Contains -->
            <div style="background: linear-gradient(135deg, #E0F7FA 0%, #B2EBF2 100%); padding: 2.5rem; border-radius: 8px; margin-bottom: 3rem; border-left: 5px solid #00B7C3;">
                <h4 style="color: #00B7C3; margin-top: 0; font-size: 1.3rem; text-align: center; margin-bottom: 1.5rem;">üìã B.2 ‚Äì What Each Stage Contains</h4>
                <p style="font-size: 1rem; margin-bottom: 2rem; line-height: 1.7; color: #333; text-align: center; max-width: 800px; margin-left: auto; margin-right: auto;">
                    Each of the 7 stages below is detailed with <strong>six comprehensive elements</strong> to guide your implementation:
                </p>
                
                <!-- Visual grid of 6 elements -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.25rem; margin-top: 2rem;">
                    <!-- Objective -->
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #0078D4; box-shadow: 0 2px 6px rgba(0,0,0,0.08); transition: transform 0.2s;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <div style="background: linear-gradient(135deg, #0078D4 0%, #0063B1 100%); color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0;">üéØ</div>
                            <h5 style="margin: 0; color: #0078D4; font-size: 1rem; font-weight: 600;">Objective</h5>
                        </div>
                        <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">What this stage achieves and why it matters in the pipeline</p>
                    </div>
                    
                    <!-- Key Inputs -->
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #00B7C3; box-shadow: 0 2px 6px rgba(0,0,0,0.08); transition: transform 0.2s;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <div style="background: linear-gradient(135deg, #00B7C3 0%, #00A5B0 100%); color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0;">üì•</div>
                            <h5 style="margin: 0; color: #00B7C3; font-size: 1rem; font-weight: 600;">Key Inputs</h5>
                        </div>
                        <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">What data and context you need to implement this stage</p>
                    </div>
                    
                    <!-- Key Outputs -->
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #FF8C00; box-shadow: 0 2px 6px rgba(0,0,0,0.08); transition: transform 0.2s;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <div style="background: linear-gradient(135deg, #FF8C00 0%, #FF7700 100%); color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0;">üì§</div>
                            <h5 style="margin: 0; color: #FF8C00; font-size: 1rem; font-weight: 600;">Key Outputs</h5>
                        </div>
                        <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">What this stage produces for the next step in the pipeline</p>
                    </div>
                    
                    <!-- What to Do -->
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #4CAF50; box-shadow: 0 2px 6px rgba(0,0,0,0.08); transition: transform 0.2s;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <div style="background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%); color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0;">‚úÖ</div>
                            <h5 style="margin: 0; color: #4CAF50; font-size: 1rem; font-weight: 600;">What to Do</h5>
                        </div>
                        <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">Step-by-step tasks and recommended implementation flow</p>
                    </div>
                    
                    <!-- Visual Flowcharts -->
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #E91E63; box-shadow: 0 2px 6px rgba(0,0,0,0.08); transition: transform 0.2s;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <div style="background: linear-gradient(135deg, #E91E63 0%, #D81B60 100%); color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0;">üìä</div>
                            <h5 style="margin: 0; color: #E91E63; font-size: 1rem; font-weight: 600;">Visual Flowcharts</h5>
                        </div>
                        <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">Mermaid diagrams illustrating the stage's decision logic</p>
                    </div>
                    
                    <!-- LangChain Hints -->
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #9C27B0; box-shadow: 0 2px 6px rgba(0,0,0,0.08); transition: transform 0.2s;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <div style="background: linear-gradient(135deg, #9C27B0 0%, #8E24AA 100%); color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0;">üí°</div>
                            <h5 style="margin: 0; color: #9C27B0; font-size: 1rem; font-weight: 600;">LangChain Hints</h5>
                        </div>
                        <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">Conceptual guidance on which LangChain patterns to consider</p>
                    </div>
                </div>
            </div>

            <!-- Stage 1 - Detailed -->
            <div class="card" style="background: white; border-left: 5px solid #0078D4; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #0078D4; margin-top: 0; font-size: 1.2rem;">üìã Stage 1 ‚Äì Understand & Plan (Problem, Data, Layout)</h4>
                
                <!-- Objective -->
                <div style="background: #F3F9FF; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="color: #0078D4; margin-top: 0; font-size: 1rem;">üéØ Objective</h5>
                    <p style="font-size: 0.9rem; margin: 0; line-height: 1.7; color: #333;">
                        Before you build anything, make sure you <strong>fully understand the problem, the data, and the target outcomes</strong>, and decide how you <em>might</em> arrange your code or notebooks.
                    </p>
                </div>

                <!-- Key inputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #0078D4; margin-bottom: 1rem; font-size: 1rem;">üì• Key inputs</h5>
                    
                    <div style="display: grid; gap: 1.25rem;">
                        <!-- Part A Reference -->
                        <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); border-left: 4px solid #0078D4; padding: 1.25rem; border-radius: 6px;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span style="font-size: 1.3rem;">üìñ</span>
                                <h6 style="color: #0078D4; margin: 0; font-size: 0.95rem; font-weight: 600;">Part A Documentation</h6>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #90CAF9;">
                                    <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600;">A.1</div>
                                    <div style="font-size: 0.8rem; color: #555;">Use case & outcomes</div>
                                </div>
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #90CAF9;">
                                    <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600;">A.2</div>
                                    <div style="font-size: 0.8rem; color: #555;">Datasets overview</div>
                                </div>
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #90CAF9;">
                                    <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600;">A.3</div>
                                    <div style="font-size: 0.8rem; color: #555;">Per-ticket flow</div>
                                </div>
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #90CAF9;">
                                    <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600;">A.4</div>
                                    <div style="font-size: 0.8rem; color: #555;">Worked example</div>
                                </div>
                            </div>
                        </div>

                        <!-- Data Files -->
                        <div style="background: linear-gradient(135deg, #F5F5F5 0%, #E0E0E0 100%); border-left: 4px solid #0078D4; padding: 1.25rem; border-radius: 6px;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span style="font-size: 1.3rem;">üìÅ</span>
                                <h6 style="color: #0078D4; margin: 0; font-size: 0.95rem; font-weight: 600;">Repository Data Files</h6>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 0.75rem;">
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #BDBDBD; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.2rem;">üë•</span>
                                    <div>
                                        <div style="font-size: 0.75rem; color: #0078D4; font-family: 'Courier New', monospace; font-weight: 600;">users_roles.csv</div>
                                        <div style="font-size: 0.75rem; color: #777;">Employee profiles</div>
                                    </div>
                                </div>
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #BDBDBD; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.2rem;">üé´</span>
                                    <div>
                                        <div style="font-size: 0.75rem; color: #0078D4; font-family: 'Courier New', monospace; font-weight: 600;">support_tickets_labeled_full.csv</div>
                                        <div style="font-size: 0.75rem; color: #777;">Sample tickets</div>
                                    </div>
                                </div>
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #BDBDBD; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.2rem;">üîê</span>
                                    <div>
                                        <div style="font-size: 0.75rem; color: #0078D4; font-family: 'Courier New', monospace; font-weight: 600;">auth_rules.csv</div>
                                        <div style="font-size: 0.75rem; color: #777;">Authorization rules</div>
                                    </div>
                                </div>
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #BDBDBD; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.2rem;">üìö</span>
                                    <div>
                                        <div style="font-size: 0.75rem; color: #0078D4; font-family: 'Courier New', monospace; font-weight: 600;">kb_docs/</div>
                                        <div style="font-size: 0.75rem; color: #777;">Knowledge base docs</div>
                                    </div>
                                </div>
                            </div>
                            <p style="font-size: 0.75rem; margin-top: 0.75rem; margin-bottom: 0; color: #666; font-style: italic; text-align: center;">
                                üí° Tip: Replace placeholders with actual file names from your repo
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Key outputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #0078D4; margin-bottom: 1rem; font-size: 1rem;">üì§ Key outputs</h5>
                    <p style="font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.7; color: #555;">By the end of Stage 1 you should have:</p>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Mental Model -->
                        <div style="background: white; border: 2px solid #0078D4; border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                <span style="font-size: 1.3rem;">üß†</span>
                                <h6 style="color: #0078D4; margin: 0; font-size: 0.9rem; font-weight: 600;">Mental Model of Pipeline</h6>
                            </div>
                            <div style="background: #1E1E1E; color: #E0E0E0; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.85rem; margin-bottom: 0.75rem;">
                                <div style="text-align: center; line-height: 2;">
                                    <span style="color: #FFD700;">employee_id + ticket</span>
                                    <span style="color: #888;"> ‚Üí </span>
                                    <span style="color: #FF8C00;">classifier</span>
                                    <span style="color: #888;"> ‚Üí </span>
                                    <span style="color: #E91E63;">rules</span>
                                    <span style="color: #888;"> ‚Üí </span>
                                    <span style="color: #4CAF50;">RAG</span>
                                    <span style="color: #888;"> ‚Üí </span>
                                    <span style="color: #00B7C3;">final status</span>
                                </div>
                            </div>
                            <p style="font-size: 0.8rem; color: #666; margin: 0; text-align: center; font-style: italic;">
                                This is the core flow you'll implement across all stages
                            </p>
                        </div>

                        <!-- Understanding -->
                        <div style="background: white; border: 2px solid #0078D4; border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                <span style="font-size: 1.3rem;">‚úì</span>
                                <h6 style="color: #0078D4; margin: 0; font-size: 0.9rem; font-weight: 600;">Clear Understanding</h6>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                                <div style="background: #E3F2FD; padding: 1rem; border-radius: 4px; border-left: 3px solid #0078D4;">
                                    <div style="font-size: 0.8rem; color: #0078D4; font-weight: 600; margin-bottom: 0.5rem;">üìä Dataset Roles</div>
                                    <ul style="font-size: 0.75rem; color: #555; margin: 0; padding-left: 1.2rem; line-height: 1.6;">
                                        <li>Employees ‚Üí who can do what</li>
                                        <li>Auth rules ‚Üí permission logic</li>
                                        <li>KB docs ‚Üí answer source</li>
                                        <li>Tickets ‚Üí test cases</li>
                                    </ul>
                                </div>
                                <div style="background: #E3F2FD; padding: 1rem; border-radius: 4px; border-left: 3px solid #0078D4;">
                                    <div style="font-size: 0.8rem; color: #0078D4; font-weight: 600; margin-bottom: 0.5rem;">üéØ Possible Outcomes</div>
                                    <ul style="font-size: 0.75rem; color: #555; margin: 0; padding-left: 1.2rem; line-height: 1.6;">
                                        <li>blocked_by_appropriateness</li>
                                        <li>blocked_by_auth</li>
                                        <li>needs_approval</li>
                                        <li>solved_by_rag</li>
                                        <li>escalate</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Implementation Plan -->
                        <div style="background: white; border: 2px solid #0078D4; border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                <span style="font-size: 1.3rem;">üìã</span>
                                <h6 style="color: #0078D4; margin: 0; font-size: 0.9rem; font-weight: 600;">Implementation Plan</h6>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1rem;">
                                <div style="background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%); padding: 1rem; border-radius: 6px; border: 2px dashed #0078D4;">
                                    <div style="font-size: 0.8rem; color: #0078D4; font-weight: 600; margin-bottom: 0.5rem;">Option A: Single Notebook</div>
                                    <p style="font-size: 0.75rem; color: #555; margin: 0; line-height: 1.5; font-style: italic;">
                                        "One notebook with clear sections for each stage"
                                    </p>
                                </div>
                                <div style="background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%); padding: 1rem; border-radius: 6px; border: 2px dashed #0078D4;">
                                    <div style="font-size: 0.8rem; color: #0078D4; font-weight: 600; margin-bottom: 0.5rem;">Option B: Modular Files</div>
                                    <p style="font-size: 0.75rem; color: #555; margin: 0; line-height: 1.5; font-style: italic;">
                                        "Separate modules: classifier.py, rules.py, rag.py, pipeline.py"
                                    </p>
                                </div>
                                <div style="background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%); padding: 1rem; border-radius: 6px; border: 2px dashed #0078D4;">
                                    <div style="font-size: 0.8rem; color: #0078D4; font-weight: 600; margin-bottom: 0.5rem;">Option C: Your Choice</div>
                                    <p style="font-size: 0.75rem; color: #555; margin: 0; line-height: 1.5; font-style: italic;">
                                        "Organize in whatever way makes sense to you!"
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Things to do -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #0078D4; margin-bottom: 1rem; font-size: 1rem;">‚úÖ Things to do in this stage</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Step 1 -->
                        <div style="background: white; border-left: 4px solid #0078D4; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #0078D4; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">1</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #0078D4; margin: 0 0 0.5rem 0; font-size: 0.9rem; font-weight: 600;">üìñ Review Part A Documentation</h6>
                                    <p style="font-size: 0.85rem; color: #555; margin: 0; line-height: 1.6;">
                                        Re-read the <strong>business scenario</strong> and <strong>outcomes table</strong> in Part A to fully understand the problem space.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div style="background: white; border-left: 4px solid #0078D4; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #0078D4; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">2</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #0078D4; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üîç Explore All Dataset Files</h6>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
                                        <div style="background: #F0F8FF; padding: 0.75rem; border-radius: 4px; border: 1px solid #90CAF9;">
                                            <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600; margin-bottom: 0.3rem;">üë• Employees</div>
                                            <div style="font-size: 0.75rem; color: #666; line-height: 1.5;">Read 2-3 rows, understand profile structure</div>
                                        </div>
                                        <div style="background: #F0F8FF; padding: 0.75rem; border-radius: 4px; border: 1px solid #90CAF9;">
                                            <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600; margin-bottom: 0.3rem;">üé´ Tickets</div>
                                            <div style="font-size: 0.75rem; color: #666; line-height: 1.5;">Find examples for each flow type</div>
                                        </div>
                                        <div style="background: #F0F8FF; padding: 0.75rem; border-radius: 4px; border: 1px solid #90CAF9;">
                                            <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600; margin-bottom: 0.3rem;">üîê Auth Rules</div>
                                            <div style="font-size: 0.75rem; color: #666; line-height: 1.5;">See how profiles map to categories</div>
                                        </div>
                                        <div style="background: #F0F8FF; padding: 0.75rem; border-radius: 4px; border: 1px solid #90CAF9;">
                                            <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600; margin-bottom: 0.3rem;">üìö KB Docs</div>
                                            <div style="font-size: 0.75rem; color: #666; line-height: 1.5;">Open 1-2 docs, understand style</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div style="background: white; border-left: 4px solid #0078D4; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #0078D4; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">3</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #0078D4; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">‚úèÔ∏è Sketch the Flow</h6>
                                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                                        Draw or write notes about the pipeline stages:
                                    </p>
                                    <div style="background: #FAFAFA; padding: 1rem; border-radius: 4px; border: 1px dashed #0078D4;">
                                        <div style="font-size: 0.8rem; color: #555; line-height: 2;">
                                            <div>‚ùì Where does <strong>classification</strong> happen?</div>
                                            <div>‚ùì Where do <strong>rules</strong> get applied?</div>
                                            <div>‚ùì Where does <strong>RAG</strong> get called?</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div style="background: white; border-left: 4px solid #0078D4; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #0078D4; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">4</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #0078D4; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üóÇÔ∏è Plan Your Project Structure</h6>
                                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                                        Decide how you want to organize your code:
                                    </p>
                                    <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                                        <div style="background: #E3F2FD; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.75rem; color: #0078D4; border: 1px solid #90CAF9;">
                                            üìì Single notebook with sections
                                        </div>
                                        <div style="background: #E3F2FD; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.75rem; color: #0078D4; border: 1px solid #90CAF9;">
                                            üì¶ Separate .py files per module
                                        </div>
                                        <div style="background: #E3F2FD; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.75rem; color: #0078D4; border: 1px solid #90CAF9;">
                                            üé® Your own custom structure
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LangChain hint -->
                <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                    <h5 style="color: #FF8C00; margin-top: 0; font-size: 0.95rem;">üí° LangChain hint for later</h5>
                    <p style="font-size: 0.85rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        As you read Part A, try mapping each logical block to a future "thing" you might build:
                    </p>
                    <ul style="font-size: 0.8rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;"><strong>Classifier</strong> ‚Üí a small <code>ChatModel</code> + prompt that returns <code>{appropriateness, category}</code></li>
                        <li style="margin-bottom: 0.4rem;"><strong>RAG</strong> ‚Üí <code>retriever</code> + <code>ChatModel</code> with a support prompt</li>
                        <li style="margin-bottom: 0;"><strong>Pipeline</strong> ‚Üí simple control flow (if/else) that calls these pieces in order</li>
                    </ul>
                    <p style="font-size: 0.8rem; margin-top: 0.75rem; margin-bottom: 0; line-height: 1.7; color: #666; font-style: italic;">
                        You don't have to decide exact APIs yet, but having this map in mind will make Stages 2‚Äì6 much smoother.
                    </p>
                </div>
            </div>

            <!-- Stage 2 - Detailed -->
            <div class="card" style="background: white; border-left: 5px solid #00B7C3; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #00B7C3; margin-top: 0; font-size: 1.2rem;">üìö Stage 2 ‚Äì Build the Knowledge Base & Retrieval</h4>
                
                <!-- Objective -->
                <div style="background: #F0FAFB; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="color: #00B7C3; margin-top: 0; font-size: 1rem;">üéØ Objective</h5>
                    <p style="font-size: 0.9rem; margin: 0; line-height: 1.7; color: #333;">
                        Turn the raw <strong>KB documents</strong> into something your code can query: given a piece of ticket text, you should be able to ask "what does the KB say about this?" and get back a few relevant snippets.
                    </p>
                </div>

                <!-- Key inputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #00B7C3; margin-bottom: 1rem; font-size: 1rem;">üì• Key inputs</h5>
                    
                    <div style="background: linear-gradient(135deg, #E0F7FA 0%, #F0FEFF 100%); border: 2px solid #00B7C3; border-radius: 8px; padding: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1.25rem;">
                            <span style="font-size: 2rem;">üìö</span>
                            <div>
                                <h6 style="color: #00B7C3; margin: 0; font-size: 0.95rem; font-weight: 600;">Knowledge Base Repository</h6>
                                <code style="font-size: 0.8rem; color: #00838F; background: white; padding: 0.25rem 0.5rem; border-radius: 3px; margin-top: 0.25rem; display: inline-block;">kb_docs/</code>
                            </div>
                        </div>
                        
                        <p style="font-size: 0.85rem; color: #555; margin-bottom: 1rem; line-height: 1.6;">
                            Root folder containing all FAQs, policies, and support documentation
                        </p>
                        
                        <div style="background: white; border-radius: 6px; padding: 1rem; border: 1px solid #B2EBF2;">
                            <div style="font-size: 0.8rem; color: #00B7C3; font-weight: 600; margin-bottom: 0.75rem;">üìÑ Sample Documents:</div>
                            <div style="display: grid; gap: 0.5rem;">
                                <div style="background: #F0FEFF; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #00B7C3; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1rem;">üñ•Ô∏è</span>
                                    <div>
                                        <code style="font-size: 0.75rem; color: #00838F; font-weight: 600;">faq_hardware_issues.md</code>
                                        <div style="font-size: 0.7rem; color: #666;">Hardware troubleshooting</div>
                                    </div>
                                </div>
                                <div style="background: #F0FEFF; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #00B7C3; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1rem;">üíª</span>
                                    <div>
                                        <code style="font-size: 0.75rem; color: #00838F; font-weight: 600;">faq_software_issues.md</code>
                                        <div style="font-size: 0.7rem; color: #666;">Software/app support</div>
                                    </div>
                                </div>
                                <div style="background: #F0FEFF; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #00B7C3; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1rem;">üåê</span>
                                    <div>
                                        <code style="font-size: 0.75rem; color: #00838F; font-weight: 600;">faq_network_issues.md</code>
                                        <div style="font-size: 0.7rem; color: #666;">Network/connectivity FAQ</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Key outputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #00B7C3; margin-bottom: 1rem; font-size: 1rem;">üì§ Key outputs</h5>
                    <p style="font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.7; color: #555;">By the end of Stage 2 you should have:</p>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Chunked Documents -->
                        <div style="background: white; border: 2px solid #00B7C3; border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                <span style="font-size: 1.3rem;">üìÑ</span>
                                <h6 style="color: #00B7C3; margin: 0; font-size: 0.9rem; font-weight: 600;">Chunked Knowledge Base</h6>
                            </div>
                            <div style="background: #E0F7FA; padding: 1rem; border-radius: 6px; border-left: 4px solid #00B7C3;">
                                <div style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                                    All KB documents broken into <strong>small, overlapping chunks</strong> that:
                                </div>
                                <ul style="font-size: 0.8rem; color: #555; margin: 0; padding-left: 1.5rem; line-height: 1.7;">
                                    <li style="margin-bottom: 0.3rem;">‚úì Fit comfortably in LLM context windows</li>
                                    <li style="margin-bottom: 0.3rem;">‚úì Keep related content together</li>
                                    <li style="margin-bottom: 0;">‚úì Enable precise semantic matching</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Retrieval Interface -->
                        <div style="background: white; border: 2px solid #00B7C3; border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                <span style="font-size: 1.3rem;">üîç</span>
                                <h6 style="color: #00B7C3; margin: 0; font-size: 0.9rem; font-weight: 600;">Retrieval Interface</h6>
                            </div>
                            <div style="background: #1E1E1E; color: #E0E0E0; padding: 1.25rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.85rem; margin-bottom: 1rem;">
                                <div style="text-align: center; line-height: 2.2;">
                                    <span style="color: #FFD700;">ticket_text</span>
                                    <span style="color: #888;"> ‚Üí </span>
                                    <span style="color: #00B7C3;">retrieve_docs(ticket_text)</span>
                                    <span style="color: #888;"> ‚Üí </span>
                                    <span style="color: #4CAF50;">[chunk‚ÇÅ, chunk‚ÇÇ, ...]</span>
                                </div>
                            </div>
                            <div style="background: #E0F7FA; padding: 1rem; border-radius: 4px;">
                                <div style="font-size: 0.8rem; color: #555; line-height: 1.6;">
                                    <strong>Input:</strong> Query text (e.g., ticket subject + body)<br/>
                                    <strong>Output:</strong> Ranked list of most relevant KB chunks<br/>
                                    <strong>Used by:</strong> Stage 5 (RAG answering) to build context
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- What to do -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #00B7C3; margin-bottom: 1rem; font-size: 1rem;">‚úÖ What to do in this stage</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Step 1 -->
                        <div style="background: white; border-left: 4px solid #00B7C3; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #00B7C3; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">1</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #00B7C3; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üìÇ Load All KB Documents</h6>
                                    <div style="background: #E0F7FA; padding: 0.75rem; border-radius: 4px; margin-bottom: 0.5rem;">
                                        <ul style="font-size: 0.8rem; color: #555; margin: 0; padding-left: 1.2rem; line-height: 1.7;">
                                            <li style="margin-bottom: 0.3rem;">Read all files from <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;">kb_docs/</code></li>
                                            <li style="margin-bottom: 0;">Treat as plain text (Markdown OK, no rendering needed)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div style="background: white; border-left: 4px solid #00B7C3; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #00B7C3; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">2</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #00B7C3; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">‚úÇÔ∏è Split Into Chunks</h6>
                                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                                        Break long documents into smaller, overlapping chunks:
                                    </p>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                                        <div style="background: #E0F7FA; padding: 0.75rem; border-radius: 4px; border: 1px solid #B2EBF2;">
                                            <div style="font-size: 0.75rem; color: #00B7C3; font-weight: 600; margin-bottom: 0.3rem;">‚úì Goal 1</div>
                                            <div style="font-size: 0.75rem; color: #555;">Each chunk fits in LLM context</div>
                                        </div>
                                        <div style="background: #E0F7FA; padding: 0.75rem; border-radius: 4px; border: 1px solid #B2EBF2;">
                                            <div style="font-size: 0.75rem; color: #00B7C3; font-weight: 600; margin-bottom: 0.3rem;">‚úì Goal 2</div>
                                            <div style="font-size: 0.75rem; color: #555;">Related content stays together</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div style="background: white; border-left: 4px solid #00B7C3; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #00B7C3; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">3</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #00B7C3; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üßÆ Create Vector Representations</h6>
                                    <div style="background: #F0FEFF; padding: 1rem; border-radius: 6px; border: 2px dashed #00B7C3;">
                                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.75rem;">
                                            <div style="flex: 1;">
                                                <div style="font-size: 0.75rem; color: #00B7C3; font-weight: 600; margin-bottom: 0.3rem;">Step A: Compute Embeddings</div>
                                                <div style="font-size: 0.75rem; color: #555; line-height: 1.5;">Generate vector representations for each chunk</div>
                                            </div>
                                            <span style="font-size: 1.5rem;">‚Üí</span>
                                            <div style="flex: 1;">
                                                <div style="font-size: 0.75rem; color: #00B7C3; font-weight: 600; margin-bottom: 0.3rem;">Step B: Store in Index</div>
                                                <div style="font-size: 0.75rem; color: #555; line-height: 1.5;">Save to vector store (any backend)</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div style="background: white; border-left: 4px solid #00B7C3; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #00B7C3; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">4</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #00B7C3; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üîå Expose a Retriever Interface</h6>
                                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                                        Create a simple interface that accepts query text and returns ranked chunks:
                                    </p>
                                    <div style="background: #1E1E1E; padding: 1rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.8rem; margin-bottom: 0.75rem;">
                                        <div style="color: #6A9955;">// Function signature</div>
                                        <div style="color: #DCDCAA;">retrieve_docs</div><span style="color: #E0E0E0;">(</span><span style="color: #9CDCFE;">query_text</span><span style="color: #E0E0E0;">: </span><span style="color: #4EC9B0;">str</span><span style="color: #E0E0E0;">) -> </span><span style="color: #4EC9B0;">List[Chunk]</span>
                                    </div>
                                    <div style="background: #E0F7FA; padding: 0.75rem; border-radius: 4px;">
                                        <div style="font-size: 0.75rem; color: #555; line-height: 1.6;">
                                            <strong>Input:</strong> <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;">query_text</code> (e.g., subject + body)<br/>
                                            <strong>Returns:</strong> Ranked list of most relevant chunks
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mermaid diagram -->
                <div style="background: #FAFAFA; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="text-align: center; margin-bottom: 1rem; color: #333; font-size: 1rem;">KB Processing Pipeline</h5>
                    <div class="mermaid">
                        flowchart LR
                            Docs[KB docs folder] --> Loader[Load documents]
                            Loader --> Splitter[Split into chunks]
                            Splitter --> Embeddings[Create embeddings + vector store]
                            Embeddings --> Retriever[Retriever interface]
                            Ticket[Ticket text] --> Retriever
                            Retriever --> Context[Top-K context chunks]
                            
                            style Docs fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                            style Loader fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                            style Splitter fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                            style Embeddings fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                            style Retriever fill:#F0FAFB,stroke:#00B7C3,stroke-width:3px
                            style Ticket fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                            style Context fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                    </div>
                    <p style="text-align: center; color: #666; font-size: 0.85rem; margin-top: 1rem; font-style: italic; line-height: 1.6;">
                        Later, when a ticket is allowed, Stage 5 will call this retriever with the ticket text to build the <strong>context</strong> for the LLM answer.
                    </p>
                </div>

                <!-- LangChain hint -->
                <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                    <h5 style="color: #FF8C00; margin-top: 0; font-size: 0.95rem;">üí° LangChain hint</h5>
                    <p style="font-size: 0.85rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        If you're using LangChain, this stage typically follows a pattern like:
                    </p>
                    <ol style="font-size: 0.8rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;"><strong>Load docs</strong> ‚Üí <code>Document</code> objects</li>
                        <li style="margin-bottom: 0.4rem;"><strong>Split docs</strong> ‚Üí text splitter (e.g. recursive splitter)</li>
                        <li style="margin-bottom: 0.4rem;"><strong>Embed & index</strong> ‚Üí embeddings + vector store</li>
                        <li style="margin-bottom: 0;"><strong>Get a retriever</strong> ‚Üí something you can <code>.invoke(query_text)</code> to fetch top-k chunks</li>
                    </ol>
                    <p style="font-size: 0.85rem; margin-bottom: 0.5rem; line-height: 1.7; color: #333;">Conceptually:</p>
                    <div style="background: #1E1E1E; color: #E0E0E0; padding: 0.75rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.8rem; border: 1px solid #3A3A3A; line-height: 1.7;">
                        <code style="color: #E0E0E0;">
KB files<br/>
  ‚Üí loader<br/>
  ‚Üí splitter<br/>
  ‚Üí embeddings + vector store<br/>
  ‚Üí retriever<br/>
  ‚Üí (later) used inside your RAG answering chain
                        </code>
                    </div>
                </div>
            </div>

            <!-- Stage 3 - Detailed -->
            <div class="card" style="background: white; border-left: 5px solid #FF8C00; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #FF8C00; margin-top: 0; font-size: 1.2rem;">üîç Stage 3 ‚Äì Classifier: Intent & Appropriateness</h4>
                
                <!-- Objective -->
                <div style="background: #FFF9F0; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="color: #FF8C00; margin-top: 0; font-size: 1rem;">üéØ Objective</h5>
                    <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        Given a ticket's <strong>subject</strong> and <strong>body</strong>, produce a <strong>structured classification</strong> that tells you:
                    </p>
                    <ul style="font-size: 0.85rem; line-height: 1.8; color: #555; margin-bottom: 0.75rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">whether the ticket is <strong>appropriate</strong> for this IT support bot, and</li>
                        <li style="margin-bottom: 0;">which <strong>category</strong> it belongs to (e.g. <code>hardware_issue</code>, <code>software_issue</code>, <code>network_issue</code>, <code>access_request</code>, <code>policy_question</code>, ‚Ä¶).</li>
                    </ul>
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                        This is the first "smart" step in the pipeline: everything else depends on this call.
                    </p>
                </div>

                <!-- Key inputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #FF8C00; margin-bottom: 1rem; font-size: 1rem;">üì• Key inputs</h5>
                    
                    <div style="display: grid; gap: 1.25rem;">
                        <!-- Ticket Text -->
                        <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFECB3 100%); border: 2px solid #FF8C00; border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                <span style="font-size: 1.8rem;">üé´</span>
                                <h6 style="color: #FF8C00; margin: 0; font-size: 0.95rem; font-weight: 600;">Ticket Text</h6>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #FFCC80;">
                                    <div style="font-size: 0.75rem; color: #FF8C00; font-weight: 600; margin-bottom: 0.5rem;">üìù Subject</div>
                                    <div style="background: #FFF9E6; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #FF8C00; font-size: 0.75rem; color: #555; font-style: italic;">
                                        "Can't access VPN from home"
                                    </div>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #FFCC80;">
                                    <div style="font-size: 0.75rem; color: #FF8C00; font-weight: 600; margin-bottom: 0.5rem;">üìù Body</div>
                                    <div style="background: #FFF9E6; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #FF8C00; font-size: 0.75rem; color: #555; font-style: italic;">
                                        "Getting connection timeout errors..."
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Label Design -->
                        <div style="background: white; border: 2px solid #FF8C00; border-radius: 8px; padding: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                <span style="font-size: 1.8rem;">üè∑Ô∏è</span>
                                <h6 style="color: #FF8C00; margin: 0; font-size: 0.95rem; font-weight: 600;">Label Design (align with rules + KB)</h6>
                            </div>
                            
                            <div style="display: grid; gap: 1rem;">
                                <!-- Appropriateness -->
                                <div style="background: #FFF9F0; padding: 1rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                                    <div style="font-size: 0.8rem; color: #FF8C00; font-weight: 600; margin-bottom: 0.5rem;">‚úÖ Appropriateness</div>
                                    <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                                        <div style="background: white; border: 2px solid #4CAF50; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.75rem; color: #4CAF50; font-weight: 600;">
                                            "appropriate"
                                        </div>
                                        <div style="background: white; border: 2px solid #D32F2F; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.75rem; color: #D32F2F; font-weight: 600;">
                                            "not_appropriate"
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Categories -->
                                <div style="background: #FFF9F0; padding: 1rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                                    <div style="font-size: 0.8rem; color: #FF8C00; font-weight: 600; margin-bottom: 0.75rem;">üìä Categories</div>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                        <span style="background: #E3F2FD; padding: 0.4rem 0.75rem; border-radius: 15px; font-size: 0.7rem; color: #0078D4; border: 1px solid #90CAF9;">hardware_issue</span>
                                        <span style="background: #E0F7FA; padding: 0.4rem 0.75rem; border-radius: 15px; font-size: 0.7rem; color: #00B7C3; border: 1px solid #B2EBF2;">software_issue</span>
                                        <span style="background: #FFF9E6; padding: 0.4rem 0.75rem; border-radius: 15px; font-size: 0.7rem; color: #FF8C00; border: 1px solid #FFCC80;">network_issue</span>
                                        <span style="background: #FFF0F6; padding: 0.4rem 0.75rem; border-radius: 15px; font-size: 0.7rem; color: #E91E63; border: 1px solid #F8BBD0;">access_request</span>
                                        <span style="background: #E8F5E9; padding: 0.4rem 0.75rem; border-radius: 15px; font-size: 0.7rem; color: #4CAF50; border: 1px solid #C8E6C9;">general_question</span>
                                        <span style="background: #F5F5F5; padding: 0.4rem 0.75rem; border-radius: 15px; font-size: 0.7rem; color: #757575; border: 1px solid #E0E0E0;">other</span>
                                    </div>
                                </div>
                            </div>
                            
                            <p style="font-size: 0.75rem; margin-top: 1rem; margin-bottom: 0; color: #666; text-align: center; font-style: italic;">
                                üí° Align categories with <code style="background: #FFF9E6; padding: 0.15rem 0.4rem; border-radius: 3px;">expected_category</code> values in sample tickets
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Key outputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #FF8C00; margin-bottom: 1rem; font-size: 1rem;">üì§ Key outputs</h5>
                    
                    <div style="background: white; border: 2px solid #FF8C00; border-radius: 8px; padding: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 1.3rem;">üìä</span>
                            <h6 style="color: #FF8C00; margin: 0; font-size: 0.9rem; font-weight: 600;">Structured Classification Object</h6>
                        </div>
                        
                        <p style="font-size: 0.85rem; color: #555; margin-bottom: 1rem; line-height: 1.6;">
                            A <strong>structured object</strong> (not free text), returned in JSON format:
                        </p>
                        
                        <div style="background: #1E1E1E; color: #E0E0E0; padding: 1.25rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.85rem; margin-bottom: 1.5rem; line-height: 1.8;">
                            <div><span style="color: #E0E0E0;">{</span></div>
                            <div style="padding-left: 1rem;">
                                <span style="color: #9CDCFE;">"appropriateness"</span><span style="color: #E0E0E0;">: </span>
                                <span style="color: #CE9178;">"appropriate"</span><span style="color: #888;"> | </span>
                                <span style="color: #CE9178;">"not_appropriate"</span><span style="color: #E0E0E0;">,</span>
                            </div>
                            <div style="padding-left: 1rem;">
                                <span style="color: #9CDCFE;">"category"</span><span style="color: #E0E0E0;">: </span>
                                <span style="color: #CE9178;">"&lt;one_of_your_categories&gt;"</span>
                            </div>
                            <div><span style="color: #E0E0E0;">}</span></div>
                        </div>
                        
                        <div style="background: #FFF9E6; padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                            <div style="font-size: 0.85rem; color: #FF8C00; font-weight: 600; margin-bottom: 0.75rem;">üîÄ How These Fields Are Used:</div>
                            <div style="display: grid; gap: 0.75rem;">
                                <div style="background: white; padding: 1rem; border-radius: 4px; display: flex; align-items: start; gap: 0.75rem;">
                                    <div style="background: #4CAF50; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; flex-shrink: 0; margin-top: 0.1rem;">‚úì</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 0.8rem; color: #333; font-weight: 600; margin-bottom: 0.25rem;"><code style="background: #E8F5E9; color: #4CAF50; padding: 0.15rem 0.4rem; border-radius: 3px;">appropriateness</code></div>
                                        <div style="font-size: 0.75rem; color: #666; line-height: 1.5;">Feeds into <strong>scope guardrail</strong> ‚Üí blocks out-of-scope tickets immediately</div>
                                    </div>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 4px; display: flex; align-items: start; gap: 0.75rem;">
                                    <div style="background: #0078D4; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; flex-shrink: 0; margin-top: 0.1rem;">‚Üí</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 0.8rem; color: #333; font-weight: 600; margin-bottom: 0.25rem;"><code style="background: #E3F2FD; color: #0078D4; padding: 0.15rem 0.4rem; border-radius: 3px;">category</code></div>
                                        <div style="font-size: 0.75rem; color: #666; line-height: 1.5;">Passes to <strong>authorization rules</strong> and <strong>RAG</strong> logic</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- What to do -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #FF8C00; margin-bottom: 1rem; font-size: 1rem;">‚úÖ What to do in this stage</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Step 1 -->
                        <div style="background: white; border-left: 4px solid #FF8C00; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #FF8C00; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">1</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #FF8C00; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üè∑Ô∏è Design Your Label Space</h6>
                                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                                        Define a clear, consistent set of categories:
                                    </p>
                                    <div style="background: #FFF9F0; padding: 1rem; border-radius: 4px;">
                                        <div style="display: grid; gap: 0.5rem;">
                                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                <span style="color: #4CAF50; font-weight: 600;">‚úì</span>
                                                <span style="font-size: 0.8rem; color: #555;">Keep it small and meaningful (5-10 categories max)</span>
                                            </div>
                                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                <span style="color: #4CAF50; font-weight: 600;">‚úì</span>
                                                <span style="font-size: 0.8rem; color: #555;">Every sample ticket must map to one category</span>
                                            </div>
                                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                <span style="color: #4CAF50; font-weight: 600;">‚úì</span>
                                                <span style="font-size: 0.8rem; color: #555;">Use exact same names in <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;">auth_rules</code> file</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div style="background: white; border-left: 4px solid #FF8C00; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #FF8C00; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">2</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #FF8C00; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">‚úçÔ∏è Write Classification Prompt</h6>
                                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                                        Create a clear, structured prompt with these components:
                                    </p>
                                    <div style="display: grid; gap: 0.75rem;">
                                        <div style="background: #E3F2FD; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #0078D4;">
                                            <div style="font-size: 0.75rem; color: #0078D4; font-weight: 600; margin-bottom: 0.3rem;">üéØ Scope Definition</div>
                                            <div style="font-size: 0.75rem; color: #555; line-height: 1.5;">Explain what IT support bot should/shouldn't handle</div>
                                        </div>
                                        <div style="background: #E8F5E9; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #4CAF50;">
                                            <div style="font-size: 0.75rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.3rem;">üìù Examples</div>
                                            <div style="font-size: 0.75rem; color: #555; line-height: 1.5;">
                                                In-scope: password reset, VPN issues<br/>
                                                Out-of-scope: programming help, personal finance
                                            </div>
                                        </div>
                                        <div style="background: #FFF9E6; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #FF8C00;">
                                            <div style="font-size: 0.75rem; color: #FF8C00; font-weight: 600; margin-bottom: 0.3rem;">üìä Output Format</div>
                                            <div style="font-size: 0.75rem; color: #555; line-height: 1.5;">Request JSON structure only (machine-readable)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div style="background: white; border-left: 4px solid #FF8C00; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #FF8C00; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">3</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #FF8C00; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üîß Build Classifier Function/Chain</h6>
                                    <div style="background: #FFF9F0; padding: 1rem; border-radius: 6px; border: 2px dashed #FF8C00; margin-bottom: 0.75rem;">
                                        <div style="background: #1E1E1E; padding: 0.75rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.8rem; margin-bottom: 0.75rem;">
                                            <div style="color: #6A9955;">// Function signature</div>
                                            <div><span style="color: #DCDCAA;">classify_ticket</span><span style="color: #E0E0E0;">(</span><span style="color: #9CDCFE;">subject</span><span style="color: #E0E0E0;">, </span><span style="color: #9CDCFE;">body</span><span style="color: #E0E0E0;">) -> </span><span style="color: #4EC9B0;">ClassificationResult</span></div>
                                        </div>
                                        <div style="font-size: 0.8rem; color: #555; line-height: 1.6;">
                                            <strong>Input:</strong> subject + body<br/>
                                            <strong>Output:</strong> <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;">{appropriateness, category}</code><br/>
                                            <strong>Fallback:</strong> Handle malformed responses gracefully
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div style="background: white; border-left: 4px solid #FF8C00; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #FF8C00; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">4</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #FF8C00; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üß™ Test with Manual Examples</h6>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                                        <div style="background: #E8F5E9; padding: 1rem; border-radius: 4px; border: 2px solid #4CAF50;">
                                            <div style="font-size: 0.75rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.5rem;">‚úì In-Scope Tests</div>
                                            <div style="font-size: 0.75rem; color: #555; line-height: 1.5;">
                                                Test with 3-5 clear<br/>
                                                in-scope tickets<br/>
                                                (VPN, login, etc.)
                                            </div>
                                        </div>
                                        <div style="background: #FFEBEE; padding: 1rem; border-radius: 4px; border: 2px solid #D32F2F;">
                                            <div style="font-size: 0.75rem; color: #D32F2F; font-weight: 600; margin-bottom: 0.5rem;">‚úó Out-of-Scope Tests</div>
                                            <div style="font-size: 0.75rem; color: #555; line-height: 1.5;">
                                                Test with 3-5 clear<br/>
                                                out-of-scope tickets<br/>
                                                (unrelated topics)
                                            </div>
                                        </div>
                                    </div>
                                    <p style="font-size: 0.75rem; color: #666; margin: 0.75rem 0 0 0; text-align: center; font-style: italic;">
                                        Verify outputs match expectations before proceeding to Stage 4
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mermaid diagram -->
                <div style="background: #FAFAFA; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="text-align: center; margin-bottom: 1rem; color: #333; font-size: 1rem;">Classification Flow</h5>
                    <div class="mermaid">
                        flowchart LR
                            Ticket[Ticket subject + body] --> Prompt[Classification prompt]
                            Prompt --> SmallLLM[Small LLM / SLM]
                            SmallLLM --> Intent["{appropriateness, category}"]
                            
                            style Ticket fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                            style Prompt fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                            style SmallLLM fill:#F3E5F5,stroke:#9C27B0,stroke-width:2px
                            style Intent fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                    </div>
                    <div style="margin-top: 1rem; padding: 1rem; background: #FFF9E6; border-left: 4px solid #FF8C00; border-radius: 4px;">
                        <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #333;">
                            This classifier is the <strong>first gate</strong> in your pipeline:
                        </p>
                        <ul style="font-size: 0.8rem; line-height: 1.8; color: #555; margin: 0.5rem 0 0 1.5rem; padding: 0;">
                            <li style="margin-bottom: 0.3rem;">If <code>appropriateness = "not_appropriate"</code> ‚Üí you'll return <code>blocked_by_appropriateness</code>.</li>
                            <li style="margin-bottom: 0;">If <code>appropriate</code> ‚Üí you'll use <code>category</code> in the authorization and RAG stages.</li>
                        </ul>
                    </div>
                </div>

                <!-- LangChain hint -->
                <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                    <h5 style="color: #FF8C00; margin-top: 0; font-size: 0.95rem;">üí° LangChain hint</h5>
                    <ul style="font-size: 0.8rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Think of your classifier as a <strong>small, separate chain</strong>, not part of the main RAG prompt.</li>
                        <li style="margin-bottom: 0;">Typical building blocks:
                            <ul style="margin-top: 0.3rem; font-size: 0.75rem;">
                                <li style="margin-bottom: 0.3rem;">A <strong>chat model</strong> configured for classification (often a smaller/cheaper deployment than your main answering model).</li>
                                <li style="margin-bottom: 0.3rem;">A <strong>prompt template</strong> that:
                                    <ul style="margin-top: 0.2rem;">
                                        <li>describes the IT support scope,</li>
                                        <li>lists the allowed labels,</li>
                                        <li>and shows 2‚Äì3 examples.</li>
                                    </ul>
                                </li>
                                <li style="margin-bottom: 0;">A <strong>structured output parser</strong> (or a simple JSON post-processing step) that turns the model's text into a Python dict.</li>
                            </ul>
                        </li>
                    </ul>
                    <p style="font-size: 0.85rem; margin-bottom: 0.5rem; line-height: 1.7; color: #333;">Conceptual pipeline:</p>
                    <div style="background: #1E1E1E; color: #E0E0E0; padding: 0.75rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.8rem; border: 1px solid #3A3A3A; line-height: 1.7;">
                        <code style="color: #E0E0E0;">
(subject + body)<br/>
  ‚Üí classification prompt<br/>
  ‚Üí small chat model<br/>
  ‚Üí parsed into {appropriateness, category}
                        </code>
                    </div>
                </div>
            </div>

            <!-- Stage 4 - Detailed -->
            <div class="card" style="background: white; border-left: 5px solid #E91E63; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #E91E63; margin-top: 0; font-size: 1.2rem;">üîê Stage 4 ‚Äì Authorization: Allowed, Needs Approval, or Blocked</h4>
                
                <!-- Objective -->
                <div style="background: #FFF0F6; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="color: #E91E63; margin-top: 0; font-size: 1rem;">üéØ Objective</h5>
                    <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        For tickets that are <strong>appropriate</strong> for IT support, decide whether this specific employee is:
                    </p>
                    <ul style="font-size: 0.85rem; line-height: 1.8; color: #555; margin-bottom: 0.75rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;"><strong>allowed</strong> to make this type of request,</li>
                        <li style="margin-bottom: 0.4rem;">requires <strong>higher-level approval</strong>, or</li>
                        <li style="margin-bottom: 0;">is <strong>not allowed</strong> at all.</li>
                    </ul>
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                        This logic must be <strong>rule-based</strong>, not delegated to the LLM.
                    </p>
                </div>

                <!-- Key inputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #E91E63; margin-bottom: 1rem; font-size: 1rem;">üì• Key inputs</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- From Classifier -->
                        <div style="background: linear-gradient(135deg, #FFF0F6 0%, #FCE4EC 100%); border-left: 4px solid #E91E63; padding: 1.25rem; border-radius: 6px;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span style="font-size: 1.3rem;">üîç</span>
                                <h6 style="color: #E91E63; margin: 0; font-size: 0.9rem; font-weight: 600;">From Stage 3 (Classifier)</h6>
                            </div>
                            <div style="background: white; padding: 1rem; border-radius: 4px; border: 1px solid #F8BBD0;">
                                <code style="background: #FFF0F6; color: #E91E63; padding: 0.25rem 0.6rem; border-radius: 4px; font-size: 0.85rem; font-weight: 600;">category</code>
                                <span style="font-size: 0.8rem; color: #666; margin-left: 0.5rem;">‚Üí The ticket category label</span>
                            </div>
                        </div>

                        <!-- From Employees Data -->
                        <div style="background: linear-gradient(135deg, #FFF0F6 0%, #FCE4EC 100%); border-left: 4px solid #E91E63; padding: 1.25rem; border-radius: 6px;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span style="font-size: 1.3rem;">üë•</span>
                                <h6 style="color: #E91E63; margin: 0; font-size: 0.9rem; font-weight: 600;">From Employees Data</h6>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #F8BBD0;">
                                    <code style="font-size: 0.75rem; color: #E91E63; font-weight: 600;">employee_id</code>
                                    <div style="font-size: 0.7rem; color: #666; margin-top: 0.25rem;">From request</div>
                                </div>
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #F8BBD0;">
                                    <code style="font-size: 0.75rem; color: #E91E63; font-weight: 600;">role</code>
                                    <div style="font-size: 0.7rem; color: #666; margin-top: 0.25rem;">Employee's role</div>
                                </div>
                                <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px solid #F8BBD0;">
                                    <code style="font-size: 0.75rem; color: #E91E63; font-weight: 600;">department</code>
                                    <div style="font-size: 0.7rem; color: #666; margin-top: 0.25rem;">+ seniority level</div>
                                </div>
                            </div>
                        </div>

                        <!-- From Auth Rules -->
                        <div style="background: linear-gradient(135deg, #FFF0F6 0%, #FCE4EC 100%); border-left: 4px solid #E91E63; padding: 1.25rem; border-radius: 6px;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span style="font-size: 1.3rem;">üìë</span>
                                <h6 style="color: #E91E63; margin: 0; font-size: 0.9rem; font-weight: 600;">From Authorization Rules Config</h6>
                            </div>
                            <div style="background: white; padding: 1rem; border-radius: 4px; border: 1px solid #F8BBD0;">
                                <div style="font-size: 0.8rem; color: #555; margin-bottom: 0.75rem; font-weight: 600;">
                                    Per <code style="background: #FFF0F6; padding: 0.15rem 0.4rem; border-radius: 3px;">role + department</code>, defines:
                                </div>
                                <div style="display: grid; gap: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <div style="width: 6px; height: 6px; background: #4CAF50; border-radius: 50%;"></div>
                                        <code style="font-size: 0.75rem; color: #4CAF50; font-weight: 600;">allowed_categories</code>
                                        <span style="font-size: 0.7rem; color: #666;">‚Üí proceed to RAG</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <div style="width: 6px; height: 6px; background: #FFB74D; border-radius: 50%;"></div>
                                        <code style="font-size: 0.75rem; color: #FFB74D; font-weight: 600;">needs_approval</code>
                                        <span style="font-size: 0.7rem; color: #666;">‚Üí escalate for approval</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <div style="width: 6px; height: 6px; background: #D32F2F; border-radius: 50%;"></div>
                                        <code style="font-size: 0.75rem; color: #D32F2F; font-weight: 600;">denied_categories</code>
                                        <span style="font-size: 0.7rem; color: #666;">‚Üí block immediately</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key outputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #E91E63; margin-bottom: 1rem; font-size: 1rem;">üì§ Key outputs</h5>
                    
                    <div style="background: white; border: 2px solid #E91E63; border-radius: 8px; padding: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 1.3rem;">‚öñÔ∏è</span>
                            <h6 style="color: #E91E63; margin: 0; font-size: 0.9rem; font-weight: 600;">Authorization Decision Object</h6>
                        </div>
                        
                        <div style="background: #1E1E1E; color: #E0E0E0; padding: 1.25rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.85rem; margin-bottom: 1.5rem; line-height: 1.8;">
                            <div><span style="color: #E0E0E0;">{</span></div>
                            <div style="padding-left: 1rem;">
                                <span style="color: #9CDCFE;">"status"</span><span style="color: #E0E0E0;">: </span>
                                <span style="color: #CE9178;">"allowed"</span><span style="color: #888;"> | </span>
                                <span style="color: #CE9178;">"needs_approval"</span><span style="color: #888;"> | </span>
                                <span style="color: #CE9178;">"blocked_by_auth"</span><span style="color: #E0E0E0;">,</span>
                            </div>
                            <div style="padding-left: 1rem;">
                                <span style="color: #9CDCFE;">"reason"</span><span style="color: #E0E0E0;">: </span>
                                <span style="color: #CE9178;">"&lt;human-readable explanation&gt;"</span>
                            </div>
                            <div><span style="color: #E0E0E0;">}</span></div>
                        </div>
                        
                        <div style="background: #FFF0F6; padding: 1.25rem; border-radius: 6px; border-left: 4px solid #E91E63;">
                            <div style="font-size: 0.85rem; color: #E91E63; font-weight: 600; margin-bottom: 1rem;">üîÄ Status Drives Pipeline Outcomes:</div>
                            <div style="display: grid; gap: 0.75rem;">
                                <div style="background: white; padding: 1rem; border-radius: 4px; border-left: 3px solid #D32F2F;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.3rem;">
                                        <span style="background: #D32F2F; color: white; padding: 0.2rem 0.6rem; border-radius: 3px; font-size: 0.7rem; font-weight: 600;">‚õî BLOCKED_BY_AUTH</span>
                                        <span style="font-size: 0.75rem; color: #888;">‚Üí</span>
                                        <code style="font-size: 0.75rem; background: #FFEBEE; color: #D32F2F; padding: 0.2rem 0.5rem; border-radius: 3px; font-weight: 600;">blocked_by_auth</code>
                                    </div>
                                    <div style="font-size: 0.7rem; color: #666; padding-left: 0.5rem;">Stop here, return block message to user</div>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 4px; border-left: 3px solid #FFB74D;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.3rem;">
                                        <span style="background: #FFB74D; color: white; padding: 0.2rem 0.6rem; border-radius: 3px; font-size: 0.7rem; font-weight: 600;">‚ö†Ô∏è NEEDS_APPROVAL</span>
                                        <span style="font-size: 0.75rem; color: #888;">‚Üí</span>
                                        <code style="font-size: 0.75rem; background: #FFF3E0; color: #FFB74D; padding: 0.2rem 0.5rem; border-radius: 3px; font-weight: 600;">needs_approval</code>
                                    </div>
                                    <div style="font-size: 0.7rem; color: #666; padding-left: 0.5rem;">Stop here, inform user approval required</div>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 4px; border-left: 3px solid #4CAF50;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.3rem;">
                                        <span style="background: #4CAF50; color: white; padding: 0.2rem 0.6rem; border-radius: 3px; font-size: 0.7rem; font-weight: 600;">‚úÖ ALLOWED</span>
                                        <span style="font-size: 0.75rem; color: #888;">‚Üí</span>
                                        <code style="font-size: 0.75rem; background: #E8F5E9; color: #4CAF50; padding: 0.2rem 0.5rem; border-radius: 3px; font-weight: 600;">Proceed to Stage 5 (RAG)</code>
                                    </div>
                                    <div style="font-size: 0.7rem; color: #666; padding-left: 0.5rem;">Continue pipeline, call RAG answering</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- What to do -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #E91E63; margin-bottom: 1rem; font-size: 1rem;">‚úÖ What to do in this stage</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Step 1 -->
                        <div style="background: white; border-left: 4px solid #E91E63; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #E91E63; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">1</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #E91E63; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üë§ Implement Employee Lookup</h6>
                                    <div style="background: #FFF0F6; padding: 1rem; border-radius: 6px; margin-bottom: 0.75rem;">
                                        <div style="font-size: 0.8rem; color: #E91E63; font-weight: 600; margin-bottom: 0.5rem;">Given <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;">employee_id</code>, return profile with:</div>
                                        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                            <span style="background: white; border: 1px solid #F8BBD0; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #E91E63;">employee_id</span>
                                            <span style="background: white; border: 1px solid #F8BBD0; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #E91E63;">role</span>
                                            <span style="background: white; border: 1px solid #F8BBD0; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #E91E63;">department</span>
                                            <span style="background: white; border: 1px solid #F8BBD0; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #E91E63; font-weight: 600;">seniority</span>
                                        </div>
                                    </div>
                                    <div style="background: #FFEBEE; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #D32F2F;">
                                        <div style="font-size: 0.75rem; color: #D32F2F; font-weight: 600; margin-bottom: 0.3rem;">‚ö†Ô∏è Handle Unknown IDs:</div>
                                        <div style="font-size: 0.7rem; color: #666;">Treat as lowest-privileged OR reject with clear error</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div style="background: white; border-left: 4px solid #E91E63; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #E91E63; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">2</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #E91E63; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üìã Load Authorization Rules Config</h6>
                                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; line-height: 1.6;">
                                        Read <code style="background: #FFF0F6; padding: 0.15rem 0.4rem; border-radius: 3px; color: #E91E63;">auth_rules.csv</code> into memory
                                    </p>
                                    <div style="background: #FFF0F6; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.8rem; color: #E91E63; font-weight: 600; margin-bottom: 0.5rem;">For each rule, map intent + role + department to outcome:</div>
                                        <div style="display: grid; gap: 0.4rem;">
                                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                <div style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%;"></div>
                                                <span style="font-size: 0.75rem; color: #555;">Categories that are <strong style="color: #4CAF50;">allowed</strong></span>
                                            </div>
                                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                <div style="width: 8px; height: 8px; background: #FFB74D; border-radius: 50%;"></div>
                                                <span style="font-size: 0.75rem; color: #555;">Categories that <strong style="color: #FFB74D;">need_approval</strong></span>
                                            </div>
                                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                <div style="width: 8px; height: 8px; background: #D32F2F; border-radius: 50%;"></div>
                                                <span style="font-size: 0.75rem; color: #555;">Categories that are <strong style="color: #D32F2F;">denied</strong></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div style="background: white; border-left: 4px solid #E91E63; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #E91E63; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">3</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #E91E63; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">‚öôÔ∏è Build Rule Engine</h6>
                                    <div style="background: #1E1E1E; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.8rem; margin-bottom: 0.75rem;">
                                        <div style="color: #6A9955;">// Function signature</div>
                                        <div><span style="color: #DCDCAA;">check_authorization</span><span style="color: #E0E0E0;\">(</span></div>
                                        <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">employee_profile</span><span style="color: #E0E0E0;\">,</span></div>
                                        <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">category</span><span style="color: #E0E0E0;\">,</span></div>
                                        <div><span style="color: #E0E0E0;\">) -> </span><span style="color: #4EC9B0;\">{status, reason}</span></div>
                                    </div>
                                    <div style="background: #FFF9E6; padding: 1rem; border-radius: 6px; border-left: 3px solid #FF8C00;">
                                        <div style="font-size: 0.75rem; color: #FF8C00; font-weight: 600; margin-bottom: 0.5rem;">Decision Logic Order:</div>
                                        <div style="font-size: 0.7rem; color: #555; line-height: 1.8;">
                                            <div><strong>1.</strong> If in <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">denied</code> list ‚Üí <span style="color: #D32F2F; font-weight: 600;\">blocked_by_auth</span></div>
                                            <div><strong>2.</strong> Else if in <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">needs_approval</code> list ‚Üí <span style="color: #FFB74D; font-weight: 600;\">needs_approval</span></div>
                                            <div><strong>3.</strong> Else if in <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">allowed</code> list ‚Üí <span style="color: #4CAF50; font-weight: 600;\">allowed</span></div>
                                            <div><strong>4.</strong> Else ‚Üí safe default (often <span style="color: #FFB74D; font-weight: 600;\">needs_approval</span>)</div>
                                        </div>
                                    </div>
                                    <div style="background: #FFEBEE; padding: 1rem; border-radius: 6px; border-left: 3px solid #D32F2F; margin-top: 0.75rem;">
                                        <div style="font-size: 0.75rem; color: #D32F2F; font-weight: 600; margin-bottom: 0.5rem;">‚ö†Ô∏è When Multiple Rules Match:</div>
                                        <div style="font-size: 0.7rem; color: #555; line-height: 1.8;">
                                            <div style="margin-bottom: 0.3rem;">If multiple rules match the same (intent, role, department), apply these precedence rules:</div>
                                            <div><strong>1.</strong> Most specific match wins (fewer wildcards <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;">*</code>)</div>
                                            <div><strong>2.</strong> If equally specific, apply: <span style="color: #D32F2F; font-weight: 600;">blocked_by_auth</span> > <span style="color: #FFB74D; font-weight: 600;">needs_approval</span> > <span style="color: #4CAF50; font-weight: 600;">allowed</span></div>
                                            <div style="margin-top: 0.3rem; font-style: italic;">Example: Rules R5 and R11 both match <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;">junior_engineer + engineering + access_request</code>. R11 specifies <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;">blocked_by_auth</code>, so it takes precedence over R5's <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;">needs_approval</code>.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div style="background: white; border-left: 4px solid #E91E63; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #E91E63; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">4</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #E91E63; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üß™ Test with Scenarios</h6>
                                    <div style="background: #FFF0F6; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.8rem; color: #E91E63; font-weight: 600; margin-bottom: 0.75rem;">Example: <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;\">junior_engineer + engineering</code> profile</div>
                                        <div style="display: grid; gap: 0.5rem;">
                                            <div style="background: #E8F5E9; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #4CAF50; display: flex; align-items: center; justify-content: space-between;">
                                                <code style="font-size: 0.75rem; color: #4CAF50; font-weight: 600;\">network_issue</code>
                                                <span style="background: #4CAF50; color: white; padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.65rem; font-weight: 600;\">‚úì allowed</span>
                                            </div>
                                            <div style="background: #FFF3E0; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #FFB74D; display: flex; align-items: center; justify-content: space-between;">
                                                <code style="font-size: 0.75rem; color: #FFB74D; font-weight: 600;\">access_request</code>
                                                <span style="background: #FFB74D; color: white; padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.65rem; font-weight: 600;\">‚ö† approval</span>
                                            </div>
                                            <div style="background: #FFEBEE; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #D32F2F; display: flex; align-items: center; justify-content: space-between;">
                                                <code style="font-size: 0.75rem; color: #D32F2F; font-weight: 600;\">off_scope</code>
                                                <span style="background: #D32F2F; color: white; padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.65rem; font-weight: 600;\">‚úó denied</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mermaid diagram -->
                <div style="background: #FAFAFA; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="text-align: center; margin-bottom: 1rem; color: #333; font-size: 1rem;">Authorization Flow</h5>
                    <div class="mermaid">
                        flowchart LR
                            EmpId[employee_id] --> EmpLookup[Lookup in employees data]
                            EmpLookup --> Profile[Employee profile]
                            Category[Ticket category] --> RulesEngine[Authorization rules engine]
                            Profile --> RulesEngine
                            RulesConfig[Auth rules config] --> RulesEngine
                            RulesEngine --> Decision["{status, reason}"]
                            
                            style EmpId fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                            style EmpLookup fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                            style Profile fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                            style Category fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                            style RulesEngine fill:#FFF0F6,stroke:#E91E63,stroke-width:3px
                            style RulesConfig fill:#F3E5F5,stroke:#9C27B0,stroke-width:2px
                            style Decision fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                    </div>
                    <p style="text-align: center; color: #666; font-size: 0.85rem; margin-top: 1rem; font-style: italic; line-height: 1.6;">
                        The authorization engine is where <strong>who you are</strong> (employee profile) meets <strong>what you're asking for</strong> (ticket category) and <strong>what the policy says</strong> (rules config) to produce a clear decision.
                    </p>
                </div>

                <!-- LangChain hint -->
                <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                    <h5 style="color: #FF8C00; margin-top: 0; font-size: 0.95rem;">üí° LangChain hint</h5>
                    <ul style="font-size: 0.8rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">This step is <strong>not a chain</strong> and does <strong>not</strong> call the LLM.</li>
                        <li style="margin-bottom: 0;">Treat it as a pure function:
                            <div style="background: #1E1E1E; color: #E0E0E0; padding: 0.5rem; border-radius: 4px; margin-top: 0.3rem; font-family: 'Courier New', monospace; font-size: 0.75rem;">
                                <code style="color: #E0E0E0;">auth_decision = check_authorization(employee_profile, category)</code>
                            </div>
                        </li>
                    </ul>
                    <p style="font-size: 0.85rem; margin-bottom: 0.5rem; line-height: 1.7; color: #333;">The benefits of keeping this logic symbolic:</p>
                    <ul style="font-size: 0.75rem; line-height: 1.8; color: #555; margin: 0; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.3rem;"><strong>Transparent:</strong> you can read and review the rules file.</li>
                        <li style="margin-bottom: 0.3rem;"><strong>Deterministic:</strong> same inputs ‚Üí same decision every time.</li>
                        <li style="margin-bottom: 0;"><strong>Easy to adjust:</strong> change config without touching prompts or models.</li>
                    </ul>
                </div>
            </div>

            <!-- Stage 5 - Detailed -->
            <div class="card" style="background: white; border-left: 5px solid #4CAF50; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #4CAF50; margin-top: 0; font-size: 1.2rem;">üí¨ Stage 5 ‚Äì Answering Chain: RAG + LLM</h4>
                
                <!-- Objective -->
                <div style="background: #F1F8F4; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="color: #4CAF50; margin-top: 0; font-size: 1rem;">üéØ Objective</h5>
                    <p style="font-size: 0.9rem; margin: 0; line-height: 1.7; color: #333;">
                        For tickets that are both <strong>appropriate</strong> and <strong>allowed</strong>, generate a <strong>grounded support answer</strong> using the knowledge base. If the KB doesn't provide enough support, respond safely and <strong>escalate</strong> instead of guessing.
                    </p>
                </div>

                <!-- Key inputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #4CAF50; margin-bottom: 1rem; font-size: 1rem;">üì• Key inputs</h5>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem;">
                        <!-- Ticket Content Card -->
                        <div style="background: linear-gradient(135deg, #F1F8F4 0%, #E8F5E9 100%); border-left: 4px solid #4CAF50; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <h6 style="color: #4CAF50; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üé´ Ticket Content</h6>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                <span style="background: white; border: 1px solid #4CAF50; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #4CAF50; font-weight: 600;">subject</span>
                                <span style="background: white; border: 1px solid #4CAF50; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #4CAF50; font-weight: 600;">body</span>
                            </div>
                            <p style="font-size: 0.7rem; color: #666; margin: 0.75rem 0 0 0; line-height: 1.5; font-style: italic;">Primary input for both retrieval query and LLM context</p>
                        </div>

                        <!-- KB Retriever Card -->
                        <div style="background: linear-gradient(135deg, #F0FAFB 0%, #E0F7FA 100%); border-left: 4px solid #00B7C3; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <h6 style="color: #00B7C3; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üìö KB Retriever (Stage 2)</h6>
                            <div style="background: #1E1E1E; padding: 0.75rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.7rem; margin-bottom: 0.5rem;">
                                <div><span style="color: #9CDCFE;">query_text</span> <span style="color: #E0E0E0;">‚Üí</span></div>
                                <div style="padding-left: 1rem;"><span style="color: #E0E0E0;">[</span><span style="color: #CE9178;">chunk_1</span><span style="color: #E0E0E0;">,</span></div>
                                <div style="padding-left: 1rem;"><span style="color: #CE9178;"> chunk_2</span><span style="color: #E0E0E0;">,</span></div>
                                <div style="padding-left: 1rem;"><span style="color: #CE9178;"> ...</span><span style="color: #E0E0E0;">]</span></div>
                            </div>
                            <p style="font-size: 0.7rem; color: #666; margin: 0; line-height: 1.5;">Returns top-k relevant chunks from embedded KB</p>
                        </div>

                        <!-- Employee Info Card -->
                        <div style="background: linear-gradient(135deg, #F9F5FF 0%, #F3E5F5 100%); border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); opacity: 0.85;">
                            <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üë§ Employee Info <span style="font-size: 0.7rem; font-weight: 400; color: #999;">(optional)</span></h6>
                            <div style="background: white; padding: 0.75rem; border-radius: 4px; border: 1px dashed #CE93D8;">
                                <p style="font-size: 0.75rem; color: #666; margin: 0; line-height: 1.6;">May tailor response based on:</p>
                                <ul style="font-size: 0.7rem; color: #888; margin: 0.3rem 0 0 1rem; padding: 0; line-height: 1.7;">
                                    <li>role & seniority</li>
                                    <li>department</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key outputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #4CAF50; margin-bottom: 1rem; font-size: 1rem;">üì§ Key outputs</h5>
                    
                    <div style="background: white; border-left: 4px solid #4CAF50; padding: 1.5rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                        <!-- Answer String -->
                        <div style="margin-bottom: 1.25rem;">
                            <h6 style="color: #4CAF50; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üí¨ Support Answer String</h6>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.75rem;">
                                <div style="background: #E8F5E9; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #4CAF50;">
                                    <div style="font-size: 0.7rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.3rem;">üìã Troubleshooting Steps</div>
                                    <div style="font-size: 0.65rem; color: #666;">Step-by-step resolution</div>
                                </div>
                                <div style="background: #E3F2FD; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #2196F3;">
                                    <div style="font-size: 0.7rem; color: #2196F3; font-weight: 600; margin-bottom: 0.3rem;">üìú Policy Explanation</div>
                                    <div style="font-size: 0.65rem; color: #666;">Why/how things work</div>
                                </div>
                                <div style="background: #FFF3E0; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #FF9800;">
                                    <div style="font-size: 0.7rem; color: #FF9800; font-weight: 600; margin-bottom: 0.3rem;">‚¨ÜÔ∏è Escalation Message</div>
                                    <div style="font-size: 0.65rem; color: #666;">When KB insufficient</div>
                                </div>
                            </div>
                        </div>

                        <!-- Status Decision -->
                        <div style="background: #F5F5F5; padding: 1rem; border-radius: 6px;">
                            <h6 style="color: #4CAF50; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">‚úì Status Decision</h6>
                            <div style="display: grid; gap: 0.5rem;">
                                <div style="background: #E8F5E9; padding: 0.75rem; border-radius: 4px; display: flex; align-items: center; justify-content: space-between; border-left: 3px solid #4CAF50;">
                                    <span style="font-size: 0.75rem; color: #555;">KB clearly covers issue</span>
                                    <code style="background: #4CAF50; color: white; padding: 0.25rem 0.6rem; border-radius: 3px; font-size: 0.7rem; font-weight: 600;">solved_by_rag</code>
                                </div>
                                <div style="background: #FFF3E0; padding: 0.75rem; border-radius: 4px; display: flex; align-items: center; justify-content: space-between; border-left: 3px solid #FF9800;">
                                    <span style="font-size: 0.75rem; color: #555;">KB doesn't provide enough context</span>
                                    <code style="background: #FF9800; color: white; padding: 0.25rem 0.6rem; border-radius: 3px; font-size: 0.7rem; font-weight: 600;">escalate</code>
                                </div>
                            </div>
                        </div>

                        <p style="font-size: 0.75rem; margin: 1rem 0 0 0; color: #888; font-style: italic; line-height: 1.6;">
                            üí° How you distinguish these outcomes is up to you ‚Äî Part A just defines the behavior
                        </p>
                    </div>
                </div>

                <!-- What to do -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #4CAF50; margin-bottom: 1rem; font-size: 1rem;">‚úÖ What to do in this stage</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Step 1 -->
                        <div style="background: white; border-left: 4px solid #4CAF50; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #4CAF50; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">1</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #4CAF50; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üîç Prepare Retriever Query</h6>
                                    <div style="background: #F1F8F4; padding: 1rem; border-radius: 6px; margin-bottom: 0.75rem;">
                                        <div style="font-size: 0.8rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.5rem;">Common approach:</div>
                                        <div style="background: #1E1E1E; padding: 0.75rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.75rem; margin-bottom: 0.5rem;">
                                            <div style="color: #9CDCFE;">query_text</div>
                                            <div style="color: #E0E0E0; padding-left: 1rem;">= <span style="color: #CE9178;">subject</span> + <span style="color: #CE9178;">" "</span> + <span style="color: #CE9178;\">body</span></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: #666;\">‚ú® Optional: Include <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">category</code> to guide retrieval</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div style="background: white; border-left: 4px solid #4CAF50; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #4CAF50; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">2</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #4CAF50; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üìö Retrieve Context Chunks</h6>
                                    <div style="background: #E0F7FA; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.8rem; color: #00838F; font-weight: 600; margin-bottom: 0.5rem;">Call retriever with query:</div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                            <span style="background: white; border: 1px solid #00B7C3; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #00838F;\">Ask for top-k chunks</span>
                                            <span style="background: white; border: 1px solid #00B7C3; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #00838F;\">k = 3-5</span>
                                        </div>
                                        <div style="font-size: 0.7rem; color: #666; margin-top: 0.5rem;\">‚û°Ô∏è Pass these chunks into LLM prompt as "KB context"</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div style="background: white; border-left: 4px solid #4CAF50; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #4CAF50; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">3</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #4CAF50; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üí¨ Design Support-Oriented Prompt</h6>
                                    
                                    <!-- System Message -->
                                    <div style="background: #E3F2FD; padding: 1rem; border-radius: 6px; margin-bottom: 0.75rem;">
                                        <div style="font-size: 0.75rem; color: #1976D2; font-weight: 600; margin-bottom: 0.5rem;">System Message should:</div>
                                        <div style="display: grid; gap: 0.3rem;">
                                            <div style="font-size: 0.7rem; color: #555; display: flex; align-items: center; gap: 0.3rem;">
                                                <span style="color: #1976D2;">‚ñ™</span> Remind model: <strong>"You're an internal IT support assistant"</strong>
                                            </div>
                                            <div style="font-size: 0.7rem; color: #555; display: flex; align-items: center; gap: 0.3rem;">
                                                <span style="color: #1976D2;">‚ñ™</span> Instruct: <strong>"Rely ONLY on provided context"</strong>
                                            </div>
                                            <div style="font-size: 0.7rem; color: #555; display: flex; align-items: center; gap: 0.3rem;">
                                                <span style="color: #1976D2;">‚ñ™</span> Specify: <strong>"If insufficient ‚Üí suggest escalation"</strong>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- User Message -->
                                    <div style="background: #F1F8F4; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.75rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.5rem;">User Message should include:</div>
                                        <div style="display: flex; flex-wrap: wrap; gap: 0.4rem;">
                                            <span style="background: white; border: 1px solid #81C784; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #388E3C;\">Ticket details (subject + body)</span>
                                            <span style="background: white; border: 1px solid #81C784; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; color: #388E3C;\">Retrieved context snippets</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div style="background: white; border-left: 4px solid #4CAF50; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #4CAF50; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">4</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #4CAF50; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">‚ö†Ô∏è Handle "No Good Answer"</h6>
                                    <div style="background: #FFF9E6; padding: 1rem; border-radius: 6px; border-left: 3px solid #FF9800;">
                                        <div style="font-size: 0.75rem; color: #FF9800; font-weight: 600; margin-bottom: 0.75rem;">Detection strategies:</div>
                                        <div style="display: grid; gap: 0.5rem; margin-bottom: 0.75rem;">
                                            <div style="background: white; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;">
                                                <strong>Option A:</strong> Check quality/quantity of retrieved chunks
                                            </div>
                                            <div style="background: white; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;">
                                                <strong>Option B:</strong> Ask model to explicitly signal if under-informed
                                            </div>
                                        </div>
                                        <div style="background: #FFEBEE; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #D32F2F;">
                                            <div style="font-size: 0.7rem; color: #D32F2F; font-weight: 600; margin-bottom: 0.3rem;">‚õî Safe behavior:</div>
                                            <div style="font-size: 0.7rem; color: #666; line-height: 1.6;">Return polite escalation message:<br/><em>"I can't resolve this automatically, please escalate to L2/L3"</em></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mermaid diagram -->
                <div style="background: #FAFAFA; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="text-align: center; margin-bottom: 1rem; color: #333; font-size: 1rem;">RAG Answering Flow</h5>
                    <div class="mermaid">
                        flowchart LR
                            Ticket[Ticket subject + body] --> Retriever[KB retriever]
                            Retriever --> Context[Top-K context chunks]
                            
                            Context --> Prompt[Support prompt\nsystem + context + ticket]
                            Ticket --> Prompt
                            
                            Prompt --> BigLLM[Support LLM]
                            BigLLM --> Answer[Support answer or escalation message]
                            
                            style Ticket fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                            style Retriever fill:#F0FAFB,stroke:#00B7C3,stroke-width:2px
                            style Context fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                            style Prompt fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                            style BigLLM fill:#F3E5F5,stroke:#9C27B0,stroke-width:2px
                            style Answer fill:#E8F5E9,stroke:#4CAF50,stroke-width:3px
                    </div>
                    <div style="margin-top: 1rem; padding: 1rem; background: #F1F8F4; border-left: 4px solid #4CAF50; border-radius: 4px;">
                        <p style="font-size: 0.85rem; margin-bottom: 0.5rem; line-height: 1.7; color: #333;">
                            For allowed tickets, this chain is responsible for turning <strong>KB knowledge + ticket details</strong> into a clear, grounded support reply.
                        </p>
                        <p style="font-size: 0.8rem; margin: 0; line-height: 1.7; color: #666;">
                            In Stage 6, you'll wrap this so that:
                        </p>
                        <ul style="font-size: 0.75rem; line-height: 1.8; color: #555; margin: 0.5rem 0 0 1.5rem; padding: 0;">
                            <li style="margin-bottom: 0.3rem;">good answers lead to <code>solved_by_rag</code>, and</li>
                            <li style="margin-bottom: 0;">"I can't answer" cases lead to <code>escalate</code> (escalate to human agent).</li>
                        </ul>
                    </div>
                </div>

                <!-- LangChain hint -->
                <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                    <h5 style="color: #FF8C00; margin-top: 0; font-size: 0.95rem;">üí° LangChain hint</h5>
                    <p style="font-size: 0.85rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        A very typical RAG answering structure looks like:
                    </p>
                    <div style="background: #1E1E1E; color: #E0E0E0; padding: 0.75rem; border-radius: 4px; margin-bottom: 1rem; font-family: 'Courier New', monospace; font-size: 0.8rem; border: 1px solid #3A3A3A; line-height: 1.7;">
                        <code style="color: #E0E0E0;">
ticket_text<br/>
  ‚Üí retriever<br/>
  ‚Üí context_docs<br/>
  ‚Üí prompt template (system + context + ticket)<br/>
  ‚Üí chat model (answering LLM)<br/>
  ‚Üí final answer string
                        </code>
                    </div>
                    <p style="font-size: 0.85rem; margin-bottom: 0.5rem; line-height: 1.7; color: #333;">Building blocks you might use:</p>
                    <ul style="font-size: 0.75rem; line-height: 1.8; color: #555; margin-bottom: 0.75rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.3rem;">A <strong>retriever</strong> from Stage 2.</li>
                        <li style="margin-bottom: 0.3rem;">A <strong>chat model</strong> (often a slightly stronger model than your classifier).</li>
                        <li style="margin-bottom: 0;">A <strong>prompt template</strong> that stitches together:
                            <ul style="margin-top: 0.2rem;">
                                <li>system instructions,</li>
                                <li>KB context,</li>
                                <li>ticket description.</li>
                            </ul>
                        </li>
                    </ul>
                    <p style="font-size: 0.8rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                        You can keep all of this as one "answering chain" that you call only when <code>auth_status == "allowed"</code>.
                    </p>
                </div>
            </div>

            <!-- Stage 6 - Detailed -->
            <div class="card" style="background: white; border-left: 5px solid #9C27B0; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #9C27B0; margin-top: 0; font-size: 1.2rem;">‚öôÔ∏è Stage 6 ‚Äì Orchestrate the Per-Ticket Pipeline</h4>
                
                <!-- Objective -->
                <div style="background: #F3E5F5; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="color: #9C27B0; margin-top: 0; font-size: 1rem;">üéØ Objective</h5>
                    <p style="font-size: 0.9rem; margin: 0; line-height: 1.7; color: #333;">
                        Combine <strong>classifier</strong>, <strong>authorization rules</strong>, and <strong>RAG answering</strong> into a single, <strong>stateless per-ticket pipeline</strong> that:
                    </p>
                    <ul style="font-size: 0.85rem; line-height: 1.8; color: #555; margin: 0.75rem 0 0 1.5rem; padding: 0;">
                        <li style="margin-bottom: 0.4rem;">takes <code>employee_id + ticket</code> as input, and</li>
                        <li style="margin-bottom: 0;">returns a <strong>final status</strong> (one of the A.1.2 outcomes) plus a message/answer and optional debug info.</li>
                    </ul>
                </div>

                <!-- Key inputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #9C27B0; margin-bottom: 1rem; font-size: 1rem;">üì• Key inputs</h5>
                    
                    <!-- Primary Inputs -->
                    <div style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); margin-bottom: 1rem;">
                        <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üé´ Primary Inputs (Per-Ticket)</h6>
                        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                            <span style="background: white; border: 2px solid #9C27B0; padding: 0.4rem 0.8rem; border-radius: 12px; font-size: 0.75rem; color: #9C27B0; font-weight: 600;">employee_id</span>
                            <span style="background: white; border: 2px solid #9C27B0; padding: 0.4rem 0.8rem; border-radius: 12px; font-size: 0.75rem; color: #9C27B0; font-weight: 600;">subject</span>
                            <span style="background: white; border: 2px solid #9C27B0; padding: 0.4rem 0.8rem; border-radius: 12px; font-size: 0.75rem; color: #9C27B0; font-weight: 600;">body</span>
                        </div>
                    </div>

                    <!-- Stage Components -->
                    <div style="display: grid; gap: 0.75rem;">
                        <!-- Stage 3 Component -->
                        <div style="background: white; border-left: 4px solid #FF8C00; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="background: #FF8C00; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.7rem; flex-shrink: 0;">3</div>
                                <div style="flex: 1;">
                                    <div style="font-size: 0.8rem; color: #FF8C00; font-weight: 600;">Classifier Function/Chain</div>
                                    <div style="font-size: 0.7rem; color: #666; margin-top: 0.2rem;">‚Üí <code style="background: #FFF9E6; padding: 0.1rem 0.4rem; border-radius: 3px;">{appropriateness, category}</code></div>
                                </div>
                            </div>
                        </div>

                        <!-- Stage 4 Component -->
                        <div style="background: white; border-left: 4px solid #E91E63; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="background: #E91E63; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.7rem; flex-shrink: 0;">4</div>
                                <div style="flex: 1;">
                                    <div style="font-size: 0.8rem; color: #E91E63; font-weight: 600;">Authorization Function</div>
                                    <div style="font-size: 0.7rem; color: #666; margin-top: 0.2rem;">‚Üí <code style="background: #FFF0F6; padding: 0.1rem 0.4rem; border-radius: 3px;">{status: allowed/needs_approval/blocked_by_auth, reason}</code></div>
                                </div>
                            </div>
                        </div>

                        <!-- Stage 5 Component -->
                        <div style="background: white; border-left: 4px solid #4CAF50; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="background: #4CAF50; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.7rem; flex-shrink: 0;">5</div>
                                <div style="flex: 1;">
                                    <div style="font-size: 0.8rem; color: #4CAF50; font-weight: 600;">Answering Chain (RAG + LLM)</div>
                                    <div style="font-size: 0.7rem; color: #666; margin-top: 0.2rem;">‚Üí <code style="background: #F1F8F4; padding: 0.1rem 0.4rem; border-radius: 3px;">answer_text</code> + notion of "answerable" vs "no_answer"</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key outputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #9C27B0; margin-bottom: 1rem; font-size: 1rem;">üì§ Key outputs</h5>
                    
                    <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.5rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                        <p style="font-size: 0.85rem; margin-bottom: 0.75rem; line-height: 1.7; color: #555;">For each ticket, a <strong>single structured result</strong>:</p>
                        
                        <!-- JSON Structure -->
                        <div style="background: #1E1E1E; color: #E0E0E0; padding: 1rem; border-radius: 6px; margin-bottom: 1rem; font-family: 'Courier New', monospace; font-size: 0.8rem; line-height: 1.7;">
                            <div><span style="color: #E0E0E0;">{</span></div>
                            <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">"status"</span><span style="color: #E0E0E0;">:</span> <span style="color: #CE9178;">"<one_final_status>"</span><span style="color: #E0E0E0;">,</span></div>
                            <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">"message_or_answer"</span><span style="color: #E0E0E0;">:</span> <span style="color: #CE9178;">"<user-facing text>"</span><span style="color: #E0E0E0;">,</span></div>
                            <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">"debug"</span><span style="color: #E0E0E0;">:</span> <span style="color: #E0E0E0;">{</span></div>
                            <div style="padding-left: 2rem;"><span style="color: #9CDCFE;">"intent"</span><span style="color: #E0E0E0;">:</span> <span style="color: #E0E0E0;">{</span><span style="color: #4EC9B0;">appropriateness</span><span style="color: #E0E0E0;">,</span> <span style="color: #4EC9B0;">category</span><span style="color: #E0E0E0;">},</span></div>
                            <div style="padding-left: 2rem;"><span style="color: #9CDCFE;">"auth"</span><span style="color: #E0E0E0;">:</span> <span style="color: #E0E0E0;">{</span><span style="color: #4EC9B0;">status</span><span style="color: #E0E0E0;">,</span> <span style="color: #4EC9B0;">reason</span><span style="color: #E0E0E0;">}</span></div>
                            <div style="padding-left: 1rem;"><span style="color: #E0E0E0;">}</span></div>
                            <div><span style="color: #E0E0E0;">}</span></div>
                        </div>

                        <!-- Status Outcomes -->
                        <div style="background: #F3E5F5; padding: 1rem; border-radius: 6px;">
                            <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.85rem; font-weight: 600;">Possible <code>status</code> values (A.1.2 outcomes):</h6>
                            <div style="display: grid; gap: 0.5rem;">
                                <div style="background: #FFEBEE; padding: 0.5rem 0.75rem; border-radius: 4px; border-left: 3px solid #D32F2F; font-size: 0.75rem;">
                                    <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px; color: #D32F2F; font-weight: 600;">blocked_by_appropriateness</code>
                                </div>
                                <div style="background: #FFEBEE; padding: 0.5rem 0.75rem; border-radius: 4px; border-left: 3px solid #D32F2F; font-size: 0.75rem;">
                                    <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px; color: #D32F2F; font-weight: 600;">blocked_by_auth</code>
                                </div>
                                <div style="background: #FFF3E0; padding: 0.5rem 0.75rem; border-radius: 4px; border-left: 3px solid #FFB74D; font-size: 0.75rem;">
                                    <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px; color: #FFB74D; font-weight: 600;">needs_approval</code>
                                </div>
                                <div style="background: #E8F5E9; padding: 0.5rem 0.75rem; border-radius: 4px; border-left: 3px solid #4CAF50; font-size: 0.75rem;">
                                    <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px; color: #4CAF50; font-weight: 600;">solved_by_rag</code>
                                </div>
                                <div style="background: #F5F5F5; padding: 0.5rem 0.75rem; border-radius: 4px; border-left: 3px solid #9E9E9E; font-size: 0.75rem;">
                                    <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px; color: #757575; font-weight: 600;">escalate</code>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recommended control flow -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #9C27B0; margin-bottom: 1rem; font-size: 1rem;">üîÑ Recommended control flow</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Step 1 -->
                        <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #9C27B0; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">1</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üë§ Employee Lookup</h6>
                                    <div style="background: #F3E5F5; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.75rem; color: #555; margin-bottom: 0.75rem;">Look up <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;\">employee_id</code> in employees data</div>
                                        <div style="background: #FFEBEE; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #D32F2F;">
                                            <div style="font-size: 0.7rem; color: #D32F2F; font-weight: 600; margin-bottom: 0.3rem;">If not found, decide policy:</div>
                                            <div style="font-size: 0.7rem; color: #666; line-height: 1.6;">
                                                ‚Ä¢ Treat as lowest-permission (likely block)<br/>
                                                ‚Ä¢ OR return error-like status
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #9C27B0; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">2</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üè∑Ô∏è Classifier Step</h6>
                                    <div style="background: #FFF9F0; padding: 1rem; border-radius: 6px; border-left: 3px solid #FF8C00;">
                                        <div style="font-size: 0.75rem; color: #555; margin-bottom: 0.5rem;">Call classifier with <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;\">subject + body</code></div>
                                        <div style="font-size: 0.75rem; color: #FF8C00; font-weight: 600;\">‚Üí Get: <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px; color: #FF8C00;\">{appropriateness, category}</code></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #9C27B0; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">3</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üöß Appropriateness Guardrail</h6>
                                    <div style="background: #FFEBEE; padding: 1rem; border-radius: 6px; border-left: 3px solid #D32F2F;">
                                        <div style="font-size: 0.75rem; color: #D32F2F; font-weight: 600; margin-bottom: 0.5rem;\">If <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px;\">appropriateness == "not_appropriate"</code>:</div>
                                        <div style="background: white; padding: 0.75rem; border-radius: 4px; margin-bottom: 0.5rem;">
                                            <div style="font-size: 0.7rem; color: #D32F2F; font-weight: 600;\">‚õî STOP HERE</div>
                                            <div style="font-size: 0.7rem; color: #666; margin-top: 0.3rem; line-height: 1.6;\">
                                                <code style="background: #FFEBEE; padding: 0.1rem 0.3rem; border-radius: 3px;\">status = "blocked_by_appropriateness"</code><br/>
                                                <code style="background: #FFEBEE; padding: 0.1rem 0.3rem; border-radius: 3px;\">message = "<polite out-of-scope>"</code>
                                            </div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: #666; font-style: italic;\">No auth check, no RAG needed</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #9C27B0; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">4</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üîê Authorization Step</h6>
                                    <div style="background: #FFF0F6; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.75rem; color: #555; margin-bottom: 0.5rem;\">Call rule engine with:</div>
                                        <div style="display: flex; flex-wrap: wrap; gap: 0.4rem; margin-bottom: 0.75rem;\">
                                            <span style="background: white; border: 1px solid #E91E63; padding: 0.2rem 0.5rem; border-radius: 12px; font-size: 0.7rem; color: #E91E63;\">employee_profile</span>
                                            <span style="background: white; border: 1px solid #E91E63; padding: 0.2rem 0.5rem; border-radius: 12px; font-size: 0.7rem; color: #E91E63;\">category</span>
                                        </div>
                                        <div style="font-size: 0.75rem; color: #E91E63; font-weight: 600; margin-bottom: 0.5rem;\">Depending on auth.status:</div>
                                        <div style="display: grid; gap: 0.5rem;\">
                                            <div style="background: #FFEBEE; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;\">
                                                <strong style="color: #D32F2F;\">blocked_by_auth</strong> ‚Üí <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">blocked_by_auth</code> + explanation
                                            </div>
                                            <div style="background: #FFF3E0; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;\">
                                                <strong style="color: #FF9800;\">needs_approval</strong> ‚Üí <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">needs_approval</code> + \"Requires L3 approval\"
                                            </div>
                                            <div style="background: #E8F5E9; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;\">
                                                <strong style="color: #4CAF50;\">allowed</strong> ‚Üí <strong>proceed to answering ‚û°Ô∏è</strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 5 -->
                        <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #9C27B0; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">5</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üí¨ RAG Answering Step</h6>
                                    <div style="background: #F1F8F4; padding: 1rem; border-radius: 6px; border-left: 3px solid #4CAF50;">
                                        <div style="background: white; padding: 0.75rem; border-radius: 4px; margin-bottom: 0.75rem; border: 1px dashed #4CAF50;\">
                                            <div style="font-size: 0.7rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.3rem;\">‚úì Only when: <code style="background: #F1F8F4; padding: 0.15rem 0.4rem; border-radius: 3px;\">auth.status == "allowed"</code></div>
                                            <div style="font-size: 0.7rem; color: #666;\">Call answering chain with ticket text (+ optional employee info)</div>
                                        </div>
                                        <div style="font-size: 0.75rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.5rem;\">Then decide:</div>
                                        <div style="display: grid; gap: 0.4rem;\">
                                            <div style="background: #E8F5E9; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;\">
                                                ‚úÖ Answer clearly grounded ‚Üí <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px; color: #4CAF50; font-weight: 600;\">solved_by_rag</code>
                                            </div>
                                            <div style="background: #FFF3E0; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;\">
                                                ‚ö†Ô∏è Lack of context / escalation indicated ‚Üí <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px; color: #FF9800; font-weight: 600;\">escalate</code>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 6 -->
                        <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #9C27B0; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">6</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üì¶ Return Final Result</h6>
                                    <div style="background: #F3E5F5; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.75rem; color: #555; margin-bottom: 0.5rem;\">Return single object with:</div>
                                        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;\">
                                            <span style="background: #9C27B0; color: white; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; font-weight: 600;\">status</span>
                                            <span style="background: #9C27B0; color: white; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem; font-weight: 600;\">message_or_answer</span>
                                            <span style="background: #BA68C8; color: white; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.7rem;\">debug (intent + auth)</span>
                                        </div>
                                        <p style="font-size: 0.65rem; color: #888; margin: 0.5rem 0 0 0; font-style: italic;\">Debug info useful for debugging & evaluation</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mermaid diagram -->
                <div style="background: #FAFAFA; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="text-align: center; margin-bottom: 1rem; color: #333; font-size: 1rem;">End-to-End Per-Ticket Pipeline</h5>
                    <div class="mermaid">
                        flowchart TD
                            Start[Input: employee_id + ticket] --> Emp[Lookup employee profile]
                            Emp --> Classifier[Intent & appropriateness classifier]
                            
                            Classifier -->|not_appropriate| S1[Return\nblocked_by_appropriateness]
                            
                            Classifier -->|appropriate| Auth[Authorization rules engine]
                            
                            Auth -->|blocked_by_auth| S2[Return\nblocked_by_auth]
                            Auth -->|needs_approval| S3[Return\nneeds_approval]
                            Auth -->|allowed| RAG[RAG + LLM answering]
                            
                            RAG -->|answerable from KB| S4[Return\nsolved_by_rag]
                            RAG -->|no good KB context| S5[Return\nescalate]
                            
                            style Start fill:#FFF9E6,stroke:#FF8C00,stroke-width:2px
                            style Emp fill:#E3F2FD,stroke:#0078D4,stroke-width:2px
                            style Classifier fill:#FFF9F0,stroke:#FF8C00,stroke-width:2px
                            style Auth fill:#FFF0F6,stroke:#E91E63,stroke-width:2px
                            style RAG fill:#F1F8F4,stroke:#4CAF50,stroke-width:2px
                            style S1 fill:#FFEBEE,stroke:#D13438,stroke-width:2px
                            style S2 fill:#FFEBEE,stroke:#D13438,stroke-width:2px
                            style S3 fill:#FFF3E0,stroke:#FFB74D,stroke-width:2px
                            style S4 fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
                            style S5 fill:#E0E0E0,stroke:#9E9E9E,stroke-width:2px
                    </div>
                    <p style="text-align: center; color: #666; font-size: 0.85rem; margin-top: 1rem; font-style: italic; line-height: 1.6;">
                        This is the <strong>end-to-end per-ticket flow</strong> that ties Part A and Part B together.<br/>
                        In Stage 7, you'll run the sample tickets through this pipeline and check that each ticket lands in the <strong>intended final status</strong>.
                    </p>
                </div>

                <!-- LangChain hint -->
                <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                    <h5 style="color: #FF8C00; margin-top: 0; font-size: 0.95rem;">üí° LangChain hint</h5>
                    <ul style="font-size: 0.8rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Don't try to make one "mega prompt" that does everything.</li>
                        <li style="margin-bottom: 0;">Instead, think of your solution as:
                            <ul style="margin-top: 0.3rem; font-size: 0.75rem;">
                                <li>one <strong>classifier chain</strong> (Stage 3),</li>
                                <li>one <strong>retriever + answering chain</strong> (Stage 5),</li>
                                <li>plus <strong>simple control flow</strong> in normal Python to decide which one to call when.</li>
                            </ul>
                        </li>
                    </ul>
                    <p style="font-size: 0.85rem; margin-bottom: 0.5rem; line-height: 1.7; color: #333;">You can:</p>
                    <ul style="font-size: 0.75rem; line-height: 1.8; color: #555; margin-bottom: 0.75rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.3rem;">call the classifier chain,</li>
                        <li style="margin-bottom: 0.3rem;">branch on its output (<code>appropriate</code> vs <code>not_appropriate</code>),</li>
                        <li style="margin-bottom: 0.3rem;">then call the rules function,</li>
                        <li style="margin-bottom: 0;">then optionally call the RAG chain.</li>
                    </ul>
                    <p style="font-size: 0.8rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                        If you like LangChain "graphs" or "routers", you <em>can</em> model this as a graph, but a straightforward <code>if/else</code> orchestration is perfectly fine for this hackathon.
                    </p>
                </div>
            </div>

            <!-- Stage 7 - Detailed -->
            <div class="card" style="background: white; border-left: 5px solid #FF5722; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #FF5722; margin-top: 0; font-size: 1.2rem;">‚úÖ Stage 7 ‚Äì Test & Iterate with Sample Tickets</h4>
                
                <!-- Objective -->
                <div style="background: #FFF3E0; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
                    <h5 style="color: #FF5722; margin-top: 0; font-size: 1rem;">üéØ Objective</h5>
                    <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                        Run your <strong>full pipeline</strong> on the provided <strong>sample tickets</strong> and check:
                    </p>
                    <ul style="font-size: 0.85rem; line-height: 1.8; color: #555; margin-bottom: 0.75rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Does each ticket land in the <strong>right final status</strong> (one of the A.1.2 outcomes)?</li>
                        <li style="margin-bottom: 0;">If not, is the problem in the <strong>classifier</strong>, the <strong>rules</strong>, or the <strong>RAG</strong>?</li>
                    </ul>
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                        Then iterate: adjust prompts/rules, run again, and converge on sensible behavior.
                    </p>
                </div>

                <!-- Key inputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #FF5722; margin-bottom: 1rem; font-size: 1rem;">üì• Key inputs</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Sample Tickets Dataset -->
                        <div style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); border-left: 4px solid #FF5722; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <h6 style="color: #FF5722; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üìä Sample Tickets Dataset <code style="background: white; padding: 0.15rem 0.4rem; border-radius: 3px; font-size: 0.8rem;">support_tickets_labeled_full.csv</code></h6>
                            <div style="background: white; padding: 1rem; border-radius: 6px;">
                                <div style="font-size: 0.75rem; color: #FF5722; font-weight: 600; margin-bottom: 0.5rem;">Dataset columns:</div>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">
                                    <div style="background: #FFF3E0; padding: 0.5rem; border-radius: 4px; border-left: 3px solid #FF5722;">
                                        <code style="font-size: 0.7rem; color: #FF5722; font-weight: 600;">employee_id</code>
                                    </div>
                                    <div style="background: #FFF3E0; padding: 0.5rem; border-radius: 4px; border-left: 3px solid #FF5722;">
                                        <code style="font-size: 0.7rem; color: #FF5722; font-weight: 600;">subject</code>
                                    </div>
                                    <div style="background: #FFF3E0; padding: 0.5rem; border-radius: 4px; border-left: 3px solid #FF5722;">
                                        <code style="font-size: 0.7rem; color: #FF5722; font-weight: 600;">body</code>
                                    </div>
                                    <div style="background: #E8F5E9; padding: 0.5rem; border-radius: 4px; border-left: 3px solid #4CAF50;">
                                        <code style="font-size: 0.7rem; color: #4CAF50; font-weight: 600;">expected_pipeline_result</code>
                                    </div>
                                </div>
                                <p style="font-size: 0.7rem; color: #666; margin: 0.75rem 0 0 0; font-style: italic;">üéØ Target final status for each ticket ‚Äî this is your ground truth</p>
                            </div>
                        </div>

                        <!-- Pipeline Function -->
                        <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">‚öôÔ∏è Pipeline Function from Stage 6</h6>
                            <div style="background: #1E1E1E; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.8rem; line-height: 1.7;">
                                <div><span style="color: #DCDCAA;">process_ticket</span><span style="color: #E0E0E0;">(</span></div>
                                <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">employee_id</span><span style="color: #E0E0E0;">,</span></div>
                                <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">ticket</span></div>
                                <div><span style="color: #E0E0E0;">) ‚Üí </span><span style="color: #E0E0E0;">{</span></div>
                                <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">status</span><span style="color: #E0E0E0;">,</span></div>
                                <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">message_or_answer</span><span style="color: #E0E0E0;">,</span></div>
                                <div style="padding-left: 1rem;"><span style="color: #9CDCFE;">debug</span></div>
                                <div><span style="color: #E0E0E0;">}</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key outputs -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #FF5722; margin-bottom: 1rem; font-size: 1rem;">üì§ Key outputs</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Per-Ticket Results -->
                        <div style="background: white; border-left: 4px solid #FF5722; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <h6 style="color: #FF5722; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üé´ Per-Ticket Results</h6>
                            <div style="display: grid; gap: 0.5rem;">
                                <div style="background: #FFF3E0; padding: 0.75rem; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;">
                                    <span style="font-size: 0.75rem; color: #555;">Actual <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;">status</code> from pipeline</span>
                                    <span style="background: #FF5722; color: white; padding: 0.25rem 0.6rem; border-radius: 12px; font-size: 0.7rem; font-weight: 600;">tracked</span>
                                </div>
                                <div style="background: #E8F5E9; padding: 0.75rem; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;">
                                    <span style="font-size: 0.75rem; color: #555;">Comparison with <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;">expected_pipeline_result</code></span>
                                    <div style="display: flex; gap: 0.3rem;">
                                        <span style="background: #4CAF50; color: white; padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.65rem; font-weight: 600;">‚úÖ match</span>
                                        <span style="background: #D32F2F; color: white; padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.65rem; font-weight: 600;">‚ùå mismatch</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Dataset-Level Insights -->
                        <div style="background: linear-gradient(135deg, #F1F8F4 0%, #E8F5E9 100%); border-left: 4px solid #4CAF50; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <h6 style="color: #4CAF50; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üìà Dataset-Level Insights</h6>
                            <div style="background: white; padding: 1rem; border-radius: 6px;">
                                <div style="font-size: 0.75rem; color: #555; margin-bottom: 0.75rem;">Understand which flows work well:</div>
                                <div style="display: grid; gap: 0.4rem;">
                                    <div style="font-size: 0.7rem; color: #555; display: flex; align-items: center; gap: 0.3rem;">
                                        <span style="color: #4CAF50;">‚óè</span> Which flows (A‚ÄìE) achieve target outcomes?
                                    </div>
                                    <div style="font-size: 0.7rem; color: #555; display: flex; align-items: center; gap: 0.3rem;">
                                        <span style="color: #FF9800;">‚óè</span> Which need tuning? (classifier / rules / RAG)
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Optional Summary Stats -->
                        <div style="background: white; border-left: 4px solid #2196F3; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); opacity: 0.9;">
                            <h6 style="color: #2196F3; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">‚ú® Optional Summary Stats <span style="font-size: 0.7rem; font-weight: 400; color: #999;">(nice to have)</span></h6>
                            <div style="background: #E3F2FD; padding: 1rem; border-radius: 6px;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.5rem;">
                                    <div style="background: white; padding: 0.5rem; border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.65rem; color: #999; margin-bottom: 0.2rem;">Tickets per status</div>
                                        <code style="font-size: 0.7rem; color: #2196F3; font-weight: 600;"># counts</code>
                                    </div>
                                    <div style="background: white; padding: 0.5rem; border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.65rem; color: #999; margin-bottom: 0.2rem;">Match / Mismatch</div>
                                        <code style="font-size: 0.7rem; color: #2196F3; font-weight: 600;"># accuracy</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- What to do -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #FF5722; margin-bottom: 1rem; font-size: 1rem;">‚úÖ What to do in this stage</h5>
                    
                    <div style="display: grid; gap: 1rem;">
                        <!-- Step 1 -->
                        <div style="background: white; border-left: 4px solid #FF5722; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #FF5722; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">1</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #FF5722; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üîÑ Implement Simple Test Loop</h6>
                                    <div style="background: #FFF3E0; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.75rem; color: #FF5722; font-weight: 600; margin-bottom: 0.75rem;">For each row in sample tickets file:</div>
                                        <div style="display: grid; gap: 0.5rem;">
                                            <div style="background: white; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555; border-left: 3px solid #FFB74D;">
                                                <strong>1.</strong> Build ticket object:<br/>
                                                <code style="background: #FFF3E0; padding: 0.1rem 0.3rem; border-radius: 3px; font-size: 0.65rem; margin-top: 0.2rem; display: inline-block;\">employee_id + subject + body</code>
                                            </div>
                                            <div style="background: white; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555; border-left: 3px solid #FFB74D;">
                                                <strong>2.</strong> Call <code style="background: #FFF3E0; padding: 0.1rem 0.3rem; border-radius: 3px;\">process_ticket()</code> function
                                            </div>
                                            <div style="background: white; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555; border-left: 3px solid #FFB74D;">
                                                <strong>3.</strong> Record results:<br/>
                                                <div style="display: flex; flex-wrap: wrap; gap: 0.3rem; margin-top: 0.3rem;">
                                                    <span style="background: #FFF3E0; padding: 0.2rem 0.4rem; border-radius: 12px; font-size: 0.65rem;\">ticket_id</span>
                                                    <span style="background: #FFF3E0; padding: 0.2rem 0.4rem; border-radius: 12px; font-size: 0.65rem;\">expected_pipeline_result</span>
                                                    <span style="background: #FFF3E0; padding: 0.2rem 0.4rem; border-radius: 12px; font-size: 0.65rem;\">actual_status</span>
                                                    <span style="background: #FFF9E6; padding: 0.2rem 0.4rem; border-radius: 12px; font-size: 0.65rem;\">debug.intent</span>
                                                    <span style="background: #FFF9E6; padding: 0.2rem 0.4rem; border-radius: 12px; font-size: 0.65rem;\">debug.auth</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div style="background: white; border-left: 4px solid #FF5722; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #FF5722; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">2</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #FF5722; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üéØ Compare Expected vs Actual</h6>
                                    <div style="background: #F5F5F5; padding: 1rem; border-radius: 6px;">
                                        <div style="font-size: 0.75rem; color: #555; margin-bottom: 0.75rem;">For each ticket, check:</div>
                                        <div style="display: grid; gap: 0.5rem;">
                                            <div style="background: #E8F5E9; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #4CAF50; display: flex; align-items: center; gap: 0.5rem;">
                                                <span style="font-size: 1rem;">‚úÖ</span>
                                                <div style="flex: 1; font-size: 0.7rem; color: #555;\">
                                                    <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">actual_status == expected_pipeline_result</code><br/>
                                                    <span style="color: #4CAF50; font-weight: 600;\">‚Üí Success!</span>
                                                </div>
                                            </div>
                                            <div style="background: #FFEBEE; padding: 0.75rem; border-radius: 4px; border-left: 3px solid #D32F2F; display: flex; align-items: center; gap: 0.5rem;">
                                                <span style="font-size: 1rem;">‚ùå</span>
                                                <div style="flex: 1; font-size: 0.7rem; color: #555;\">
                                                    Mismatch detected<br/>
                                                    <span style="color: #D32F2F; font-weight: 600;\">‚Üí Dig into <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">debug</code> to understand why</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div style="background: white; border-left: 4px solid #FF5722; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: #FF5722; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; flex-shrink: 0;">3</div>
                                <div style="flex: 1;">
                                    <h6 style="color: #FF5722; margin: 0 0 0.75rem 0; font-size: 0.9rem; font-weight: 600;">üîç Cluster & Debug by Failure Type</h6>
                                    <div style="display: grid; gap: 0.75rem;">
                                        <!-- Failure Type 1 -->
                                        <div style="background: #FFF9E6; padding: 1rem; border-radius: 6px; border-left: 3px solid #FF8C00;">
                                            <div style="font-size: 0.75rem; color: #FF8C00; font-weight: 600; margin-bottom: 0.5rem;">‚ö†Ô∏è Out-of-scope tickets getting through</div>
                                            <div style="background: white; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;">
                                                <strong style="color: #FF8C00;\">Fix:</strong> Strengthen <strong>classifier prompt</strong> & label definitions (Stage 3)
                                            </div>
                                        </div>

                                        <!-- Failure Type 2 -->
                                        <div style="background: #FFF0F6; padding: 1rem; border-radius: 6px; border-left: 3px solid #E91E63;">
                                            <div style="font-size: 0.75rem; color: #E91E63; font-weight: 600; margin-bottom: 0.5rem;">‚ö†Ô∏è Auth decisions feel wrong</div>
                                            <div style="background: white; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;">
                                                <strong style="color: #E91E63;">Fix:</strong> Review <strong>rules config</strong> (intent/role/department matching)<br/>
                                                Check <code style="background: #FFF0F6; padding: 0.1rem 0.3rem; border-radius: 3px;\">category</code>, <code style="background: #FFF0F6; padding: 0.1rem 0.3rem; border-radius: 3px;\">role</code>, <code style="background: #FFF0F6; padding: 0.1rem 0.3rem; border-radius: 3px;\">department</code> matching (Stage 4)
                                            </div>
                                        </div>

                                        <!-- Failure Type 3 -->
                                        <div style="background: #F1F8F4; padding: 1rem; border-radius: 6px; border-left: 3px solid #4CAF50;">
                                            <div style="font-size: 0.75rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.5rem;">‚ö†Ô∏è <code style="background: white; padding: 0.1rem 0.3rem; border-radius: 3px;\">solved_by_rag</code> but answers look weak</div>
                                            <div style="background: white; padding: 0.5rem; border-radius: 3px; font-size: 0.7rem; color: #555;">
                                                <strong style="color: #4CAF50;">Fix options:</strong>
                                                <ul style="margin: 0.3rem 0 0 1rem; padding: 0; line-height: 1.6;">
                                                    <li>Tighten <strong>RAG prompt</strong></li>
                                                    <li>Adjust retriever params (k, chunk size)</li>
                                                    <li>Stricter "no_answer" conditions (Stage 5)</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Debugging cheat-sheet -->
                <div style="margin-bottom: 1.5rem;">
                    <h5 style="color: #FF5722; margin-bottom: 0.75rem; font-size: 1rem;">üîß Debugging cheat-sheet (mapping problems ‚Üí where to tweak)</h5>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem; background: white;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);">
                                    <th style="padding: 0.75rem; text-align: left; border: 1px solid #FFE0B2; color: #FF5722; font-weight: 600;">Symptom / problem</th>
                                    <th style="padding: 0.75rem; text-align: left; border: 1px solid #FFE0B2; color: #FF5722; font-weight: 600;">Likely area to adjust</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Out-of-scope tickets are not being blocked</td>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Classifier prompt / labels (Stage 3)</td>
                                </tr>
                                <tr style="background: #FAFAFA;">
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Wrong category assigned (affects rules & KB)</td>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Classifier prompt / examples (Stage 3)</td>
                                </tr>
                                <tr>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Requests that should be blocked are allowed</td>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Auth rules config or logic (Stage 4)</td>
                                </tr>
                                <tr style="background: #FAFAFA;">
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Too many tickets end as <code>needs_approval</code></td>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Auth rules (tune allowed vs gated)</td>
                                </tr>
                                <tr>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Answers feel ungrounded or hallucinated</td>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">RAG prompt & retriever setup (Stage 5)</td>
                                </tr>
                                <tr style="background: #FAFAFA;">
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">Tickets that should be "solved" end up escalated</td>
                                    <td style="padding: 0.75rem; border: 1px solid #FFE0B2; color: #555; line-height: 1.6;">KB coverage or retriever parameters</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p style="font-size: 0.8rem; margin-top: 0.5rem; color: #888; font-style: italic;">
                        You can keep descriptions short and refine them once the real sample data is in.
                    </p>
                </div>

                <!-- LangChain hint -->
                <div style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                    <h5 style="color: #FF8C00; margin-top: 0; font-size: 0.95rem;">üí° LangChain hint</h5>
                    <ul style="font-size: 0.8rem; line-height: 1.8; color: #555; margin-bottom: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.4rem;">Stage 7 is mostly about <strong>calling</strong> what you already built, not building new chains.</li>
                        <li style="margin-bottom: 0;">It's a great place to:
                            <ul style="margin-top: 0.3rem; font-size: 0.75rem;">
                                <li>log intermediate outputs (classifier output, rules decision, retrieved docs),</li>
                                <li>inspect a few tricky tickets by hand,</li>
                                <li>and tweak prompts/configs iteratively.</li>
                            </ul>
                        </li>
                    </ul>
                    <p style="font-size: 0.8rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                        Think of it as your <strong>evaluation harness</strong>, not part of the runtime product itself.
                    </p>
                </div>
            </div>

        </section>

        <!-- B.3 Extensions & Variations -->
        <section id="part-b-extensions">
            <h3 style="color: #9C27B0; font-size: 1.5rem; margin-top: 3rem;">üöÄ B.3 ‚Äì Extensions & Variations (Optional)</h3>

            <!-- Intro card with visual grid -->
            <div class="card" style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); border-left: 5px solid #9C27B0; margin-bottom: 2rem; padding: 2rem;">
                <p style="font-size: 1rem; margin-bottom: 1.5rem; line-height: 1.7; color: #333; font-weight: 500;">
                    The core of this exercise is the <strong>stateless per-ticket pipeline</strong> you built in Stages 1‚Äì7.
                    Once that's working, you can explore these <strong>optional extensions</strong> to make your solution feel more like a real product.
                </p>

                <!-- Extension overview grid -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
                    <!-- Extension 1 box -->
                    <div style="background: white; border-left: 4px solid #00B7C3; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üñ•Ô∏è</div>
                        <h5 style="color: #00B7C3; margin: 0 0 0.5rem 0; font-size: 0.95rem; font-weight: 600;">UI or Chat Wrapper</h5>
                        <p style="font-size: 0.8rem; margin: 0; line-height: 1.5; color: #666;">Add a simple CLI loop or minimal web interface</p>
                    </div>

                    <!-- Extension 2 box -->
                    <div style="background: white; border-left: 4px solid #E91E63; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üîí</div>
                        <h5 style="color: #E91E63; margin: 0 0 0.5rem 0; font-size: 0.95rem; font-weight: 600;">Smarter Authorization</h5>
                        <p style="font-size: 0.8rem; margin: 0; line-height: 1.5; color: #666;">Granular categories and action-level rules</p>
                    </div>

                    <!-- Extension 3 box -->
                    <div style="background: white; border-left: 4px solid #4CAF50; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üéØ</div>
                        <h5 style="color: #4CAF50; margin: 0 0 0.5rem 0; font-size: 0.95rem; font-weight: 600;">Hyper-Personalization</h5>
                        <p style="font-size: 0.8rem; margin: 0; line-height: 1.5; color: #666;">Role-aware prompts and analytics</p>
                    </div>

                    <!-- Extension 4 box -->
                    <div style="background: white; border-left: 4px solid #9C27B0; padding: 1.25rem; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üî¨</div>
                        <h5 style="color: #9C27B0; margin: 0 0 0.5rem 0; font-size: 0.95rem; font-weight: 600;">Other Explorations</h5>
                        <p style="font-size: 0.8rem; margin: 0; line-height: 1.5; color: #666;">Observability, safety checks, configs</p>
                    </div>
                </div>

                <div style="background: rgba(255,255,255,0.7); padding: 1rem; border-radius: 6px; margin-top: 1.5rem; border: 2px dashed #9C27B0;">
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.6; color: #555; text-align: center;">
                        üí° <strong>Tip:</strong> Focus on core flows first. If you have extra time, pick <strong>one</strong> extension that interests you most.
                    </p>
                </div>
            </div>

            <!-- Extension 1: UI Wrapper -->
            <div class="card" style="background: white; border-left: 5px solid #00B7C3; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #00B7C3; margin-top: 0; font-size: 1.1rem;">üñ•Ô∏è Extension 1 ‚Äì Wrap the pipeline in a small UI or chat</h4>
                
                <p style="font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.7; color: #555;">
                    The pipeline you built is <strong>stateless</strong> by design:
                </p>
                <div style="background: #FAFAFA; padding: 1rem; margin-bottom: 1.5rem; border-radius: 4px; border-left: 3px solid #00B7C3;">
                    <code style="font-size: 0.85rem; color: #333;">(employee_id, ticket) ‚Üí status + message/answer</code>
                </div>
                <p style="font-size: 0.9rem; margin-bottom: 1.5rem; line-height: 1.7; color: #555;">
                    This makes it easy to test and reason about. But in a real system, users don't see "functions"; they see <strong>interfaces</strong>.
                </p>

                <h5 style="color: #00B7C3; margin-bottom: 1rem; font-size: 1rem;">üí° Two approach options:</h5>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 1.5rem;">
                    <!-- CLI loop option -->
                    <div style="background: linear-gradient(135deg, #E0F7FA 0%, #F0FEFF 100%); border: 2px solid #00B7C3; border-radius: 8px; padding: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 1.8rem;">‚å®Ô∏è</span>
                            <h6 style="color: #00B7C3; margin: 0; font-size: 1rem; font-weight: 600;">Option A: CLI Loop</h6>
                        </div>
                        <div style="background: #1E1E1E; padding: 1rem; border-radius: 6px; margin-bottom: 1rem; font-family: 'Courier New', monospace; font-size: 0.8rem; color: #E0E0E0;">
                            <div style="color: #6A9955;"># Pseudocode</div>
                            <div><span style="color: #C586C0;">employee_id</span> = <span style="color: #CE9178;">input</span>(<span style="color: #CE9178;">"Enter employee id: "</span>)</div>
                            <div><span style="color: #C586C0;">while</span> <span style="color: #569CD6;">True</span>:</div>
                            <div style="padding-left: 1rem;">ticket = <span style="color: #CE9178;">get_ticket_input</span>()</div>
                            <div style="padding-left: 1rem;">result = <span style="color: #DCDCAA;">process_ticket</span>(employee_id, ticket)</div>
                            <div style="padding-left: 1rem;"><span style="color: #CE9178;">print</span>(result)</div>
                        </div>
                        <ul style="font-size: 0.8rem; line-height: 1.6; color: #555; margin: 0; padding-left: 1.2rem;">
                            <li style="margin-bottom: 0.3rem;">‚úì Quick to implement</li>
                            <li style="margin-bottom: 0.3rem;">‚úì Good for testing</li>
                            <li style="margin-bottom: 0;">‚úì No extra dependencies</li>
                        </ul>
                    </div>

                    <!-- Web UI option -->
                    <div style="background: linear-gradient(135deg, #E0F7FA 0%, #F0FEFF 100%); border: 2px solid #00B7C3; border-radius: 8px; padding: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 1.8rem;">üåê</span>
                            <h6 style="color: #00B7C3; margin: 0; font-size: 1rem; font-weight: 600;">Option B: Minimal Web UI</h6>
                        </div>
                        <div style="background: white; border: 1px solid #ddd; border-radius: 6px; padding: 1rem; margin-bottom: 1rem;">
                            <div style="font-size: 0.75rem; color: #999; margin-bottom: 0.5rem;">UI Mockup:</div>
                            <div style="background: #f8f8f8; padding: 0.75rem; border-radius: 4px; border: 1px solid #ddd;">
                                <div style="font-size: 0.75rem; color: #666; margin-bottom: 0.3rem;">Employee ID: <span style="background: white; padding: 0.2rem 0.4rem; border: 1px solid #ccc; border-radius: 3px;">E123</span></div>
                                <div style="font-size: 0.75rem; color: #666; margin-bottom: 0.3rem;">Subject: <span style="background: white; padding: 0.2rem 0.4rem; border: 1px solid #ccc; border-radius: 3px; display: inline-block; width: 60%;">...</span></div>
                                <div style="font-size: 0.75rem; color: #666; margin-bottom: 0.5rem;">Body: <span style="background: white; padding: 0.2rem 0.4rem; border: 1px solid #ccc; border-radius: 3px; display: inline-block; width: 60%;">...</span></div>
                                <button style="background: #00B7C3; color: white; border: none; padding: 0.4rem 1rem; border-radius: 4px; font-size: 0.75rem; cursor: pointer;">Submit Ticket</button>
                            </div>
                        </div>
                        <ul style="font-size: 0.8rem; line-height: 1.6; color: #555; margin: 0; padding-left: 1.2rem;">
                            <li style="margin-bottom: 0.3rem;">‚úì More realistic UX</li>
                            <li style="margin-bottom: 0.3rem;">‚úì Shows debug info easily</li>
                            <li style="margin-bottom: 0;">‚úì Demo-friendly</li>
                        </ul>
                    </div>
                </div>

                <!-- Important note -->
                <div style="background: #FFF9E6; padding: 1.25rem; border-radius: 6px; border-left: 4px solid #FF8C00;">
                    <h6 style="color: #FF8C00; margin-top: 0; font-size: 0.9rem;">‚ö†Ô∏è Important note</h6>
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #555;">
                        This UI is <strong>just a wrapper</strong>. The logic still lives in a stateless function/chain that takes an <code>employee_id</code> and a ticket as input. That's the interface used for testing with the sample dataset.
                    </p>
                </div>
            </div>

            <!-- Extension 2: Richer Authorization -->
            <div class="card" style="background: white; border-left: 5px solid #E91E63; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #E91E63; margin-top: 0; font-size: 1.1rem;">üîí Extension 2 ‚Äì Make the policy brain smarter</h4>
                
                <p style="font-size: 0.9rem; margin-bottom: 1.5rem; line-height: 1.7; color: #555;">
                    The basic rules in Stage 4 are enough for the hackathon, but real systems often evolve more complex policies over time.
                </p>

                <h5 style="color: #E91E63; margin-bottom: 1rem; font-size: 1rem;">üîß Three enhancement directions:</h5>
                
                <!-- Enhancement comparison table -->
                <div style="overflow-x: auto; margin-bottom: 1.5rem;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem; background: white; border: 2px solid #E91E63; border-radius: 8px; overflow: hidden;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%);">
                                <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #E91E63; color: #E91E63; font-weight: 600; width: 25%;">Enhancement</th>
                                <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #E91E63; color: #E91E63; font-weight: 600; width: 40%;">What it does</th>
                                <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #E91E63; color: #E91E63; font-weight: 600; width: 35%;">Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid #FFE0E9;">
                                <td style="padding: 1rem; color: #555; font-weight: 600;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="font-size: 1.2rem;">üìÇ</span>
                                        <span>Granular Categories</span>
                                    </div>
                                </td>
                                <td style="padding: 1rem; color: #555; line-height: 1.6;">
                                    Split broad categories into specific sub-types with different approval rules
                                </td>
                                <td style="padding: 1rem;">
                                    <div style="background: #FAFAFA; padding: 0.75rem; border-radius: 4px; font-size: 0.8rem; line-height: 1.5;">
                                        <code style="color: #E91E63;">hardware_issue</code> ‚Üí<br/>
                                        ‚Ä¢ <code>standard_request</code> ‚úì auto<br/>
                                        ‚Ä¢ <code>high_value_item</code> ‚ö†Ô∏è approval<br/>
                                        ‚Ä¢ <code>peripheral_device</code> ‚úì auto
                                    </div>
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #FFE0E9;">
                                <td style="padding: 1rem; color: #555; font-weight: 600;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="font-size: 1.2rem;">‚ö°</span>
                                        <span>Action-Level Rules</span>
                                    </div>
                                </td>
                                <td style="padding: 1rem; color: #555; line-height: 1.6;">
                                    <strong>Future Enhancement:</strong> Factor in both <code>category</code> AND <code>requested_action</code> for finer-grained decisions. Current system uses category + role + department (3-way matching). This would add a 4th dimension for action-level control.
                                </td>
                                <td style="padding: 1rem;">
                                    <div style="background: #FAFAFA; padding: 0.75rem; border-radius: 4px; font-size: 0.8rem; line-height: 1.5;">
                                        <code style="color: #E91E63;">access_request</code> +<br/>
                                        ‚Ä¢ <code>read_only_access</code> ‚Üí auto<br/>
                                        ‚Ä¢ <code>admin_access</code> ‚Üí approval
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 1rem; color: #555; font-weight: 600;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="font-size: 1.2rem;">üé≠</span>
                                        <span>Contextual Policies</span>
                                    </div>
                                </td>
                                <td style="padding: 1rem; color: #555; line-height: 1.6;">
                                    Use employee context (<code>department</code>, <code>role</code>, <code>seniority</code>) to refine decisions
                                </td>
                                <td style="padding: 1rem;">
                                    <div style="background: #FAFAFA; padding: 0.75rem; border-radius: 4px; font-size: 0.8rem; line-height: 1.5;">
                                        <code style="color: #E91E63;">infra_admin</code> in <code>engineering</code><br/>
                                        ‚Üí broader rights<br/><br/>
                                        vs <code>support</code> in <code>sales</code><br/>
                                        ‚Üí more restricted
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Why useful -->
                <div style="background: #FFF3E0; padding: 1.25rem; border-radius: 6px; border-left: 4px solid #E91E63;">
                    <h6 style="color: #E91E63; margin-top: 0; font-size: 0.9rem;">üí° Why this is useful to discuss</h6>
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #555;">
                        It helps participants see how a <strong>simple rule engine</strong> can grow into a more realistic policy layer, without relying on the LLM to "decide" security-sensitive questions.
                    </p>
                </div>
            </div>

            <!-- Extension 3: Hyper-Personalization -->
            <div class="card" style="background: white; border-left: 5px solid #4CAF50; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #4CAF50; margin-top: 0; font-size: 1.1rem;">üéØ Extension 3 ‚Äì A small step toward hyper-personalization</h4>
                
                <p style="font-size: 0.9rem; margin-bottom: 1.5rem; line-height: 1.7; color: #555;">
                    The original inspiration for this exercise comes from a richer idea: a <strong>Hyper-Personalized Support Copilot</strong> that adapts over time and across segments. We're not building the full system here, but you can sketch or prototype small touches of that vision.
                </p>

                <h5 style="color: #4CAF50; margin-bottom: 1rem; font-size: 1rem;">üíö Three personalization paths:</h5>
                
                <div style="display: grid; gap: 1.5rem; margin-bottom: 1.5rem;">
                    <!-- Role-aware prompting -->
                    <div style="background: linear-gradient(135deg, #F1F8F4 0%, #E8F5E9 100%); border-left: 4px solid #4CAF50; padding: 1.5rem; border-radius: 6px;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 1.5rem;">üë§</span>
                            <h6 style="color: #4CAF50; margin: 0; font-size: 1rem; font-weight: 600;">1. Role-Aware Prompting</h6>
                        </div>
                        <p style="font-size: 0.85rem; margin-bottom: 1rem; line-height: 1.6; color: #555;">
                            Adjust answer style based on <code>role</code>, <code>seniority</code>, or <code>department</code>
                        </p>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div style="background: white; padding: 1rem; border-radius: 4px; border: 1px solid #C8E6C9;">
                                <div style="font-size: 0.75rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.5rem;">üë®‚Äçüíª Senior Engineer</div>
                                <div style="font-size: 0.75rem; color: #666; line-height: 1.5;">
                                    "VPN connection failed due to <strong>SSL handshake timeout</strong>. Check certificate validity with <code>openssl</code> and verify MTU settings..."
                                </div>
                            </div>
                            <div style="background: white; padding: 1rem; border-radius: 4px; border: 1px solid #C8E6C9;">
                                <div style="font-size: 0.75rem; color: #4CAF50; font-weight: 600; margin-bottom: 0.5rem;">üëî Sales Team</div>
                                <div style="font-size: 0.75rem; color: #666; line-height: 1.5;">
                                    "VPN isn't connecting? Let's try these simple steps: 1) Restart VPN client 2) Check wifi connection 3) Contact IT if issue persists..."
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics view -->
                    <div style="background: linear-gradient(135deg, #F1F8F4 0%, #E8F5E9 100%); border-left: 4px solid #4CAF50; padding: 1.5rem; border-radius: 6px;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 1.5rem;">üìä</span>
                            <h6 style="color: #4CAF50; margin: 0; font-size: 1rem; font-weight: 600;">2. Segmented Analytics</h6>
                        </div>
                        <p style="font-size: 0.85rem; margin-bottom: 1rem; line-height: 1.6; color: #555;">
                            Log tickets with metadata ‚Üí analyze patterns by role/department
                        </p>
                        <div style="background: white; padding: 1rem; border-radius: 4px; border: 1px solid #C8E6C9;">
                            <div style="font-size: 0.75rem; color: #999; margin-bottom: 0.5rem;">Sample Analytics Dashboard:</div>
                            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                                <div style="background: #FFEBEE; padding: 0.5rem; border-radius: 4px; flex: 1; min-width: 120px;">
                                    <div style="font-size: 0.7rem; color: #999;">Blocked Most</div>
                                    <div style="font-size: 0.85rem; color: #D32F2F; font-weight: 600;">L1 Support (42%)</div>
                                </div>
                                <div style="background: #FFF3E0; padding: 0.5rem; border-radius: 4px; flex: 1; min-width: 120px;">
                                    <div style="font-size: 0.7rem; color: #999;">Top Escalations</div>
                                    <div style="font-size: 0.85rem; color: #F57C00; font-weight: 600;">network_issue</div>
                                </div>
                                <div style="background: #E8F5E9; padding: 0.5rem; border-radius: 4px; flex: 1; min-width: 120px;">
                                    <div style="font-size: 0.7rem; color: #999;">Best Coverage</div>
                                    <div style="font-size: 0.85rem; color: #388E3C; font-weight: 600;">password_reset</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Improvement loop -->
                    <div style="background: linear-gradient(135deg, #F1F8F4 0%, #E8F5E9 100%); border-left: 4px solid #4CAF50; padding: 1.5rem; border-radius: 6px;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 1.5rem;">üîÑ</span>
                            <h6 style="color: #4CAF50; margin: 0; font-size: 1rem; font-weight: 600;">3. Continuous Improvement Loop</h6>
                        </div>
                        <p style="font-size: 0.85rem; margin-bottom: 1rem; line-height: 1.6; color: #555;">
                            Use analytics to identify gaps ‚Üí improve KB & prompts
                        </p>
                        <div style="background: white; padding: 1rem; border-radius: 4px; border: 1px solid #C8E6C9;">
                            <div style="display: flex; align-items: center; gap: 0.75rem; font-size: 0.8rem; color: #555; line-height: 1.8;">
                                <div style="text-align: center;">
                                    <div style="background: #4CAF50; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; margin: 0 auto 0.25rem;">1</div>
                                    <div>Spot pattern</div>
                                </div>
                                <div style="color: #4CAF50; font-size: 1.5rem;">‚Üí</div>
                                <div style="text-align: center;">
                                    <div style="background: #4CAF50; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; margin: 0 auto 0.25rem;">2</div>
                                    <div>Add KB doc</div>
                                </div>
                                <div style="color: #4CAF50; font-size: 1.5rem;">‚Üí</div>
                                <div style="text-align: center;">
                                    <div style="background: #4CAF50; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; margin: 0 auto 0.25rem;">3</div>
                                    <div>Refine prompt</div>
                                </div>
                                <div style="color: #4CAF50; font-size: 1.5rem;">‚Üí</div>
                                <div style="text-align: center;">
                                    <div style="background: #4CAF50; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; margin: 0 auto 0.25rem;">4</div>
                                    <div>Measure</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Position clearly -->
                <div style="background: #E8F5E9; padding: 1.25rem; border-radius: 6px; border-left: 4px solid #4CAF50;">
                    <h6 style="color: #4CAF50; margin-top: 0; font-size: 0.9rem;">üìå Position this clearly</h6>
                    <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #555;">
                        These ideas are <strong>not required</strong> for the hackathon deliverable, but they show how this exercise can be a <strong>thin vertical slice</strong> of a much larger support copilot roadmap.
                    </p>
                </div>
            </div>

            <!-- Extension 4: Other Optional Explorations -->
            <div class="card" style="background: white; border-left: 5px solid #9C27B0; margin-bottom: 1.5rem; padding: 2rem;">
                <h4 style="color: #9C27B0; margin-top: 0; font-size: 1.1rem;">üî¨ Extension 4 ‚Äì Other optional explorations</h4>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.25rem; margin-top: 1.5rem;">
                    <!-- Observability -->
                    <div style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); border: 2px solid #9C27B0; border-radius: 8px; padding: 1.5rem;">
                        <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: #9C27B0; color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem;">
                            <span>üìà</span>
                            <span>OBSERVABILITY</span>
                        </div>
                        <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.95rem; font-weight: 600;">Better Metrics & Logging</h6>
                        <div style="background: white; padding: 1rem; border-radius: 4px; font-size: 0.8rem; line-height: 1.6; color: #555;">
                            <div style="margin-bottom: 0.5rem;">üìä Track metrics:</div>
                            <ul style="margin: 0; padding-left: 1.2rem; list-style: none;">
                                <li style="margin-bottom: 0.3rem;">‚Ä¢ Avg tokens/request</li>
                                <li style="margin-bottom: 0.3rem;">‚Ä¢ Latency per stage</li>
                                <li style="margin-bottom: 0;">‚Ä¢ Status distribution</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Safety -->
                    <div style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); border: 2px solid #9C27B0; border-radius: 8px; padding: 1.5rem;">
                        <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: #9C27B0; color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem;">
                            <span>üõ°Ô∏è</span>
                            <span>SAFETY</span>
                        </div>
                        <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.95rem; font-weight: 600;">Stricter Safety Checks</h6>
                        <div style="background: white; padding: 1rem; border-radius: 4px; font-size: 0.8rem; line-height: 1.6; color: #555;">
                            <div style="margin-bottom: 0.5rem;">üîí Add filters for:</div>
                            <ul style="margin: 0; padding-left: 1.2rem; list-style: none;">
                                <li style="margin-bottom: 0.3rem;">‚Ä¢ Sensitive terms</li>
                                <li style="margin-bottom: 0.3rem;">‚Ä¢ PII detection</li>
                                <li style="margin-bottom: 0;">‚Ä¢ Always-review categories</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Config-driven -->
                    <div style="background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); border: 2px solid #9C27B0; border-radius: 8px; padding: 1.5rem;">
                        <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: #9C27B0; color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem;">
                            <span>‚öôÔ∏è</span>
                            <span>CONFIGURATION</span>
                        </div>
                        <h6 style="color: #9C27B0; margin: 0 0 0.75rem 0; font-size: 0.95rem; font-weight: 600;">Config-Driven Everything</h6>
                        <div style="background: white; padding: 1rem; border-radius: 4px; font-size: 0.8rem; line-height: 1.6; color: #555;">
                            <div style="margin-bottom: 0.5rem;">üìù Externalize configs:</div>
                            <ul style="margin: 0; padding-left: 1.2rem; list-style: none;">
                                <li style="margin-bottom: 0.3rem;">‚Ä¢ Category definitions</li>
                                <li style="margin-bottom: 0.3rem;">‚Ä¢ Status templates</li>
                                <li style="margin-bottom: 0;">‚Ä¢ Retriever params</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Closing note -->
            <div class="card" style="background: linear-gradient(135deg, #FFF9E6 0%, #FFF3D6 100%); border-left: 5px solid #FF8C00; margin-bottom: 2rem;">
                <h5 style="color: #FF8C00; margin-top: 0; font-size: 1rem;">‚ö° Closing note for extensions</h5>
                <p style="font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.7; color: #333;">
                    Extensions are <strong>optional</strong> and should not distract you from the core goal:
                </p>
                <ul style="font-size: 0.85rem; line-height: 1.8; color: #555; margin-bottom: 0.75rem; padding-left: 1.5rem;">
                    <li style="margin-bottom: 0;">a <strong>clear, testable pipeline</strong> that maps <code>employee_id + ticket</code> to one of the final statuses defined in Part A.</li>
                </ul>
                <p style="font-size: 0.85rem; margin: 0; line-height: 1.7; color: #666; font-style: italic;">
                    If you have limited time, focus on getting the <strong>core flows A‚ÄìE</strong> working end-to-end. If you have extra time, pick <strong>one</strong> extension that interests you and explore it.
                </p>
            </div>

        </section>
        
    </main>

</body>
</html>
